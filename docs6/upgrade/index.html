<!DOCTYPE html>
<html>
  <head>
    <title>Nervatura Upgrade</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/svg+xml" href="../favicon.svg">
    <link rel="preconnect" href="https://rsms.me/">
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
    <link href="../css/style.css" rel="stylesheet">
  </head>
  <body>
    <main class="relative flex justify-center mx-auto max-w-8xl sm:px-2 lg:px-8 xl:px-12 bg-slate-200">
    <label for="navigation" class="fixed bottom-0 left-0 z-50 flex items-center justify-center w-12 h-12 mb-4 ml-4 bg-white border rounded-full shadow-lg cursor-pointer text-slate-600 border-slate-300 lg:hidden transition duration-200 ease-in-out active:scale-95">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M4 8h16M4 16h16" />
      </svg>
    </label>

    <input type="checkbox" name="navigation" id="navigation" class="hidden peer" />
    <div class="fixed top-0 h-screen shadow-xl px-4 left-0 hidden peer-checked:block lg:relative lg:top-0 lg:h-auto lg:px-0 lg:block lg:flex-none lg:shadow-none z-40">
      <div class="absolute inset-y-0 right-0 w-full lg:w-[50vw] bg-slate-200"></div>

      <nav class="sticky top-0 pr-8 text-base lg:text-sm  xl:pr-16 w-auto">
        <ul role="list" class="-ml-0.5 h-screen overflow-y-auto pl-0.5 space-y-8 py-4">
          <li class="mb-4">
            <h2 class="text-lg font-semibold tracking-tight text-slate-900">
              <a href="../" class="text-slate-600 hover:text-slate-800">
                <span class="inline-block w-4 align-middle">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4">
                    <path d="M8.543 2.232a.75.75 0 0 0-1.085 0l-5.25 5.5A.75.75 0 0 0 2.75 9H4v4a1 1 0 0 0 1 1h1a1 1 0 0 0 1-1v-1a1 1 0 1 1 2 0v1a1 1 0 0 0 1 1h1a1 1 0 0 0 1-1V9h1.25a.75.75 0 0 0 .543-1.268l-5.25-5.5Z" />
                  </svg>                  
                </span>
                <span class="inline-block align-middle">
                  Nervatura Docs
                </span>
              </a>
            </h2>
          </li>

          <li class="mb-2">
            <h2 class="font-semibold tracking-tight text-slate-900">
              <a href="#overview" class="text-slate-600 hover:text-slate-800">
                Overview
              </a>
            </h2>
          </li>

          <li class="mb-2">
            <h2 class="font-semibold tracking-tight text-slate-900">
              <a href="#cli" class="text-slate-600 hover:text-slate-800">
                CLI upgrade commands
              </a>
            </h2>
          </li>

          <li class="mb-2">
            <h2 class="font-semibold tracking-tight text-slate-900">
              <a href="#release-notes" class="text-slate-600 hover:text-slate-800">
                Important release notes
              </a>
            </h2>
          </li>

          <li class="mb-2">
            <h2 class="font-semibold tracking-tight text-slate-900">
              <a href="#password" class="text-slate-600 hover:text-slate-800">
                User password
              </a>
            </h2>
          </li>

          <li class="mb-2">
            <h2 class="font-semibold tracking-tight text-slate-900">
              <a href="#report" class="text-slate-600 hover:text-slate-800">
                Report upgrade
              </a>
            </h2>
          </li>

        </ul>
      </nav>
    </div>

    <div class="flex-auto max-w-2xl min-w-0 px-4 py-10 lg:max-w-none lg:pr-0 lg:pl-8 xl:px-16 bg-slate-100">
      <article>
        <header class="">
          <p class="text-base font-medium text-slate-500">
            Nervatura
          </p>

          <h1 class="text-3xl font-bold tracking-tight text-slate-900">
            Upgrade to v6.*
          </h1>
        </header>

        <h3 id="overview" class="mt-6 mb-3 text-xl font-bold tracking-tight text-slate-900">
          Overview
        </h3>

        <p class="mb-2 text-base text-slate-600">
          The Nervatura v6 is a major upgrade that includes many new features and improvements.
          The entire codebase has been refactored. The new codebase is now almost entirely Golang-based, which has radically reduced its size, complexity and external dependencies. The main changes are:
          <ul class="list-disc list-inside text-slate-600">
            <li>New hybrid <a href="../model/#structure" class="text-blue-600 font-bold dark:text-blue-500 hover:underline">database object model</a></li>
            <li>New/refactored <a href="../cli/#cli" class="text-blue-600 font-bold dark:text-blue-500 hover:underline">CLI</a> (command line interface) API</li>
            <li>New/refactored <a href="../cli/#cgo" class="text-blue-600 font-bold dark:text-blue-500 hover:underline">CGO</a> (C shared library) API</li>
            <li>New/refactored <a href="../open/" class="text-blue-600 font-bold dark:text-blue-500 hover:underline">HTTP OPEN API</a> (REST) API</li>
            <li>New/refactored <a href="../grpc/" class="text-blue-600 font-bold dark:text-blue-500 hover:underline">gRPC API</a> API</li>
            <li>New <a href="../mcp/" class="text-blue-600 font-bold dark:text-blue-500 hover:underline">MCP</a> built-in server for LLM integration and AI-powered data processing</li>
            <li>Replaced web component based Client application with a new server-side <a href="../client/" class="text-blue-600 font-bold dark:text-blue-500 hover:underline">Nervatura Client</a> graphical user interface</li>
            <li>Added a separate <a href="../editor/" class="text-blue-600 font-bold dark:text-blue-500 hover:underline">Report Editor</a> extension for creating and editing PDF report templates</li>
            <li>New/rewritten dependency-free static documentation</li>
          </ul>
        </p>

        <h3 id="cli" class="mt-6 mb-3 text-xl font-bold tracking-tight text-slate-900">
          CLI upgrade commands
        </h3>

        <p class="mb-2 text-base text-slate-600">
          Before upgrading the database, be sure to <b>create a database backup</b>. Not only the alias name of the database, 
          but also its connection can be specified: <br />
          <code class="mt-2 w-auto text-xs text-wrap inline-flex text-left items-center space-x-4 bg-gray-800 text-white rounded-lg px-4 py-2">
            -o {"alias": "demo", "NT_ALIAS_DEMO": "sqlite://file:data/demo.db?cache=shared&mode=rwc"}"
          </code>
        </p>

        <p class="mb-2 text-base font-bold text-slate-600">
          Docker example
        </p>

        <div class="relative overflow-x-auto">
          <code class="mb-3 w-auto text-xs text-wrap inline-flex text-left items-center space-x-4 bg-gray-800 text-white rounded-lg px-4 py-2">
            docker exec -i nervatura /nervatura -c upgrade -o "{\"alias\":\"demo\"}"
          </code>
        </div>

        <p class="mb-2 text-base font-bold text-slate-600">
          Snap example
        </p>

        <div class="relative overflow-x-auto">
          <code class="mb-3 w-auto text-xs text-wrap inline-flex text-left items-center space-x-4 bg-gray-800 text-white rounded-lg px-4 py-2">
            sudo /snap/nervatura/current/nervatura -c upgrade -o "{\"alias\":\"demo\"}"
          </code>
        </div>

        <p class="mb-2 text-base font-bold text-slate-600">
          Windows example
        </p>

        <div class="relative overflow-x-auto">
          <code class="mb-3 w-auto text-xs text-wrap inline-flex text-left items-center space-x-4 bg-gray-800 text-white rounded-lg px-4 py-2">
            & "C:\Program Files\Nervatura\nervatura.exe" -c upgrade -o '{\"alias\":\"demo\"}'
          </code>
        </div>

        <p class="mb-2 text-base font-bold text-slate-600">
          Node.js NPM example
        </p>

        <div class="relative overflow-x-auto">
          <code class="w-auto text-xs text-wrap inline-flex text-left items-center space-x-4 bg-gray-800 text-white rounded-lg px-4 py-2">
            ./node_modules/nervatura/bin/nervatura -c upgrade -o '{\"alias\":\"demo\"}'
          </code>
        </div>

        <h3 id="release-notes" class="mt-6 mb-3 text-xl font-bold tracking-tight text-slate-900">
          Important release notes
        </h3>

        <p class="mb-2 text-base text-slate-600">
          The following data will not be transferred:
          <ul class="list-disc list-inside text-slate-600">
            <li>only one barcode per product (product meta)</li>
            <li>only the value data of the old meta data (fieldvalue), the notes data is lost</li>
            <li>log, report, printqueue and user password data are not transferred</li>
          </ul>
        </p>

        <p class="mt-2 text-base text-slate-600">
          The new version currently supports the following database types: SQLite, PostgreSQL, MySQL. The MSSQL support has been built into the code, but the default build currently does not include the MSSQL database driver and not supported yet.
        </p>
        
        <h3 id="password" class="mt-6 mb-3 text-xl font-bold tracking-tight text-slate-900">
          User password
        </h3>

        <p class="mt-2 text-base text-slate-600">
          After the database upgrade, the admin user password will be reset to the default password. The default admin password is the value of the <code class="text-base font-semibold text-green-600 dark:text-green-600 bg-gray-200 px-2 py-1"
            >NT_API_KEY</code> environment variable. Please change after the first login!
        </p>
        
        <p class="mt-2 text-base text-slate-600">
          Other user passwords will not be transferred and the user login will be disabled. You can reset the user password using the CLI <a href="../cli/#cgo_reset" class="text-blue-600 font-bold dark:text-blue-500 hover:underline">reset password</a> command.
        </p>
        <code class="mt-3 w-auto text-xs text-wrap inline-flex text-left items-center space-x-4 bg-gray-800 text-white rounded-lg px-4 py-2">
          ./nervatura -c reset -o '{\"alias\":\"demo\", \"code\":\"USR0000000000N2\"}'
        </code>
        <p class="mt-2 text-base text-slate-600">
          Other alternative API commands to reset the user password are:
          <ul class="list-disc list-inside text-slate-600">
            <li>HTTP Open API PUT <a href="../open/#/auth/put_auth_reset__id_code_" class="text-blue-600 font-bold dark:text-blue-500 hover:underline">auth/reset/{id_code}</a></li>
            <li>gRPC API <a href="../grpc/#AuthPasswordReset" class="text-blue-600 font-bold dark:text-blue-500 hover:underline">AuthPasswordReset</a></li>
          </ul>

        <h3 id="report" class="mt-6 mb-3 text-xl font-bold tracking-tight text-slate-900">
          Report upgrade
        </h3>

        <p class="mt-2 text-base text-slate-600">
          The structure of the previous Nervatura PDF and CSV reports has not changed and is basically compatible with the new versions. The problem is caused by the queries embedded in the reports, which are not compatible with the new database structure. Therefore, the reports cannot be upgraded automatically.
        </p>

        <p class="mt-2 text-base text-slate-600">
          Suggested solution:
          <ul class="list-disc list-inside text-slate-600">
            <li>Install the new report template using the Nervatura Client Settings -> <a href="../client/#template" class="text-blue-600 font-bold dark:text-blue-500 hover:underline">REPORT TEMPLATE</a> menu</li>
            <li>Create a new report template from the installed report template and edit it using the <a href="../editor/" class="text-blue-600 font-bold dark:text-blue-500 hover:underline">Report Editor</a> extension</li>
          </ul>
        </p>
        
        <dl class="flex pt-6 mt-6 border-t border-slate-200">
          <div class="mr-auto text-left">
            <dt class="text-sm font-normal tracking-tight text-slate-600">
              Previous
            </dt>

            <dd class="mt-1">
              <a href="../install/" class="text-base font-semibold text-slate-900 hover:underline">
                Installation
              </a>
            </dd>
          </div>

          <div class="ml-auto text-right">
            <dt class="text-sm font-normal tracking-tight text-slate-600">
              Next
            </dt>

            <dd class="mt-1">
              <a href="../create/" class="text-base font-semibold text-slate-900 hover:underline">
                Create a new database
              </a>
            </dd>
          </div>
        </dl>
      </article>
    </div>
</main>
</body>
</html>