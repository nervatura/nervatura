{"meta":{"reportkey":"csv_vat_en","nervatype":"report","repname":"VAT Summary - CSV output.","description":"Recoverable and payable VAT summary grouped by currency.","label":"Invoice","filetype":"csv"},"details":[{"columns":["curr","taxcode","netamount_out","vatamount_out","netamount_in","vatamount_in","vatamount_diff"],"name":"tax_total","databind":"total"},{"columns":["curr","transnumber","duedate","custname","taxcode","netamount","vatamount","amount"],"name":"items","databind":"ds"}],"sources":{"total":{"default":"select t.curr as curr, case when t.notax=1 then 'AAM' else tx.taxcode end as taxcode , sum(case when dg.groupvalue='out' then netamount else 0 end) as netamount_out , sum(case when dg.groupvalue='in' then netamount else 0 end) as netamount_in , sum(case when dg.groupvalue='out' then vatamount else 0 end) as vatamount_out , sum(case when dg.groupvalue='in' then vatamount else 0 end) as vatamount_in , sum(case when dg.groupvalue='out' then amount else 0 end) as amount_out , sum(case when dg.groupvalue='in' then amount else 0 end) as amount_in ,sum(case when dg.groupvalue='in' then vatamount else 0 end-case when dg.groupvalue='out' then vatamount else 0 end) as vatamount_diff from trans t inner join groups tg on t.transtype = tg.id and tg.groupvalue='invoice' inner join groups dg on t.direction = dg.id inner join item ti on t.id=ti.trans_id and ti.deleted=0 inner join tax tx on ti.tax_id=tx.id where t.deleted=0 and t.transdate >= @date_from and t.transdate <= @date_to @where_str group by t.curr, case when t.notax=1 then 'AAM' else tx.taxcode end order by t.curr DESC, case when t.notax=1 then 'AAM' else tx.taxcode end DESC"},"ds":{"default":"select @date_from as date_from, @date_to as date_to, t.transnumber as transnumber, t.crdate as crdate, t.transdate as transdate, substr(cast(t.duedate as char(10)), 1, 10) as  duedate, c.custname as custname, t.curr as curr, dg.groupvalue as direction , case when t.notax=1 then 'AAM' else tx.taxcode end as taxcode , case when dg.groupvalue='in' then 0-sum(netamount) else sum(netamount) end as netamount , case when dg.groupvalue='in' then 0-sum(vatamount) else sum(vatamount) end as vatamount , case when dg.groupvalue='in' then 0-sum(amount) else sum(amount) end as amount from trans t inner join groups tg on t.transtype = tg.id and tg.groupvalue='invoice' inner join groups dg on t.direction = dg.id inner join item ti on t.id=ti.trans_id and ti.deleted=0 inner join customer c on t.customer_id = c.id inner join tax tx on ti.tax_id=tx.id where t.deleted=0 and t.transdate >= @date_from and t.transdate <= @date_to @where_str group by t.transnumber, t.crdate, t.transdate, substr(cast(t.duedate as char(10)), 1, 10), c.custname, t.curr, dg.groupvalue, case when t.notax=1 then 'AAM' else tx.taxcode end order by t.curr DESC, dg.groupvalue, t.transdate, case when t.notax=1 then 'AAM' else tx.taxcode end DESC","mssql":"select @date_from as date_from, @date_to as date_to, t.transnumber as transnumber, t.crdate as crdate, t.transdate as transdate, CONVERT(VARCHAR(10), t.duedate, 120) as duedate, c.custname as custname, t.curr as curr, dg.groupvalue as direction , case when t.notax=1 then 'AAM' else tx.taxcode end as taxcode , case when dg.groupvalue='in' then 0-sum(netamount) else sum(netamount) end as netamount , case when dg.groupvalue='in' then 0-sum(vatamount) else sum(vatamount) end as vatamount , case when dg.groupvalue='in' then 0-sum(amount) else sum(amount) end as amount from trans t inner join groups tg on t.transtype = tg.id and tg.groupvalue='invoice' inner join groups dg on t.direction = dg.id inner join item ti on t.id=ti.trans_id and ti.deleted=0 inner join customer c on t.customer_id = c.id inner join tax tx on ti.tax_id=tx.id where t.deleted=0 and t.transdate >= @date_from and t.transdate <= @date_to @where_str group by t.transnumber, t.crdate, t.transdate, CONVERT(VARCHAR(10), t.duedate, 120), c.custname, t.curr, dg.groupvalue, case when t.notax=1 then 'AAM' else tx.taxcode end order by t.curr DESC, dg.groupvalue, t.transdate, case when t.notax=1 then 'AAM' else tx.taxcode end DESC"}},"fields":{"date_from":{"fieldtype":"date","wheretype":"in","description":"From date","orderby":0,"defvalue":"-360"},"date_to":{"fieldtype":"date","wheretype":"in","description":"To date","orderby":1},"curr":{"fieldtype":"string","wheretype":"where","description":"Currency","orderby":2}},"data":{"labels":{"curr":"Currency","taxcode":"VAT%","netamount_out":"Net income","vatamount_out":"VAT(+)","netamount_in":"Net payment","vatamount_in":"VAT(-)","vatamount_diff":"VAT Diff.","transnumber":"Invoice No.","duedate":"Due Date","custname":"Customer","netamount":"Net","vatamount":"VAT amount","amount":"Gross"}}}