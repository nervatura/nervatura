"use strict";(self.webpackChunknervatura_client=self.webpackChunknervatura_client||[]).push([[52,820],{6946:function(e,t,r){r.r(t),r.d(t,{default:function(){return A}});var n=r(1413),a=r(4942),l=r(885),s=r(4925),o=r(7313),i=r(4754),d=r.n(i),u=r(4848),p=(r(2580),"Selector_modal__aXtP3"),c="Selector_dialog__xunTR",f="Selector_panel__ACXnx",m="Selector_panelTitle__o8rAJ",g="Selector_closeIcon__XR58M",_="Selector_searchCol__qV+9o",v="Selector_exclamation__CI215",y=r(8907),h=r(4721),w=r(6360),b=r(5750),E=r(1012),C=r(6417),T=["view","columns","result","filter","selectorPage","paginationPage","currentPage","className","getText","onClose","onSelect","onSearch","onCurrentPage"],S=function(e){var t=e.view,r=e.columns,i=e.result,u=e.filter,S=e.selectorPage,A=e.paginationPage,q=e.currentPage,j=e.className,x=e.getText,X=e.onClose,F=e.onSelect,P=e.onSearch,M=e.onCurrentPage,k=(0,s.Z)(e,T),Z=(0,o.useState)({filter:u}),N=(0,l.Z)(Z,2),D=N[0],O=N[1],I={view:{columnDef:{id:"view",Header:"",headerStyle:{},Cell:function(e){var t=e.row;e.value;return 1===t.original.deleted?(0,C.jsx)(b.Z,{iconKey:"ExclamationTriangle",className:v}):(0,C.jsx)(b.Z,{iconKey:"CaretRight",width:9,height:24})},cellStyle:{width:25,padding:"7px 2px 3px 8px"}}}};r.forEach((function(e){I=d()(I,{$merge:(0,a.Z)({},e[0],{fieldtype:"string",label:x(t+"_"+e[0])})})}));var L=function(){return(0,C.jsxs)("div",{className:"".concat(f," ").concat(j),children:[(0,C.jsx)("div",{className:"".concat(m," ","primary"),children:X?(0,C.jsxs)("div",{className:"row full",children:[(0,C.jsx)("div",{className:"cell",children:(0,C.jsx)(y.Z,{value:x("search_"+t),leftIcon:(0,C.jsx)(b.Z,{iconKey:"Search"}),iconWidth:"20px"})}),(0,C.jsx)("div",{className:"cell align-right".concat(" ",g),children:(0,C.jsx)(b.Z,{id:"closeIcon",iconKey:"Times",onClick:X})})]}):(0,C.jsx)(y.Z,{value:x("quick_search")+": "+x("search_"+t)})}),(0,C.jsxs)("div",{className:"section",children:[(0,C.jsxs)("div",{className:"row full container section-small-bottom",children:[(0,C.jsx)("div",{className:"cell",children:(0,C.jsx)(w.Z,{id:"filter",type:"text",className:"full",placeholder:x("placeholder_search"),autoFocus:!0,value:D.filter,onEnter:function(){return P(D.filter)},onChange:function(e){return O((0,n.Z)((0,n.Z)({},D),{},{filter:e}))}})}),(0,C.jsx)("div",{className:"cell".concat(" ",_),children:(0,C.jsx)(h.Z,{id:"btn_search",className:"full medium",onClick:function(){return P(D.filter)},value:(0,C.jsx)(y.Z,{value:x("label_search"),leftIcon:(0,C.jsx)(b.Z,{iconKey:"Search"}),center:!0})})})]}),(0,C.jsx)("div",{className:"row full container section-small-bottom",children:(0,C.jsx)(E.Z,{fields:I,rows:i,filterPlaceholder:x("placeholder_search"),paginationPage:X?S:A,paginationTop:!0,hidePaginatonSize:!0,currentPage:q,onCurrentPage:M,onRowSelected:function(e){return F(e,D.filter)}})})]})]})};return X?(0,C.jsx)("div",{className:"modal".concat(" ",p),children:(0,C.jsx)("div",(0,n.Z)((0,n.Z)({className:"dialog".concat(" ",c)},k),{},{children:L()}))}):L()};S.defaultProps={view:"",columns:[],result:[],filter:"",selectorPage:(0,u.$8)("selectorPage"),paginationPage:(0,u.$8)("paginationPage"),currentPage:0,className:"",getText:void 0,onClose:void 0,onSearch:void 0,onSelect:void 0,onCurrentPage:void 0};var A=S},9820:function(e,t,r){r.r(t),r.d(t,{Quick:function(){return n}});var n=function(e){e.getText;return{customer:function(){return{sql:{select:["{CCS}'customer'{SEP}'//'{SEP} {CAS_TEXT}c.id {CAE_TEXT}{CCE} as id","c.custname as label","c.custname as custname","c.custnumber as custnumber","addr.city as city","addr.street as street"],from:"customer c",left_join:[[[{select:["*"],from:"address",where:["id","in",[{select:["min(id) fid"],from:"address a",where:[["a.deleted","=","0"],["and","a.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'customer'"]]}]]],group_by:["a.ref_id"]}]]}],"addr"],"on",["c.id","=","addr.ref_id"]],where:[["c.deleted","=","0"],["and","c.id","not in",[{select:["customer.id"],from:"customer",inner_join:["groups","on",[["customer.custtype","=","groups.id"],["and","groups.groupvalue","=","'own'"]]]}]]]},columns:[["custname","c.custname"],["custnumber","c.custnumber"],["city","addr.city"],["street","addr.street"]]}},employee:function(){return{sql:{select:["{CCS}'employee'{SEP}'//'{SEP} {CAS_TEXT}e.id {CAE_TEXT}{CCE} as id","e.empnumber as label","e.empnumber as empnumber","pt.groupvalue as usergroup","c.firstname as firstname","c.surname as surname"],from:"employee e",inner_join:["groups pt","on",["e.usergroup","=","pt.id"]],left_join:["contact c","on",[["e.id","=","c.ref_id"],["and","c.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'employee'"]]}]]]],where:[["e.deleted","=","0"]]},columns:[["empnumber","e.empnumber"],["usergroup","pt.groupvalue"],["firstname","c.firstname"],["surname","c.surname"]]}},payment:function(){return{sql:{select:["{CCS}'payment'{SEP}'/'{SEP} tg.groupvalue{SEP}'/'{SEP} {CAS_TEXT}p.id {CAE_TEXT}{CCE} as id","{CCS}t.transnumber{SEP} case when tg.groupvalue='bank' then {CCS}' ~ '{SEP} {CAS_TEXT}p.id {CAE_TEXT} {CCE} else '' end {CCE} as label","{CCS}t.transnumber{SEP} case when tg.groupvalue='bank' then {CCS}' ~ '{SEP} {CAS_TEXT}p.id {CAE_TEXT} {CCE} else '' end {CCE} as paidnumber","{FMS_DATE}p.paiddate {FME_DATE} as paiddate","tg.groupvalue as transtype","dg.groupvalue as direction","pl.curr as curr","p.amount as amount","t.id as trans_id"],from:"payment p",inner_join:[["trans t","on",[["p.trans_id","=","t.id"],["and","t.deleted","=","0"]]],["groups tg","on",["t.transtype","=","tg.id"]],["groups dg","on",["t.direction","=","dg.id"]],["place pl","on",["t.place_id","=","pl.id"]]],where:[["p.deleted","=","0"]]},columns:[["paidnumber","{CCS}t.transnumber{SEP} case when tg.groupvalue='bank' then {CCS}' ~ '{SEP} {CAS_TEXT}p.id {CAE_TEXT} {CCE} else '' end {CCE}"],["paiddate","p.paiddate"],["curr","pl.curr"],["amount","p.amount"]]}},place:function(){return{sql:{select:["{CCS}'place'{SEP}'/'{SEP}'/'{SEP} {CAS_TEXT}p.id {CAE_TEXT}{CCE} as id","{CCS}p.planumber{SEP} case when p.curr is null then '' else {CCS}' | ' {SEP}p.curr {CCE} end{CCE} as label","p.planumber as planumber","p.description as description","pt.groupvalue as placetype"],from:"place p",inner_join:["groups pt","on",["p.placetype","=","pt.id"]],where:[["p.deleted","=","0"]]},columns:[["planumber","p.planumber"],["description","p.description"],["placetype","pt.groupvalue"]]}},place_bank:function(){return{sql:{select:["{CCS}'place'{SEP}'/'{SEP}'/'{SEP} {CAS_TEXT}p.id {CAE_TEXT}{CCE} as id","{CCS}p.planumber{SEP} case when p.curr is null then '' else {CCS}' | ' {SEP}p.curr {CCE} end{CCE} as label","p.planumber as planumber","p.description as description","p.curr as curr"],from:"place p",inner_join:["groups pt","on",[["p.placetype","=","pt.id"],["and","pt.groupvalue","=","'bank'"]]],where:[["p.deleted","=","0"]]},columns:[["planumber","p.planumber"],["description","p.description"],["curr","p.curr"]]}},place_cash:function(){return{sql:{select:["{CCS}'place'{SEP}'/'{SEP}'/'{SEP} {CAS_TEXT}p.id {CAE_TEXT}{CCE} as id","{CCS}p.planumber{SEP} case when p.curr is null then '' else {CCS}' | ' {SEP}p.curr {CCE} end{CCE} as label","p.planumber as planumber","p.description as description","p.curr as curr"],from:"place p",inner_join:["groups pt","on",[["p.placetype","=","pt.id"],["and","pt.groupvalue","=","'cash'"]]],where:[["p.deleted","=","0"]]},columns:[["planumber","p.planumber"],["description","p.description"],["curr","p.curr"]]}},place_warehouse:function(){return{sql:{select:["{CCS}'place'{SEP}'/'{SEP}'/'{SEP} {CAS_TEXT}p.id {CAE_TEXT}{CCE} as id","p.planumber as label","p.planumber as planumber","p.description as description"],from:"place p",inner_join:["groups pt","on",[["p.placetype","=","pt.id"],["and","pt.groupvalue","=","'warehouse'"]]],where:[["p.deleted","=","0"]]},columns:[["planumber","p.planumber"],["description","p.description"]]}},product:function(){return{sql:{select:["{CCS}'product'{SEP}'//'{SEP} {CAS_TEXT}p.id {CAE_TEXT}{CCE} as id","p.partnumber as label","p.partnumber as partnumber","p.description as description","pt.groupvalue as protype","p.unit","p.tax_id"],from:"product p",inner_join:["groups pt","on",["p.protype","=","pt.id"]],where:[["p.deleted","=","0"]]},columns:[["partnumber","p.partnumber"],["description","p.description"],["protype","pt.groupvalue"]]}},product_item:function(){return{sql:{select:["{CCS}'product'{SEP}'//'{SEP} {CAS_TEXT}p.id {CAE_TEXT}{CCE} as id","{CCS}p.partnumber{SEP}' | '{SEP}p.description{CCE} as label","p.partnumber as partnumber","p.description as description","pt.groupvalue as protype","p.unit","p.tax_id","tx.taxcode as tax"],from:"product p",inner_join:["groups pt","on",[["p.protype","=","pt.id"],["and","pt.groupvalue","=","'item'"]]],left_join:["tax tx","on",["p.tax_id","=","tx.id"]],where:[["p.deleted","=","0"]]},columns:[["partnumber","p.partnumber"],["description","p.description"],["protype","pt.groupvalue"],["tax","tx.taxcode"]]}},project:function(){return{sql:{select:["{CCS}'project'{SEP}'//'{SEP} {CAS_TEXT}p.id {CAE_TEXT}{CCE} as id","p.pronumber as label","p.pronumber as pronumber","p.description as description","p.startdate as startdate"],from:"project p",where:[["p.deleted","=","0"]]},columns:[["pronumber","p.pronumber"],["description","p.description"],["startdate","p.startdate"]]}},report:function(e){return{sql:{select:["{CCS}'report'{SEP}'//'{SEP} {CAS_TEXT}r.id {CAE_TEXT}{CCE} as id","r.repname as label","r.repname as repname","r.label as rlabel","r.description as description","ft.groupvalue as ftype"],from:"ui_report r",inner_join:[["groups tg","on",["r.nervatype","=","tg.id"]],["groups ft","on",["r.filetype","=","ft.id"]]],where:[["tg.groupvalue","=","'report'"],["and","ft.groupvalue","in",[[],"'pdf'","'csv'"]],["and","r.id","not in",[{select:["ur.id"],from:"ui_audit a",inner_join:[["ui_report ur","on",["a.subtype","=","ur.id"]],["groups inf","on",["a.inputfilter","=","inf.id"]]],where:[["inf.groupvalue","=","'disabled'"],["and","a.usergroup","=",e]]}]]]},columns:[["repname","r.repname"],["label","r.label"],["description","r.description"]]}},servercmd:function(e){return{sql:{select:["{CCS}'servercmd'{SEP}'//'{SEP} {CAS_TEXT}m.id {CAE_TEXT}{CCE} as id","m.description as label","m.description as description"],from:"ui_menu m",inner_join:["groups st","on",["m.method","=","st.id"]],where:[["st.groupvalue","<>","'printer'"],["and","m.id","not in",[{select:["um.id"],from:"ui_audit a",inner_join:[["ui_menu um","on",["a.subtype","=","um.id"]],["groups inf","on",["a.inputfilter","=","inf.id"]]],where:[["inf.groupvalue","=","'disabled'"],["and","a.usergroup","=",e]]}]]]},columns:[["description","m.description"]]}},tool:function(){return{sql:{select:["{CCS}'tool'{SEP}'//'{SEP} {CAS_TEXT}t.id {CAE_TEXT}{CCE} as id","t.serial as label","t.serial as serial","t.description as description","p.description as product"],from:"tool t",inner_join:["product p","on",["t.product_id","=","p.id"]],where:[["t.deleted","=","0"]]},columns:[["serial","t.serial"],["description","t.description"],["product","p.description"]]}},transitem:function(){return{sql:{select:["{CCS}'trans'{SEP}'/'{SEP} tg.groupvalue{SEP}'/'{SEP} {CAS_TEXT}t.id {CAE_TEXT}{CCE} as id","t.transnumber as label","t.transnumber as transnumber","{CCS}tg.groupvalue{SEP}'-'{SEP}dg.groupvalue{CCE} as transtype","c.custname as custname","t.deleted as deleted"],from:"trans t",inner_join:[["groups tg","on",[["t.transtype","=","tg.id"],["and","tg.groupvalue","in",[[],"'invoice'","'receipt'","'order'","'offer'","'worksheet'","'rent'"]]]],["groups dg","on",["t.direction","=","dg.id"]]],left_join:["customer c","on",["t.customer_id","=","c.id"]],where:[[[["t.deleted","=","0"],["or",[["tg.groupvalue","=","'invoice'"],["and","dg.groupvalue","=","'out'"]]],["or",[["tg.groupvalue","=","'receipt'"],["and","dg.groupvalue","=","'out'"]]]]]]},columns:[["transnumber","t.transnumber"],["transtype","{CCS}tg.groupvalue{SEP}'-'{SEP}dg.groupvalue{CCE}"],["custname","c.custname"]]}},transitem_invoice:function(){return{sql:{select:["{CCS}'trans'{SEP}'/'{SEP}tg.groupvalue{SEP}'/'{SEP} {CAS_TEXT}t.id {CAE_TEXT}{CCE} as id","t.transnumber as label","t.transnumber as transnumber","{CCS}tg.groupvalue{SEP}'-'{SEP}dg.groupvalue{CCE} as transtype","c.custname as custname","t.deleted as deleted","t.curr","t.id as trans_id"],from:"trans t",inner_join:[[["groups tg","on",["t.transtype","=","tg.id"]],["and","tg.groupvalue","in",[[],"'invoice'","'receipt'"]]],["groups dg","on",["t.direction","=","dg.id"]]],left_join:["customer c","on",["t.customer_id","=","c.id"]],where:[[[["t.deleted","=","0"],["or",[["tg.groupvalue","=","'invoice'"],["and","dg.groupvalue","=","'out'"]]]]]]},columns:[["transnumber","t.transnumber"],["transtype","{CCS}tg.groupvalue{SEP}'-'{SEP}dg.groupvalue{CCE}"],["custname","c.custname"],["curr","t.curr"]]}},transitem_delivery:function(){return{sql:{select:["{CCS}'trans'{SEP}'/'{SEP}tg.groupvalue{SEP}'/'{SEP} {CAS_TEXT}t.id {CAE_TEXT}{CCE} as id","t.transnumber as label","t.transnumber as transnumber","{CCS}tg.groupvalue{SEP}'-'{SEP}dg.groupvalue{CCE} as transtype","c.custname as custname","t.deleted as deleted"],from:"trans t",inner_join:[["groups tg","on",[["t.transtype","=","tg.id"],["and","tg.groupvalue","in",[[],"'order'","'worksheet'","'rent'"]]]],["groups dg","on",["t.direction","=","dg.id"]]],left_join:["customer c","on",["t.customer_id","=","c.id"]],where:[["t.deleted","=","0"]]},columns:[["transnumber","t.transnumber"],["transtype","{CCS}tg.groupvalue{SEP}'-'{SEP}dg.groupvalue{CCE}"],["custname","c.custname"]]}},transmovement:function(){return{sql:{select:["{CCS}'trans'{SEP}'/'{SEP} tg.groupvalue{SEP}'/'{SEP} {CAS_TEXT}t.id {CAE_TEXT}{CCE} as id","t.transnumber as label","t.transnumber as transnumber","{CCS}tg.groupvalue{SEP}'-'{SEP}dg.groupvalue{CCE} as transtype","{FMS_DATE}t.transdate {FME_DATE} as transdate"],from:"trans t",inner_join:[["groups tg","on",[["t.transtype","=","tg.id"],["and","tg.groupvalue","in",[[],"'delivery'","'inventory'","'waybill'","'production'","'formula'"]]]],["groups dg","on",["t.direction","=","dg.id"]]],where:[["t.deleted","=","0"]]},columns:[["transnumber","t.transnumber"],["transtype","{CCS}tg.groupvalue{SEP}'-'{SEP}dg.groupvalue{CCE}"],["transdate","{FMS_DATE}t.transdate {FME_DATE}"]]}},transpayment:function(){return{sql:{select:["{CCS}'trans'{SEP}'/'{SEP}tg.groupvalue{SEP}'/'{SEP} {CAS_TEXT}t.id {CAE_TEXT}{CCE} as id","t.transnumber as label","t.transnumber as transnumber","{CCS}tg.groupvalue{SEP}'-'{SEP}dg.groupvalue{CCE} as transtype","p.description as place","p.curr as curr"],from:"trans t",inner_join:[["groups tg","on",[["t.transtype","=","tg.id"],["and","tg.groupvalue","in",[[],"'bank'","'cash'"]]]],["groups dg","on",["t.direction","=","dg.id"]],["place p","on",["t.place_id","=","p.id"]]],where:[[[["t.deleted","=","0"],["or",["tg.groupvalue","=","'cash'"]]]]]},columns:[["transnumber","t.transnumber"],["transtype","{CCS}tg.groupvalue{SEP}'-'{SEP}dg.groupvalue{CCE}"],["place","p.description"],["curr","p.curr"]]}}}}},8052:function(e,t,r){r.r(t),r.d(t,{default:function(){return Ce}});var n=r(5861),a=r(4942),l=r(2982),s=r(1413),o=r(885),i=r(7757),d=r.n(i),u=r(7313),p=r(4754),c=r.n(p),f=r(7559),m=r(2361),g=r(5919),_=function(e){var t=e.getText;return{customer:function(){return{options:{deffield_sql:{select:["df.id","df.fieldname","g.groupvalue as fieldtype","df.description"],from:"deffield df",inner_join:["groups g","on",["g.id","=","df.fieldtype"]],where:[["df.deleted","=","0"],["and","df.visible","=","1"],["and","df.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'customer'"]]}]]]}},CustomerView:{columns:{custnumber:!0,custname:!0,address:!0},label:t("customer_view"),fields:{custnumber:{fieldtype:"string",wheretype:"where",orderby:0,label:t("customer_custnumber"),sqlstr:"c.custnumber "},custname:{fieldtype:"string",wheretype:"where",orderby:1,label:t("customer_custname"),sqlstr:"c.custname "},taxnumber:{fieldtype:"string",wheretype:"where",orderby:2,label:t("customer_taxnumber"),sqlstr:"c.taxnumber "},custtype:{fieldtype:"string",wheretype:"where",orderby:3,label:t("customer_custtype"),sqlstr:"case when mst.msg is null then tg.groupvalue else mst.msg end "},account:{fieldtype:"string",wheretype:"where",orderby:4,label:t("customer_account"),sqlstr:"c.account "},notax:{fieldtype:"bool",wheretype:"where",orderby:5,label:t("customer_notax"),sqlstr:"c.notax "},terms:{fieldtype:"float",wheretype:"where",orderby:6,label:t("customer_terms"),sqlstr:"c.terms "},creditlimit:{fieldtype:"float",wheretype:"where",aggretype:"sum",orderby:7,label:t("customer_creditlimit"),sqlstr:"c.creditlimit "},discount:{fieldtype:"float",wheretype:"where",orderby:8,label:t("customer_discount"),sqlstr:"c.discount "},notes:{fieldtype:"string",wheretype:"where",orderby:9,label:t("customer_notes"),sqlstr:"c.notes "},inactive:{fieldtype:"bool",wheretype:"where",orderby:10,label:t("customer_inactive"),sqlstr:"c.inactive "},address:{fieldtype:"string",wheretype:"where",orderby:11,label:t("customer_address"),sqlstr:"{CCS}case when addr.city is null then '' else addr.city end {SEP} ' ' {SEP} case when addr.street is null then '' else addr.street end{CCE} "}},sql:{select:["{CCS}'customer'{SEP}'//'{SEP} {CAS_TEXT}c.id {CAE_TEXT}{CCE} as id","c.id as row_id","c.custnumber","c.custname","case when mst.msg is null then tg.groupvalue else mst.msg end as custtype","c.taxnumber","c.account","c.notax","{FMS_FLOAT}c.terms{FME_FLOAT} as terms","c.terms as export_terms","{FMS_FLOAT}c.creditlimit{FME_FLOAT} as creditlimit","c.creditlimit as export_creditlimit","c.discount","c.notes","c.inactive","{CCS}case when addr.city is null then '' else addr.city end {SEP} ' ' {SEP} case when addr.street is null then '' else addr.street end{CCE} as address"],from:"customer c",inner_join:["groups tg","on",["c.custtype","=","tg.id"]],left_join:[["ui_message mst","on",[["mst.fieldname","=","tg.groupvalue"],["and","mst.secname","=","'custtype'"],["and","mst.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]],[[[{select:["*"],from:"address",where:["id","in",[{select:["min(id) fid"],from:"address a",where:[["a.deleted","=","0"],["and","a.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'customer'"]]}]]],group_by:["a.ref_id"]}]]}],"addr"],"on",["c.id","=","addr.ref_id"]]],where:[["c.deleted","=","0"],["and","c.id","not in",[{select:["customer.id"],from:"customer",inner_join:["groups","on",[["customer.custtype","=","groups.id"],["and","groups.groupvalue","=","'own'"]]]}]]]}},CustomerFieldsView:{columns:{custname:!0,fielddef:!0,deffield_value:!0},label:t("fields_view"),fields:{custnumber:{fieldtype:"string",wheretype:"where",orderby:0,label:t("customer_custnumber"),sqlstr:"c.custnumber"},custname:{fieldtype:"string",wheretype:"where",orderby:1,label:t("customer_custname"),sqlstr:"c.custname "},fielddef:{fieldtype:"string",wheretype:"where",orderby:2,label:t("fields_fielddef"),sqlstr:"df.description "},deffield_value:{fieldtype:"string",wheretype:"where",orderby:3,label:t("fields_value"),sqlstr:"fv.value "},notes:{fieldtype:"string",wheretype:"where",orderby:4,label:t("fields_notes"),sqlstr:"fv.notes "}},sql:{select:["{CCS}'customer'{SEP}'//'{SEP} {CAS_TEXT}c.id {CAE_TEXT}{CCE} as id","fv.id as row_id","fv.fieldname","c.custnumber","c.custname","df.description as fielddef","'fieldvalue' as form","fg.groupvalue as fieldtype","case when fg.groupvalue in ('bool') then fv.value when fg.groupvalue in ('integer') then {CCS}{FMS_INT}fv.value{FME_INT}{CCE} when fg.groupvalue in ('float') then {CCS}{FMS_FLOAT}fv.value{FME_FLOAT}{CCE} when fg.groupvalue in ('customer') then {CCS}'customer//'{SEP} {CAS_TEXT}rf_customer.id {CAE_TEXT}{CCE} when fg.groupvalue in ('tool') then {CCS}'tool//'{SEP} {CAS_TEXT}rf_tool.id {CAE_TEXT}{CCE} when fg.groupvalue in ('product') then {CCS}'product//'{SEP} {CAS_TEXT}rf_product.id {CAE_TEXT}{CCE} when fg.groupvalue in ('trans', 'transitem', 'transmovement', 'transpayment') then {CCS}'trans//'{SEP} {CAS_TEXT}rf_trans.id {CAE_TEXT}{CCE} when fg.groupvalue in ('project') then {CCS}'project//'{SEP} {CAS_TEXT}rf_project.id {CAE_TEXT}{CCE} when fg.groupvalue in ('employee') then {CCS}'employee//'{SEP} {CAS_TEXT}rf_employee.id {CAE_TEXT}{CCE} when fg.groupvalue in ('place') then {CCS}'place//'{SEP} {CAS_TEXT}rf_place.id {CAE_TEXT}{CCE} when fg.groupvalue in ('urlink') then {CCS}'url/'{SEP}fv.value{CCE} when fg.groupvalue in ('password') then '**********' when fg.groupvalue in ('notes', 'string', 'valuelist','date','time') then fv.value else null end as deffield_value, case when fg.groupvalue in ('bool','float','integer','date','time','urlink','notes', 'string', 'valuelist') then fv.value when fg.groupvalue in ('customer') then rf_customer.custname when fg.groupvalue in ('tool') then rf_tool.serial when fg.groupvalue in ('product') then rf_product.partnumber when fg.groupvalue in ('trans', 'transitem', 'transmovement', 'transpayment') then rf_trans.transnumber when fg.groupvalue in ('project') then rf_project.pronumber when fg.groupvalue in ('employee') then rf_employee.empnumber when fg.groupvalue in ('place') then rf_place.planumber when fg.groupvalue in ('password') then '**********' else null end as export_deffield_value, fv.notes"],from:"fieldvalue fv",inner_join:[["deffield df","on",[["fv.fieldname","=","df.fieldname"],["and","df.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'customer'"]]}]],["and","df.visible","=","1"],["and","df.deleted","=","0"]]],["groups fg","on",["df.fieldtype","=","fg.id"]],["customer c","on",["fv.ref_id","=","c.id"]]],left_join:[[[[{select:["fieldname"],from:"deffield df",inner_join:["groups fg","on",[["df.fieldtype","=","fg.id"],["and","fg.groupvalue","in",[[],"'integer'","'float'"]]]]}],"rf_number"],"on",["fv.fieldname","=","rf_number.fieldname"]],[[[{select:["fieldname"],from:"deffield df",inner_join:["groups fg","on",[["df.fieldtype","=","fg.id"],["and","fg.groupvalue","=","'date'"]]]}],"rf_date"],"on",["fv.fieldname","=","rf_date.fieldname"]],["customer rf_customer","on",["fv.value","=","{CAS_TEXT}rf_customer.id {CAE_TEXT}"]],["tool rf_tool","on",["fv.value","=","{CAS_TEXT}rf_tool.id {CAE_TEXT}"]],["trans rf_trans","on",["fv.value","=","{CAS_TEXT}rf_trans.id {CAE_TEXT}"]],["product rf_product","on",["fv.value","=","{CAS_TEXT}rf_product.id {CAE_TEXT}"]],["project rf_project","on",["fv.value","=","{CAS_TEXT}rf_project.id {CAE_TEXT}"]],["employee rf_employee","on",["fv.value","=","{CAS_TEXT}rf_employee.id {CAE_TEXT}"]],["place rf_place","on",["fv.value","=","{CAS_TEXT}rf_place.id {CAE_TEXT}"]]],where:[["fv.deleted","=","0"],["and","c.deleted","=","0"],["and","c.id","not in",[{select:["customer.id"],from:"customer",inner_join:["groups","on",[["customer.custtype","=","groups.id"],["and","groups.groupvalue","=","'own'"]]]}]]]}},CustomerContactView:{columns:{custname:!0,firstname:!0,surname:!0,phone:!0},label:t("contact_view"),fields:{custnumber:{fieldtype:"string",wheretype:"where",orderby:0,label:t("customer_custnumber"),sqlstr:"c.custnumber "},custname:{fieldtype:"string",wheretype:"where",orderby:1,label:t("customer_custname"),sqlstr:"c.custname "},firstname:{fieldtype:"string",wheretype:"where",orderby:2,label:t("contact_firstname"),sqlstr:"co.firstname"},surname:{fieldtype:"string",wheretype:"where",orderby:3,label:t("contact_surname"),sqlstr:" co.surname"},status:{fieldtype:"string",wheretype:"where",orderby:4,label:t("contact_status"),sqlstr:" co.status"},phone:{fieldtype:"string",wheretype:"where",orderby:5,label:t("contact_phone"),sqlstr:" co.phone"},fax:{fieldtype:"string",wheretype:"where",orderby:6,label:t("contact_fax"),sqlstr:" co.fax"},mobil:{fieldtype:"string",wheretype:"where",orderby:7,label:t("contact_mobil"),sqlstr:" co.mobil"},email:{fieldtype:"string",wheretype:"where",orderby:8,label:t("contact_email"),sqlstr:" co.email"},notes:{fieldtype:"string",wheretype:"where",orderby:9,label:t("contact_notes"),sqlstr:" co.notes"}},sql:{select:["{CCS}'customer'{SEP}'//'{SEP} {CAS_TEXT}c.id {CAE_TEXT}{CCE} as id","co.id as row_id","c.custnumber","c.custname","co.firstname","co.surname","co.status","co.phone","co.fax","co.mobil","co.email","co.notes","'contact' as form","co.id as form_id"],from:"contact co",inner_join:["customer c","on",["co.ref_id","=","c.id"]],where:[["co.deleted","=","0"],["and","c.deleted","=","0"],["and","co.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'customer'"]]}]],["and","c.id","not in",[{select:["customer.id"],from:"customer",inner_join:["groups","on",[["customer.custtype","=","groups.id"],["and","groups.groupvalue","=","'own'"]]]}]]]}},CustomerAddressView:{columns:{custname:!0,city:!0,street:!0},label:t("address_view"),fields:{custnumber:{fieldtype:"string",wheretype:"where",orderby:0,label:t("customer_custnumber"),sqlstr:"c.custnumber "},custname:{fieldtype:"string",wheretype:"where",orderby:1,label:t("customer_custname"),sqlstr:"c.custname "},country:{fieldtype:"string",wheretype:"where",orderby:2,label:t("address_country"),sqlstr:"a.country"},state:{fieldtype:"string",wheretype:"where",orderby:3,label:t("address_state"),sqlstr:"a.state"},zipcode:{fieldtype:"string",wheretype:"where",orderby:4,label:t("address_zipcode"),sqlstr:"a.zipcode "},city:{fieldtype:"string",wheretype:"where",orderby:5,label:t("address_city"),sqlstr:"a.city"},street:{fieldtype:"string",wheretype:"where",orderby:6,label:t("address_street"),sqlstr:"a.street"},notes:{fieldtype:"string",wheretype:"where",orderby:7,label:t("address_notes"),sqlstr:"a.notes"}},sql:{select:["{CCS}'customer'{SEP}'//'{SEP} {CAS_TEXT}c.id {CAE_TEXT}{CCE} as id","a.id as row_id","c.custnumber","c.custname","a.country","a.state","a.zipcode","a.city","a.street","a.notes","'address' as form","a.id as form_id"],from:"address a",inner_join:["customer c","on",["a.ref_id","=","c.id"]],where:[["a.deleted","=","0"],["and","c.deleted","=","0"],["and","a.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'customer'"]]}]],["and","c.id","not in",[{select:["customer.id"],from:"customer",inner_join:["groups","on",[["customer.custtype","=","groups.id"],["and","groups.groupvalue","=","'own'"]]]}]]]}},CustomerEvents:{columns:{custname:!0,fromdate:!0,subject:!0},label:t("event_view"),edit:"event",fields:{custnumber:{fieldtype:"string",wheretype:"where",orderby:0,label:t("customer_custnumber"),sqlstr:"c.custnumber "},custname:{fieldtype:"string",wheretype:"where",orderby:1,label:t("customer_custname"),sqlstr:"c.custname "},calnumber:{fieldtype:"string",wheretype:"where",orderby:2,label:t("event_calnumber"),sqlstr:"e.calnumber"},eventgroup:{fieldtype:"string",wheretype:"where",orderby:3,label:t("event_group"),sqlstr:"eg.groupvalue"},fromdate:{fieldtype:"date",wheretype:"where",orderby:4,label:t("event_fromdate"),sqlstr:"{FMS_DATE}e.fromdate {FME_DATE}"},fromtime:{fieldtype:"string",wheretype:"where",orderby:5,label:t("event_fromtime"),sqlstr:"{FMS_TIME}e.fromdate {FME_TIME}"},todate:{fieldtype:"date",wheretype:"where",orderby:6,label:t("event_todate"),sqlstr:"{FMS_DATE}e.todate {FME_DATE}"},totime:{fieldtype:"string",wheretype:"where",orderby:7,label:t("event_totime"),sqlstr:"{FMS_TIME}e.todate {FME_TIME}"},subject:{fieldtype:"string",wheretype:"where",orderby:8,label:t("event_subject"),sqlstr:"e.subject"},place:{fieldtype:"string",wheretype:"where",orderby:9,label:t("event_place"),sqlstr:"e.place"},description:{fieldtype:"string",wheretype:"where",orderby:10,label:t("event_description"),sqlstr:"e.description"}},sql:{select:["{CCS}'event'{SEP}'//'{SEP} {CAS_TEXT}e.id {CAE_TEXT}{CCE} as id","e.id as row_id","c.custnumber","c.custname","e.calnumber","eg.groupvalue as eventgroup","{FMS_DATE}e.fromdate {FME_DATE} as fromdate","{FMS_TIME}e.fromdate {FME_TIME} as fromtime","{FMS_DATE}e.todate {FME_DATE} as todate","{FMS_TIME}e.todate {FME_TIME} as totime","e.subject","e.place","e.description"],from:"event e",inner_join:["customer c","on",["e.ref_id","=","c.id"]],left_join:["groups eg","on",["e.eventgroup","=","eg.id"]],where:[["e.deleted","=","0"],["and","c.deleted","=","0"],["and","e.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'customer'"]]}]],["and","c.id","not in",[{select:["customer.id"],from:"customer",inner_join:["groups","on",[["customer.custtype","=","groups.id"],["and","groups.groupvalue","=","'own'"]]]}]]]}}}},employee:function(){return{options:{deffield_sql:{select:["df.id","df.fieldname","g.groupvalue as fieldtype","df.description"],from:"deffield df",inner_join:["groups g","on",["g.id","=","df.fieldtype"]],where:[["df.deleted","=","0"],["and","df.visible","=","1"],["and","df.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'employee'"]]}]]]}},EmployeeView:{columns:{empnumber:!0,firstname:!0,surname:!0,username:!0},label:t("employee_view"),fields:{empnumber:{fieldtype:"string",wheretype:"where",orderby:0,label:t("employee_empnumber"),sqlstr:"e.empnumber "},firstname:{fieldtype:"string",wheretype:"where",orderby:1,label:t("contact_firstname"),sqlstr:"c.firstname "},surname:{fieldtype:"string",wheretype:"where",orderby:2,label:t("contact_surname"),sqlstr:"c.surname "},username:{fieldtype:"string",wheretype:"where",orderby:3,label:t("employee_username"),sqlstr:"e.username "},startdate:{fieldtype:"date",wheretype:"where",orderby:4,label:t("employee_startdate"),sqlstr:"e.startdate "},enddate:{fieldtype:"date",wheretype:"where",orderby:5,label:t("employee_enddate"),sqlstr:"e.enddate "},status:{fieldtype:"string",wheretype:"where",orderby:6,label:t("contact_status"),sqlstr:"c.status "},phone:{fieldtype:"string",wheretype:"where",orderby:7,label:t("contact_phone"),sqlstr:"c.phone "},mobil:{fieldtype:"string",wheretype:"where",orderby:8,label:t("contact_mobil"),sqlstr:"c.mobil "},email:{fieldtype:"string",wheretype:"where",orderby:9,label:t("contact_email"),sqlstr:"c.email "},zipcode:{fieldtype:"string",wheretype:"where",orderby:10,label:t("address_zipcode"),sqlstr:"a.zipcode "},city:{fieldtype:"string",wheretype:"where",orderby:11,label:t("address_city"),sqlstr:"a.city "},street:{fieldtype:"string",wheretype:"where",orderby:12,label:t("address_street"),sqlstr:"a.street "},usergroup:{fieldtype:"string",wheretype:"where",orderby:13,label:t("employee_usergroup"),sqlstr:"ug.groupvalue "},department:{fieldtype:"string",wheretype:"where",orderby:14,label:t("employee_department"),sqlstr:"dg.groupvalue "},inactive:{fieldtype:"bool",wheretype:"where",orderby:15,label:t("employee_inactive"),sqlstr:"e.inactive "},notes:{fieldtype:"string",wheretype:"where",orderby:16,label:t("contact_notes"),sqlstr:"c.notes "}},sql:{select:["{CCS}'employee'{SEP}'//'{SEP} {CAS_TEXT}e.id {CAE_TEXT}{CCE} as id","e.id as row_id","e.empnumber","c.firstname","c.surname","e.username","{FMS_DATE}e.startdate {FME_DATE} as startdate","{FMS_DATE}e.enddate {FME_DATE} as enddate","c.status","c.phone","c.mobil","c.email","a.zipcode","a.city","a.street","ug.groupvalue as usergroup","dg.groupvalue as department","c.notes","e.inactive"],from:"employee e",inner_join:["groups ug","on",["e.usergroup","=","ug.id"]],left_join:[["contact c","on",[["e.id","=","c.ref_id"],["and","c.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'employee'"]]}]]]],["address a","on",[["e.id","=","a.ref_id"],["and","a.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'employee'"]]}]]]],["groups dg","on",["e.department","=","dg.id"]]],where:[["e.deleted","=","0"]]}},EmployeeFieldsView:{columns:{empnumber:!0,fielddef:!0,deffield_value:!0},label:t("fields_view"),fields:{empnumber:{fieldtype:"string",wheretype:"where",orderby:0,label:t("employee_empnumber"),sqlstr:"e.empnumber "},firstname:{fieldtype:"string",wheretype:"where",orderby:1,label:t("contact_firstname"),sqlstr:"c.firstname "},surname:{fieldtype:"string",wheretype:"where",orderby:2,label:t("contact_surname"),sqlstr:"c.surname "},username:{fieldtype:"string",wheretype:"where",orderby:3,label:t("employee_username"),sqlstr:"e.username "},fielddef:{fieldtype:"string",wheretype:"where",orderby:4,label:t("fields_fielddef"),sqlstr:"df.description "},deffield_value:{fieldtype:"string",wheretype:"where",orderby:5,label:t("fields_value"),sqlstr:"fv.value "},notes:{fieldtype:"string",wheretype:"where",orderby:6,label:t("fields_notes"),sqlstr:"fv.notes "}},sql:{select:["{CCS}'employee'{SEP}'//'{SEP} {CAS_TEXT}e.id {CAE_TEXT}{CCE} as id","fv.id as row_id","e.empnumber","c.firstname","c.surname","e.username","df.description as fielddef","'fieldvalue' as form","fg.groupvalue as fieldtype","case when fg.groupvalue in ('bool') then fv.value when fg.groupvalue in ('integer') then {CCS}{FMS_INT}fv.value{FME_INT}{CCE} when fg.groupvalue in ('float') then {CCS}{FMS_FLOAT}fv.value{FME_FLOAT}{CCE} when fg.groupvalue in ('customer') then {CCS}'customer//'{SEP} {CAS_TEXT}rf_customer.id {CAE_TEXT}{CCE} when fg.groupvalue in ('tool') then {CCS}'tool//'{SEP} {CAS_TEXT}rf_tool.id {CAE_TEXT}{CCE} when fg.groupvalue in ('product') then {CCS}'product//'{SEP} {CAS_TEXT}rf_product.id {CAE_TEXT}{CCE} when fg.groupvalue in ('trans', 'transitem', 'transmovement', 'transpayment') then {CCS}'trans//'{SEP} {CAS_TEXT}rf_trans.id {CAE_TEXT}{CCE} when fg.groupvalue in ('project') then {CCS}'project//'{SEP} {CAS_TEXT}rf_project.id {CAE_TEXT}{CCE} when fg.groupvalue in ('employee') then {CCS}'employee//'{SEP} {CAS_TEXT}rf_employee.id {CAE_TEXT}{CCE} when fg.groupvalue in ('place') then {CCS}'place//'{SEP} {CAS_TEXT}rf_place.id {CAE_TEXT}{CCE} when fg.groupvalue in ('urlink') then {CCS}'url/'{SEP}fv.value{CCE} when fg.groupvalue in ('password') then '**********' when fg.groupvalue in ('notes', 'string', 'valuelist','date','time') then fv.value else null end as deffield_value, case when fg.groupvalue in ('bool','float','integer','date','time','urlink','notes', 'string', 'valuelist') then fv.value when fg.groupvalue in ('customer') then rf_customer.custname when fg.groupvalue in ('tool') then rf_tool.serial when fg.groupvalue in ('product') then rf_product.partnumber when fg.groupvalue in ('trans', 'transitem', 'transmovement', 'transpayment') then rf_trans.transnumber when fg.groupvalue in ('project') then rf_project.pronumber when fg.groupvalue in ('employee') then rf_employee.empnumber when fg.groupvalue in ('place') then rf_place.planumber when fg.groupvalue in ('password') then '**********' else null end as export_deffield_value, fv.notes"],from:"fieldvalue fv",inner_join:[["deffield df","on",[["fv.fieldname","=","df.fieldname"],["and","df.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'employee'"]]}]],["and","df.visible","=","1"],["and","df.deleted","=","0"]]],["groups fg","on",["df.fieldtype","=","fg.id"]],["employee e","on",["fv.ref_id","=","e.id"]]],left_join:[["contact c","on",[["e.id","=","c.ref_id"],["and","c.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'employee'"]]}]]]],[[[{select:["fieldname"],from:"deffield df",inner_join:["groups fg","on",[["df.fieldtype","=","fg.id"],["and","fg.groupvalue","in",[[],"'integer'","'float'"]]]]}],"rf_number"],"on",["fv.fieldname","=","rf_number.fieldname"]],[[[{select:["fieldname"],from:"deffield df",inner_join:["groups fg","on",[["df.fieldtype","=","fg.id"],["and","fg.groupvalue","=","'date'"]]]}],"rf_date"],"on",["fv.fieldname","=","rf_date.fieldname"]],["customer rf_customer","on",["fv.value","=","{CAS_TEXT}rf_customer.id {CAE_TEXT}"]],["tool rf_tool","on",["fv.value","=","{CAS_TEXT}rf_tool.id {CAE_TEXT}"]],["trans rf_trans","on",["fv.value","=","{CAS_TEXT}rf_trans.id {CAE_TEXT}"]],["product rf_product","on",["fv.value","=","{CAS_TEXT}rf_product.id {CAE_TEXT}"]],["project rf_project","on",["fv.value","=","{CAS_TEXT}rf_project.id {CAE_TEXT}"]],["employee rf_employee","on",["fv.value","=","{CAS_TEXT}rf_employee.id {CAE_TEXT}"]],["place rf_place","on",["fv.value","=","{CAS_TEXT}rf_place.id {CAE_TEXT}"]]],where:[["fv.deleted","=","0"],["and","e.deleted","=","0"]]}},EmployeeEvents:{columns:{empnumber:!0,fromdate:!0,subject:!0},label:t("event_view"),edit:"event",fields:{empnumber:{fieldtype:"string",wheretype:"where",orderby:0,label:t("employee_empnumber"),sqlstr:"em.empnumber "},firstname:{fieldtype:"string",wheretype:"where",orderby:1,label:t("contact_firstname"),sqlstr:"c.firstname "},surname:{fieldtype:"string",wheretype:"where",orderby:2,label:t("contact_surname"),sqlstr:"c.surname "},username:{fieldtype:"string",wheretype:"where",orderby:3,label:t("employee_username"),sqlstr:"em.username "},calnumber:{fieldtype:"string",wheretype:"where",orderby:4,label:t("event_calnumber"),sqlstr:"e.calnumber"},eventgroup:{fieldtype:"string",wheretype:"where",orderby:5,label:t("event_group"),sqlstr:"eg.groupvalue"},fromdate:{fieldtype:"date",wheretype:"where",orderby:6,label:t("event_fromdate"),sqlstr:"{FMS_DATE}e.fromdate {FME_DATE}"},fromtime:{fieldtype:"string",wheretype:"where",orderby:7,label:t("event_fromtime"),sqlstr:"{FMS_TIME}e.fromdate {FME_TIME}"},todate:{fieldtype:"date",wheretype:"where",orderby:8,label:t("event_todate"),sqlstr:"{FMS_DATE}e.todate {FME_DATE}"},totime:{fieldtype:"string",wheretype:"where",orderby:9,label:t("event_totime"),sqlstr:"{FMS_TIME}e.todate {FME_TIME}"},subject:{fieldtype:"string",wheretype:"where",orderby:10,label:t("event_subject"),sqlstr:"e.subject"},place:{fieldtype:"string",wheretype:"where",orderby:11,label:t("event_place"),sqlstr:"e.place"},description:{fieldtype:"string",wheretype:"where",orderby:12,label:t("event_description"),sqlstr:"e.description"}},sql:{select:["{CCS}'event'{SEP}'//'{SEP} {CAS_TEXT}e.id {CAE_TEXT}{CCE} as id","e.id as row_id","em.empnumber","c.firstname","c.surname","em.username","e.calnumber","eg.groupvalue as eventgroup","{FMS_DATE}e.fromdate {FME_DATE} as fromdate","{FMS_TIME}e.fromdate {FME_TIME} as fromtime","{FMS_DATE}e.todate {FME_DATE} as todate","{FMS_TIME}e.todate {FME_TIME} as totime","e.subject","e.place","e.description"],from:"event e",inner_join:["employee em","on",["e.ref_id","=","em.id"]],left_join:[["contact c","on",[["em.id","=","c.ref_id"],["and","c.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'employee'"]]}]]]],["groups eg","on",["e.eventgroup","=","eg.id"]]],where:[["e.deleted","=","0"],["and","em.deleted","=","0"],["and","e.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'employee'"]]}]]]}}}},product:function(){return{options:{deffield_sql:{select:["df.id","df.fieldname","g.groupvalue as fieldtype","df.description"],from:"deffield df",inner_join:["groups g","on",["g.id","=","df.fieldtype"]],where:[["df.deleted","=","0"],["and","df.visible","=","1"],["and","df.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'product'"]]}]]]}},ProductView:{columns:{partnumber:!0,protype:!0,description:!0},label:t("product_view"),fields:{partnumber:{fieldtype:"string",wheretype:"where",orderby:0,label:t("product_partnumber"),sqlstr:"p.partnumber "},protype:{fieldtype:"string",wheretype:"where",orderby:1,label:t("product_protype"),sqlstr:"case when ms.msg is null then g.groupvalue else ms.msg end "},description:{fieldtype:"string",wheretype:"where",orderby:2,label:t("product_description"),sqlstr:"p.description "},unit:{fieldtype:"string",wheretype:"where",orderby:3,label:t("product_unit"),sqlstr:"p.unit "},tax:{fieldtype:"string",wheretype:"where",orderby:4,label:t("product_tax"),sqlstr:"t.taxcode "},webitem:{fieldtype:"bool",wheretype:"where",orderby:5,label:t("product_webitem"),sqlstr:"p.webitem  "},inactive:{fieldtype:"bool",wheretype:"where",orderby:6,label:t("product_inactive"),sqlstr:"p.inactive  "},notes:{fieldtype:"string",wheretype:"where",orderby:7,label:t("product_notes"),sqlstr:"p.notes "}},sql:{select:["{CCS}'product'{SEP}'//'{SEP} {CAS_TEXT}p.id {CAE_TEXT}{CCE} as id","p.id as row_id","p.partnumber","case when ms.msg is null then g.groupvalue else ms.msg end as protype","p.description","p.unit","t.taxcode as tax","p.notes","p.webitem as webitem","p.inactive"],from:"product p",inner_join:[["groups g","on",["p.protype","=","g.id"]],["tax t","on",["p.tax_id","=","t.id"]]],left_join:["ui_message ms","on",[["ms.fieldname","=","g.groupvalue"],["and","ms.secname","=","'protype'"],["and","ms.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]],where:[["p.deleted","=","0"]]}},ProductFieldsView:{columns:{custname:!0,fielddef:!0,deffield_value:!0},label:t("fields_view"),fields:{partnumber:{fieldtype:"string",wheretype:"where",orderby:0,label:t("product_partnumber"),sqlstr:"p.partnumber"},description:{fieldtype:"string",wheretype:"where",orderby:1,label:t("product_description"),sqlstr:"p.description "},fielddef:{fieldtype:"string",wheretype:"where",orderby:2,label:t("fields_fielddef"),sqlstr:"df.description "},deffield_value:{fieldtype:"string",wheretype:"where",orderby:3,label:t("fields_value"),sqlstr:"fv.value "},notes:{fieldtype:"string",wheretype:"where",orderby:4,label:t("fields_notes"),sqlstr:"fv.notes "}},sql:{select:["{CCS}'product'{SEP}'//'{SEP} {CAS_TEXT}p.id {CAE_TEXT}{CCE} as id","fv.id as row_id","p.partnumber","p.description","df.description as fielddef","'fieldvalue' as form","fg.groupvalue as fieldtype","case when fg.groupvalue in ('bool') then fv.value when fg.groupvalue in ('integer') then {CCS}{FMS_INT}fv.value{FME_INT}{CCE} when fg.groupvalue in ('float') then {CCS}{FMS_FLOAT}fv.value{FME_FLOAT}{CCE} when fg.groupvalue in ('customer') then {CCS}'customer//'{SEP} {CAS_TEXT}rf_customer.id {CAE_TEXT}{CCE} when fg.groupvalue in ('tool') then {CCS}'tool//'{SEP} {CAS_TEXT}rf_tool.id {CAE_TEXT}{CCE} when fg.groupvalue in ('product') then {CCS}'product//'{SEP} {CAS_TEXT}rf_product.id {CAE_TEXT}{CCE} when fg.groupvalue in ('trans', 'transitem', 'transmovement', 'transpayment') then {CCS}'trans//'{SEP} {CAS_TEXT}rf_trans.id {CAE_TEXT}{CCE} when fg.groupvalue in ('project') then {CCS}'project//'{SEP} {CAS_TEXT}rf_project.id {CAE_TEXT}{CCE} when fg.groupvalue in ('employee') then {CCS}'employee//'{SEP} {CAS_TEXT}rf_employee.id {CAE_TEXT}{CCE} when fg.groupvalue in ('place') then {CCS}'place//'{SEP} {CAS_TEXT}rf_place.id {CAE_TEXT}{CCE} when fg.groupvalue in ('urlink') then {CCS}'url/'{SEP}fv.value{CCE} when fg.groupvalue in ('password') then '**********' when fg.groupvalue in ('notes', 'string', 'valuelist','date','time') then fv.value else null end as deffield_value, case when fg.groupvalue in ('bool','float','integer','date','time','urlink','notes', 'string', 'valuelist') then fv.value when fg.groupvalue in ('customer') then rf_customer.custname when fg.groupvalue in ('tool') then rf_tool.serial when fg.groupvalue in ('product') then rf_product.partnumber when fg.groupvalue in ('trans', 'transitem', 'transmovement', 'transpayment') then rf_trans.transnumber when fg.groupvalue in ('project') then rf_project.pronumber when fg.groupvalue in ('employee') then rf_employee.empnumber when fg.groupvalue in ('place') then rf_place.planumber when fg.groupvalue in ('password') then '**********' else null end as export_deffield_value, fv.notes"],from:"fieldvalue fv",inner_join:[["deffield df","on",[["fv.fieldname","=","df.fieldname"],["and","df.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'product'"]]}]],["and","df.visible","=","1"],["and","df.deleted","=","0"]]],["groups fg","on",["df.fieldtype","=","fg.id"]],["product p","on",["fv.ref_id","=","p.id"]]],left_join:[[[[{select:["fieldname"],from:"deffield df",inner_join:["groups fg","on",[["df.fieldtype","=","fg.id"],["and","fg.groupvalue","in",[[],"'integer'","'float'"]]]]}],"rf_number"],"on",["fv.fieldname","=","rf_number.fieldname"]],[[[{select:["fieldname"],from:"deffield df",inner_join:["groups fg","on",[["df.fieldtype","=","fg.id"],["and","fg.groupvalue","=","'date'"]]]}],"rf_date"],"on",["fv.fieldname","=","rf_date.fieldname"]],["customer rf_customer","on",["fv.value","=","{CAS_TEXT}rf_customer.id {CAE_TEXT}"]],["tool rf_tool","on",["fv.value","=","{CAS_TEXT}rf_tool.id {CAE_TEXT}"]],["trans rf_trans","on",["fv.value","=","{CAS_TEXT}rf_trans.id {CAE_TEXT}"]],["product rf_product","on",["fv.value","=","{CAS_TEXT}rf_product.id {CAE_TEXT}"]],["project rf_project","on",["fv.value","=","{CAS_TEXT}rf_project.id {CAE_TEXT}"]],["employee rf_employee","on",["fv.value","=","{CAS_TEXT}rf_employee.id {CAE_TEXT}"]],["place rf_place","on",["fv.value","=","{CAS_TEXT}rf_place.id {CAE_TEXT}"]]],where:[["fv.deleted","=","0"],["and","p.deleted","=","0"]]}},ProductBarcodeView:{columns:{partnumber:!0,description:!0,barcode:!0},label:t("barcode_view"),fields:{partnumber:{fieldtype:"string",wheretype:"where",orderby:0,label:t("product_partnumber"),sqlstr:"p.partnumber "},partname:{fieldtype:"string",wheretype:"where",orderby:1,label:t("product_description"),sqlstr:"p.description "},unit:{fieldtype:"string",wheretype:"where",orderby:2,label:t("product_unit"),sqlstr:"p.unit "},description:{fieldtype:"string",wheretype:"where",orderby:3,label:t("barcode_description"),sqlstr:"b.description "},barcodetype:{fieldtype:"string",wheretype:"where",orderby:4,label:t("barcode_barcodetype"),sqlstr:"g.description "},qty:{fieldtype:"float",wheretype:"where",orderby:5,label:t("barcode_qty"),sqlstr:"b.qty "},defcode:{fieldtype:"bool",wheretype:"where",orderby:6,label:t("barcode_defcode"),sqlstr:"b.defcode "},barcode:{fieldtype:"string",wheretype:"where",orderby:7,label:t("barcode_code"),sqlstr:"b.id "}},sql:{select:["{CCS}'product'{SEP}'//'{SEP} {CAS_TEXT}p.id {CAE_TEXT}{CCE} as id","b.id as row_id","p.partnumber","p.description as partname","p.unit","b.code as barcode","b.description","g.description as barcodetype","{FMS_FLOAT}b.qty{FME_FLOAT} as qty","b.qty as export_qty","b.defcode as defcode","'barcode' as form","b.id as form_id"],from:"barcode b",inner_join:[["product p","on",["b.product_id","=","p.id"]],["groups g","on",["b.barcodetype","=","g.id"]]],where:[["p.deleted","=","0"]]}},ProductPriceView:{columns:{partnumber:!0,validfrom:!0,curr:!0,pricevalue:!0},label:t("price_view"),fields:{partnumber:{fieldtype:"string",wheretype:"where",orderby:0,label:t("product_partnumber"),sqlstr:"p.partnumber "},description:{fieldtype:"string",wheretype:"where",orderby:1,label:t("product_description"),sqlstr:"p.description "},unit:{fieldtype:"string",wheretype:"where",orderby:2,label:t("product_unit"),sqlstr:"p.unit "},vendor:{fieldtype:"bool",wheretype:"where",orderby:3,label:t("price_vendor"),sqlstr:"pr.vendorprice "},custname:{fieldtype:"string",wheretype:"where",orderby:4,label:t("price_custname"),sqlstr:"c.custname "},validfrom:{fieldtype:"date",wheretype:"where",orderby:5,label:t("price_validfrom"),sqlstr:"pr.validfrom "},validto:{fieldtype:"date",wheretype:"where",orderby:6,label:t("price_validto"),sqlstr:"pr.validto "},curr:{fieldtype:"string",wheretype:"where",orderby:7,label:t("price_curr"),sqlstr:"pr.curr "},qty:{fieldtype:"float",wheretype:"where",orderby:8,label:t("price_qty"),sqlstr:"pr.qty "},pricevalue:{fieldtype:"float",wheretype:"where",orderby:9,label:t("price_pricevalue"),sqlstr:"pr.pricevalue "}},sql:{select:["{CCS}'product'{SEP}'//'{SEP} {CAS_TEXT}p.id {CAE_TEXT}{CCE} as id","pr.id as row_id","p.partnumber","p.description","p.unit","pr.vendorprice as vendor","c.custname","{FMS_DATE}pr.validfrom {FME_DATE} as validfrom","{FMS_DATE}pr.validto {FME_DATE} as validto","pr.curr","{FMS_FLOAT}pr.qty{FME_FLOAT} as qty","pr.qty as export_qty","pr.pricevalue","'price' as form","pr.id as form_id"],from:"price pr",inner_join:["product p","on",["pr.product_id","=","p.id"]],left_join:[["link ln0","on",[["ln0.nervatype_1","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'price'"]]}]],["and","ln0.ref_id_1","=","pr.id"],["and","ln0.deleted","=","0"],["and","ln0.nervatype_2","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'customer'"]]}]]]],["customer c","on",[["ln0.ref_id_2","=","c.id"],["and","c.deleted","=","0"]]]],where:[["p.deleted","=","0"],["and","pr.deleted","=","0"],["and","pr.discount","is null"]]}},ProductEvents:{columns:{partname:!0,fromdate:!0,subject:!0},label:t("event_view"),edit:"event",fields:{partnumber:{fieldtype:"string",wheretype:"where",orderby:0,label:t("product_partnumber"),sqlstr:"p.partnumber "},partname:{fieldtype:"string",wheretype:"where",orderby:1,label:t("product_description"),sqlstr:"p.description "},calnumber:{fieldtype:"string",wheretype:"where",orderby:2,label:t("event_calnumber"),sqlstr:"e.calnumber"},eventgroup:{fieldtype:"string",wheretype:"where",orderby:3,label:t("event_group"),sqlstr:"eg.groupvalue"},fromdate:{fieldtype:"date",wheretype:"where",orderby:4,label:t("event_fromdate"),sqlstr:"{FMS_DATE}e.fromdate {FME_DATE}"},fromtime:{fieldtype:"string",wheretype:"where",orderby:5,label:t("event_fromtime"),sqlstr:"{FMS_TIME}e.fromdate {FME_TIME}"},todate:{fieldtype:"date",wheretype:"where",orderby:6,label:t("event_todate"),sqlstr:"{FMS_DATE}e.todate {FME_DATE}"},totime:{fieldtype:"string",wheretype:"where",orderby:7,label:t("event_totime"),sqlstr:"{FMS_TIME}e.todate {FME_TIME}"},subject:{fieldtype:"string",wheretype:"where",orderby:8,label:t("event_subject"),sqlstr:"e.subject"},place:{fieldtype:"string",wheretype:"where",orderby:9,label:t("event_place"),sqlstr:"e.place"},description:{fieldtype:"string",wheretype:"where",orderby:10,label:t("event_description"),sqlstr:"e.description"}},sql:{select:["{CCS}'event'{SEP}'//'{SEP} {CAS_TEXT}e.id {CAE_TEXT}{CCE} as id","e.id as row_id","p.partnumber","p.description as partname","e.calnumber","eg.groupvalue as eventgroup","{FMS_DATE}e.fromdate {FME_DATE} as fromdate","{FMS_TIME}e.fromdate {FME_TIME} as fromtime","{FMS_DATE}e.todate {FME_DATE} as todate","{FMS_TIME}e.todate {FME_TIME} as totime","e.subject","e.place","e.description"],from:"event e",inner_join:["product p","on",["e.ref_id","=","p.id"]],left_join:["groups eg","on",["e.eventgroup","=","eg.id"]],where:[["e.deleted","=","0"],["and","p.deleted","=","0"],["and","e.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'product'"]]}]]]}}}},project:function(){return{options:{deffield_sql:{select:["df.id","df.fieldname","g.groupvalue as fieldtype","df.description"],from:"deffield df",inner_join:["groups g","on",["g.id","=","df.fieldtype"]],where:[["df.deleted","=","0"],["and","df.visible","=","1"],["and","df.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'project'"]]}]]]}},ProjectView:{columns:{pronumber:!0,description:!0,startdate:!0},label:t("project_view"),fields:{pronumber:{fieldtype:"string",wheretype:"where",orderby:0,label:t("project_pronumber"),sqlstr:"p.pronumber "},description:{fieldtype:"string",wheretype:"where",orderby:1,label:t("project_description"),sqlstr:"p.description "},customer:{fieldtype:"string",wheretype:"where",orderby:2,label:t("project_customer"),sqlstr:"c.custname "},startdate:{fieldtype:"date",wheretype:"where",orderby:3,label:t("project_startdate"),sqlstr:"cast(p.startdate as date) "},enddate:{fieldtype:"date",wheretype:"where",orderby:4,label:t("project_enddate"),sqlstr:"cast(p.enddate as date) "},inactive:{fieldtype:"bool",wheretype:"where",orderby:5,label:t("project_inactive"),sqlstr:"p.inactive"},notes:{fieldtype:"string",wheretype:"where",orderby:6,label:t("project_notes"),sqlstr:"p.notes "}},sql:{select:["{CCS}'project'{SEP}'//'{SEP} {CAS_TEXT}p.id {CAE_TEXT}{CCE} as id","p.id as row_id","p.pronumber","p.description","c.custname as export_customer","{CCS}'customer//'{SEP} {CAS_TEXT}c.id {CAE_TEXT}{CCE} as customer","{FMS_DATE}p.startdate {FME_DATE} as startdate","{FMS_DATE}p.enddate {FME_DATE} as enddate","p.inactive","p.notes"],from:"project p",left_join:["customer c","on",["p.customer_id","=","c.id"]],where:[["p.deleted","=","0"]]}},ProjectFieldsView:{columns:{pronumber:!0,fielddef:!0,deffield_value:!0},label:t("fields_view"),fields:{pronumber:{fieldtype:"string",wheretype:"where",orderby:0,label:t("project_pronumber"),sqlstr:"p.pronumber"},description:{fieldtype:"string",wheretype:"where",orderby:1,label:t("project_description"),sqlstr:"p.description "},fielddef:{fieldtype:"string",wheretype:"where",orderby:2,label:t("fields_fielddef"),sqlstr:"df.description "},deffield_value:{fieldtype:"string",wheretype:"where",orderby:3,label:t("fields_value"),sqlstr:"fv.value "},notes:{fieldtype:"string",wheretype:"where",orderby:4,label:t("fields_notes"),sqlstr:"fv.notes "}},sql:{select:["{CCS}'project'{SEP}'//'{SEP} {CAS_TEXT}p.id {CAE_TEXT}{CCE} as id","fv.id as row_id","p.pronumber","p.description","fv.fieldname","df.description as fielddef","'fieldvalue' as form","fg.groupvalue as fieldtype","case when fg.groupvalue in ('bool') then fv.value when fg.groupvalue in ('integer') then {CCS}{FMS_INT}fv.value{FME_INT}{CCE} when fg.groupvalue in ('float') then {CCS}{FMS_FLOAT}fv.value{FME_FLOAT}{CCE} when fg.groupvalue in ('customer') then {CCS}'customer//'{SEP} {CAS_TEXT}rf_customer.id {CAE_TEXT}{CCE} when fg.groupvalue in ('tool') then {CCS}'tool//'{SEP} {CAS_TEXT}rf_tool.id {CAE_TEXT}{CCE} when fg.groupvalue in ('product') then {CCS}'product//'{SEP} {CAS_TEXT}rf_product.id {CAE_TEXT}{CCE} when fg.groupvalue in ('trans', 'transitem', 'transmovement', 'transpayment') then {CCS}'trans//'{SEP} {CAS_TEXT}rf_trans.id {CAE_TEXT}{CCE} when fg.groupvalue in ('project') then {CCS}'project//'{SEP} {CAS_TEXT}rf_project.id {CAE_TEXT}{CCE} when fg.groupvalue in ('employee') then {CCS}'employee//'{SEP} {CAS_TEXT}rf_employee.id {CAE_TEXT}{CCE} when fg.groupvalue in ('place') then {CCS}'place//'{SEP} {CAS_TEXT}rf_place.id {CAE_TEXT}{CCE} when fg.groupvalue in ('urlink') then {CCS}'url/'{SEP}fv.value{CCE} when fg.groupvalue in ('password') then '**********' when fg.groupvalue in ('notes', 'string', 'valuelist','date','time') then fv.value else null end as deffield_value, case when fg.groupvalue in ('bool','float','integer','date','time','urlink','notes', 'string', 'valuelist') then fv.value when fg.groupvalue in ('customer') then rf_customer.custname when fg.groupvalue in ('tool') then rf_tool.serial when fg.groupvalue in ('product') then rf_product.partnumber when fg.groupvalue in ('trans', 'transitem', 'transmovement', 'transpayment') then rf_trans.transnumber when fg.groupvalue in ('project') then rf_project.pronumber when fg.groupvalue in ('employee') then rf_employee.empnumber when fg.groupvalue in ('place') then rf_place.planumber when fg.groupvalue in ('password') then '**********' else null end as export_deffield_value, fv.notes"],from:"fieldvalue fv",inner_join:[["deffield df","on",[["fv.fieldname","=","df.fieldname"],["and","df.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'project'"]]}]],["and","df.visible","=","1"],["and","df.deleted","=","0"]]],["groups fg","on",["df.fieldtype","=","fg.id"]],["project p","on",["fv.ref_id","=","p.id"]]],left_join:[[[[{select:["fieldname"],from:"deffield df",inner_join:["groups fg","on",[["df.fieldtype","=","fg.id"],["and","fg.groupvalue","in",[[],"'integer'","'float'"]]]]}],"rf_number"],"on",["fv.fieldname","=","rf_number.fieldname"]],[[[{select:["fieldname"],from:"deffield df",inner_join:["groups fg","on",[["df.fieldtype","=","fg.id"],["and","fg.groupvalue","=","'date'"]]]}],"rf_date"],"on",["fv.fieldname","=","rf_date.fieldname"]],["customer rf_customer","on",["fv.value","=","{CAS_TEXT}rf_customer.id {CAE_TEXT}"]],["tool rf_tool","on",["fv.value","=","{CAS_TEXT}rf_tool.id {CAE_TEXT}"]],["trans rf_trans","on",["fv.value","=","{CAS_TEXT}rf_trans.id {CAE_TEXT}"]],["product rf_product","on",["fv.value","=","{CAS_TEXT}rf_product.id {CAE_TEXT}"]],["project rf_project","on",["fv.value","=","{CAS_TEXT}rf_project.id {CAE_TEXT}"]],["employee rf_employee","on",["fv.value","=","{CAS_TEXT}rf_employee.id {CAE_TEXT}"]],["place rf_place","on",["fv.value","=","{CAS_TEXT}rf_place.id {CAE_TEXT}"]]],where:[["fv.deleted","=","0"],["and","p.deleted","=","0"]]}},ProjectContactView:{columns:{pronumber:!0,firstname:!0,surname:!0,phone:!0},label:t("contact_view"),fields:{pronumber:{fieldtype:"string",wheretype:"where",orderby:0,label:t("project_pronumber"),sqlstr:"p.pronumber "},description:{fieldtype:"string",wheretype:"where",orderby:1,label:t("project_description"),sqlstr:"p.description "},firstname:{fieldtype:"string",wheretype:"where",orderby:2,label:t("contact_firstname"),sqlstr:"co.firstname"},surname:{fieldtype:"string",wheretype:"where",orderby:3,label:t("contact_surname"),sqlstr:" co.surname"},status:{fieldtype:"string",wheretype:"where",orderby:4,label:t("contact_status"),sqlstr:" co.status"},phone:{fieldtype:"string",wheretype:"where",orderby:5,label:t("contact_phone"),sqlstr:" co.phone"},fax:{fieldtype:"string",wheretype:"where",orderby:6,label:t("contact_fax"),sqlstr:" co.fax"},mobil:{fieldtype:"string",wheretype:"where",orderby:7,label:t("contact_mobil"),sqlstr:" co.mobil"},email:{fieldtype:"string",wheretype:"where",orderby:8,label:t("contact_email"),sqlstr:" co.email"},notes:{fieldtype:"string",wheretype:"where",orderby:9,label:t("contact_notes"),sqlstr:" co.notes"}},sql:{select:["{CCS}'project'{SEP}'//'{SEP} {CAS_TEXT}p.id {CAE_TEXT}{CCE} as id","co.id as row_id","p.pronumber","p.description","co.firstname","co.surname","co.status","co.phone","co.fax","co.mobil","co.email","co.notes"],from:"contact co",inner_join:["project p","on",["co.ref_id","=","p.id"]],where:[["co.deleted","=","0"],["and","p.deleted","=","0"],["and","co.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'project'"]]}]]]}},ProjectAddressView:{columns:{pronumber:!0,city:!0,street:!0},label:t("address_view"),fields:{pronumber:{fieldtype:"string",wheretype:"where",orderby:0,label:t("project_pronumber"),sqlstr:"p.pronumber "},description:{fieldtype:"string",wheretype:"where",orderby:1,label:t("project_description"),sqlstr:"p.description "},country:{fieldtype:"string",wheretype:"where",orderby:2,label:t("address_country"),sqlstr:"a.country"},state:{fieldtype:"string",wheretype:"where",orderby:3,label:t("address_state"),sqlstr:"a.state"},zipcode:{fieldtype:"string",wheretype:"where",orderby:4,label:t("address_zipcode"),sqlstr:"a.zipcode "},city:{fieldtype:"string",wheretype:"where",orderby:5,label:t("address_city"),sqlstr:"a.city"},street:{fieldtype:"string",wheretype:"where",orderby:6,label:t("address_street"),sqlstr:"a.street"},notes:{fieldtype:"string",wheretype:"where",orderby:7,label:t("address_notes"),sqlstr:"a.notes"}},sql:{select:["{CCS}'project'{SEP}'//'{SEP} {CAS_TEXT}p.id {CAE_TEXT}{CCE} as id","a.id as row_id","p.pronumber","p.description","a.country","a.state","a.zipcode","a.city","a.street","a.notes"],from:"address a",inner_join:["project p","on",["a.ref_id","=","p.id"]],where:[["a.deleted","=","0"],["and","p.deleted","=","0"],["and","a.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'project'"]]}]]]}},ProjectEvents:{columns:{pronumber:!0,fromdate:!0,subject:!0},label:t("event_view"),edit:"event",fields:{pronumber:{fieldtype:"string",wheretype:"where",orderby:0,label:t("project_pronumber"),sqlstr:"p.pronumber "},pdescription:{fieldtype:"string",wheretype:"where",orderby:1,label:t("project_description"),sqlstr:"p.description "},calnumber:{fieldtype:"string",wheretype:"where",orderby:2,label:t("event_calnumber"),sqlstr:"e.calnumber"},eventgroup:{fieldtype:"string",wheretype:"where",orderby:3,label:t("event_group"),sqlstr:"eg.groupvalue"},fromdate:{fieldtype:"date",wheretype:"where",orderby:4,label:t("event_fromdate"),sqlstr:"{FMS_DATE}e.fromdate {FME_DATE}"},fromtime:{fieldtype:"string",wheretype:"where",orderby:5,label:t("event_fromtime"),sqlstr:"{FMS_TIME}e.fromdate {FME_TIME}"},todate:{fieldtype:"date",wheretype:"where",orderby:6,label:t("event_todate"),sqlstr:"{FMS_DATE}e.todate {FME_DATE}"},totime:{fieldtype:"string",wheretype:"where",orderby:7,label:t("event_totime"),sqlstr:"{FMS_TIME}e.todate {FME_TIME}"},subject:{fieldtype:"string",wheretype:"where",orderby:8,label:t("event_subject"),sqlstr:"e.subject"},place:{fieldtype:"string",wheretype:"where",orderby:9,label:t("event_place"),sqlstr:"e.place"},description:{fieldtype:"string",wheretype:"where",orderby:10,label:t("event_description"),sqlstr:"e.description"}},sql:{select:["{CCS}'event'{SEP}'//'{SEP} {CAS_TEXT}e.id {CAE_TEXT}{CCE} as id","e.id as row_id","p.pronumber","p.description as pdescription","e.calnumber","eg.groupvalue as eventgroup","{FMS_DATE}e.fromdate {FME_DATE} as fromdate","{FMS_TIME}e.fromdate {FME_TIME} as fromtime","{FMS_DATE}e.todate {FME_DATE} as todate","{FMS_TIME}e.todate {FME_TIME} as totime","e.subject","e.place","e.description"],from:"event e",inner_join:["project p","on",["e.ref_id","=","p.id"]],left_join:["groups eg","on",["e.eventgroup","=","eg.id"]],where:[["e.deleted","=","0"],["and","p.deleted","=","0"],["and","e.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'project'"]]}]]]}},ProjectTrans:{columns:{pronumber:!0,transtype:!0,transnumber:!0,transdate:!0},label:t("document_view"),fields:{pronumber:{fieldtype:"string",wheretype:"where",orderby:0,label:t("project_pronumber"),sqlstr:"p.pronumber "},description:{fieldtype:"string",wheretype:"where",orderby:1,label:t("project_description"),sqlstr:"p.description "},transtype:{fieldtype:"string",wheretype:"where",orderby:2,label:t("document_transtype"),sqlstr:"case when mst.msg is null then tg.groupvalue else mst.msg end "},direction:{fieldtype:"string",wheretype:"where",orderby:3,label:t("document_direction"),sqlstr:"case when msd.msg is null then dg.groupvalue else msd.msg end "},transnumber:{fieldtype:"string",wheretype:"where",orderby:4,label:t("document_transnumber"),sqlstr:"t.transnumber "},transdate:{fieldtype:"date",wheretype:"where",orderby:5,label:t("document_transdate2"),sqlstr:"t.transdate "},curr:{fieldtype:"string",wheretype:"where",orderby:6,label:t("document_curr"),sqlstr:"t.curr "},amount:{fieldtype:"float",wheretype:"having",orderby:7,label:t("item_amount"),sqlstr:"sum(i.amount) "},custname:{fieldtype:"string",wheretype:"where",orderby:8,label:t("customer_custnumber"),sqlstr:"c.custname "}},sql:{select:["{CCS}'project'{SEP}'//'{SEP} {CAS_TEXT}p.id {CAE_TEXT}{CCE} as id","t.id as row_id","p.pronumber","p.description","case when mst.msg is null then tg.groupvalue else mst.msg end as transtype","case when msd.msg is null then dg.groupvalue else msd.msg end as direction","t.transnumber as export_transnumber","t.transdate","t.curr","{FMS_FLOAT}sum(i.amount){FME_FLOAT} as amount","sum(i.amount) as export_amount","c.custname","{CCS}'trans/'{SEP}tg.groupvalue{SEP}'/'{SEP} {CAS_TEXT}t.id {CAE_TEXT}{CCE} as transnumber"],from:"project p",inner_join:[["trans t","on",["p.id","=","t.project_id"]],["groups tg","on",["t.transtype","=","tg.id"]],["groups dg","on",["t.direction","=","dg.id"]],["item i","on",[["t.id","=","i.trans_id"],["and","i.deleted","=","0"]]]],left_join:[["ui_message mst","on",[["mst.fieldname","=","tg.groupvalue"],["and","mst.secname","=","'transtype'"],["and","mst.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]],["ui_message msd","on",[["msd.fieldname","=","dg.groupvalue"],["and","msd.secname","=","'direction'"],["and","msd.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]],["customer c","on",["t.customer_id","=","c.id"]]],where:[["p.deleted","=","0"],["and",[["t.deleted","=","0"],["or",[["tg.groupvalue","=","'invoice'"],["and","dg.groupvalue","=","'out'"]]],["or",[["tg.groupvalue","=","'receipt'"],["and","dg.groupvalue","=","'out'"]]]]]],group_by:["p.id","p.pronumber","p.description","tg.groupvalue","dg.groupvalue","mst.msg, msd.msg","t.id","t.transnumber","t.transdate","c.custname","t.curr"],having:[["sum(i.amount)","<>","0"]]}}}},rate:function(){return{options:{deffield_sql:{select:["df.id","df.fieldname","g.groupvalue as fieldtype","df.description"],from:"deffield df",inner_join:["groups g","on",["g.id","=","df.fieldtype"]],where:[["df.deleted","=","0"],["and","df.visible","=","1"],["and","df.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'rate'"]]}]]]}},RateView:{columns:{ratetype:!0,ratedate:!0,curr:!0,ratevalue:!0},label:t("rate_view"),actions_new:{action:"loadEditor",ntype:"rate",ttype:null},fields:{ratetype:{fieldtype:"string",wheretype:"where",orderby:0,label:t("rate_ratetype"),sqlstr:"rtype.groupvalue "},ratedate:{fieldtype:"date",wheretype:"where",orderby:1,label:t("rate_ratedate"),sqlstr:"r.ratedate "},curr:{fieldtype:"string",wheretype:"where",orderby:2,label:t("rate_curr"),sqlstr:"r.curr "},ratevalue:{fieldtype:"float",wheretype:"where",orderby:3,label:t("rate_ratevalue"),sqlstr:"r.ratevalue "},rategroup:{fieldtype:"string",wheretype:"where",orderby:4,label:t("rate_rategroup"),sqlstr:"rgroup.groupvalue "},planumber:{fieldtype:"string",wheretype:"where",orderby:5,label:t("rate_planumber"),sqlstr:"p.planumber"}},sql:{select:["{CCS}'rate'{SEP}'//'{SEP} {CAS_TEXT}r.id {CAE_TEXT}{CCE} as id","r.id as row_id","rtype.groupvalue as ratetype","{FMS_DATE}r.ratedate {FME_DATE} as ratedate","r.curr","{FMS_FLOAT}r.ratevalue{FME_FLOAT} as ratevalue","r.ratevalue as export_ratevalue","rgroup.groupvalue as rategroup","p.planumber as export_planumber","{CCS}'place//'{SEP} {CAS_TEXT}p.id {CAE_TEXT}{CCE} as planumber"],from:"rate r",inner_join:["groups as rtype","on",["r.ratetype","=","rtype.id"]],left_join:[["groups as rgroup","on",["r.rategroup","=","rgroup.id"]],["place p","on",["r.place_id","=","p.id"]]],where:[["r.deleted","=","0"]]}}}},tool:function(){return{options:{deffield_sql:{select:["df.id","df.fieldname","g.groupvalue as fieldtype","df.description"],from:"deffield df",inner_join:["groups g","on",["g.id","=","df.fieldtype"]],where:[["df.deleted","=","0"],["and","df.visible","=","1"],["and","df.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'tool'"]]}]]]}},ToolView:{columns:{serial:!0,description:!0,product:!0},label:t("tool_view"),fields:{serial:{fieldtype:"string",wheretype:"where",orderby:0,label:t("tool_serial"),sqlstr:"t.serial "},description:{fieldtype:"string",wheretype:"where",orderby:1,label:t("tool_description"),sqlstr:"t.description "},product:{fieldtype:"string",wheretype:"where",orderby:2,label:t("tool_product"),sqlstr:"p.description "},toolgroup:{fieldtype:"string",wheretype:"where",orderby:3,label:t("tool_toolgroup"),sqlstr:"tg.groupvalue "},inactive:{fieldtype:"bool",wheretype:"where",orderby:5,label:t("tool_inactive"),sqlstr:"t.inactive"},notes:{fieldtype:"string",wheretype:"where",orderby:6,label:t("tool_notes"),sqlstr:"t.notes "}},sql:{select:["{CCS}'tool'{SEP}'//'{SEP} {CAS_TEXT}t.id {CAE_TEXT}{CCE} as id","t.id as row_id","t.serial","t.description","p.description as export_product","{CCS}'product//'{SEP} {CAS_TEXT}p.id {CAE_TEXT}{CCE} as product","tg.groupvalue as toolgroup","t.inactive","t.notes"],from:"tool t",inner_join:["product p","on",["t.product_id","=","p.id"]],left_join:[["groups tg","on",["t.toolgroup","=","tg.id"]],[[[{select:["mv.tool_id"],from:["movement mv"],inner_join:["trans t","on",["mv.trans_id","=","t.id"]],left_join:[["customer c","on",["t.customer_id","=","c.id"]],["employee e","on",["t.employee_id","=","e.id"]],["link lnk","on",[["t.id","=","lnk.ref_id_1"],["and","lnk.deleted","=","0"],["and","lnk.nervatype_1","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'trans'"]]}]],["and","lnk.nervatype_2","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'trans'"]]}]]]],["trans lt","on",["lnk.ref_id_2","=","lt.id"]],["customer ltc","on",["lt.customer_id","=","ltc.id"]]],where:["mv.id","in",[{select:["max(id)"],from:"movement mv",inner_join:[[[{select:["tool_id","max(shippingdate) as ldate"],from:"movement mv",inner_join:["trans t","on",["mv.trans_id","=","t.id"]],where:[["mv.deleted","=","0"],["and","tool_id","is not","null"],["and","t.deleted","=","0"],["and","{CAS_DATE}shippingdate {CAE_DATE}","<=","{CUR_DATE}"]],group_by:["tool_id"]}],"lst_date"],"on",[["mv.tool_id","=","lst_date.tool_id"],["and","mv.shippingdate","=","lst_date.ldate"]]],group_by:["mv.tool_id"]}]]}],"ssel"],"on",["t.id","=","ssel.tool_id"]]],where:[["t.deleted","=","0"],["and",["t.toolgroup","not in",[{select:["id"],from:"groups",where:[["groupname","=","'toolgroup'"],["and","groupvalue","=","'printer'"]]}],["or","t.toolgroup","is null"]]]]}},ToolFieldsView:{columns:{serial:!0,fielddef:!0,deffield_value:!0},label:t("fields_view"),fields:{serial:{fieldtype:"string",wheretype:"where",orderby:0,label:t("tool_serial"),sqlstr:"t.serial"},description:{fieldtype:"string",wheretype:"where",orderby:1,label:t("tool_description"),sqlstr:"t.description "},fielddef:{fieldtype:"string",wheretype:"where",orderby:2,label:t("fields_fielddef"),sqlstr:"df.description "},deffield_value:{fieldtype:"string",wheretype:"where",orderby:3,label:t("fields_value"),sqlstr:"fv.value "},notes:{fieldtype:"string",wheretype:"where",orderby:4,label:t("fields_notes"),sqlstr:"fv.notes "}},sql:{select:["{CCS}'tool'{SEP}'//'{SEP} {CAS_TEXT}t.id {CAE_TEXT}{CCE} as id","fv.id as row_id","fv.fieldname","t.serial","t.description","df.description as fielddef","'fieldvalue' as form","fg.groupvalue as fieldtype","case when fg.groupvalue in ('bool') then fv.value when fg.groupvalue in ('integer') then {CCS}{FMS_INT}fv.value{FME_INT}{CCE} when fg.groupvalue in ('float') then {CCS}{FMS_FLOAT}fv.value{FME_FLOAT}{CCE} when fg.groupvalue in ('customer') then {CCS}'customer//'{SEP} {CAS_TEXT}rf_customer.id {CAE_TEXT}{CCE} when fg.groupvalue in ('tool') then {CCS}'tool//'{SEP} {CAS_TEXT}rf_tool.id {CAE_TEXT}{CCE} when fg.groupvalue in ('product') then {CCS}'product//'{SEP} {CAS_TEXT}rf_product.id {CAE_TEXT}{CCE} when fg.groupvalue in ('trans', 'transitem', 'transmovement', 'transpayment') then {CCS}'trans//'{SEP} {CAS_TEXT}rf_trans.id {CAE_TEXT}{CCE} when fg.groupvalue in ('project') then {CCS}'project//'{SEP} {CAS_TEXT}rf_project.id {CAE_TEXT}{CCE} when fg.groupvalue in ('employee') then {CCS}'employee//'{SEP} {CAS_TEXT}rf_employee.id {CAE_TEXT}{CCE} when fg.groupvalue in ('place') then {CCS}'place//'{SEP} {CAS_TEXT}rf_place.id {CAE_TEXT}{CCE} when fg.groupvalue in ('urlink') then {CCS}'url/'{SEP}fv.value{CCE} when fg.groupvalue in ('password') then '**********' when fg.groupvalue in ('notes', 'string', 'valuelist','date','time') then fv.value else null end as deffield_value, case when fg.groupvalue in ('bool','float','integer','date','time','urlink','notes', 'string', 'valuelist') then fv.value when fg.groupvalue in ('customer') then rf_customer.custname when fg.groupvalue in ('tool') then rf_tool.serial when fg.groupvalue in ('product') then rf_product.partnumber when fg.groupvalue in ('trans', 'transitem', 'transmovement', 'transpayment') then rf_trans.transnumber when fg.groupvalue in ('project') then rf_project.pronumber when fg.groupvalue in ('employee') then rf_employee.empnumber when fg.groupvalue in ('place') then rf_place.planumber when fg.groupvalue in ('password') then '**********' else null end as export_deffield_value, fv.notes"],from:"fieldvalue fv",inner_join:[["deffield df","on",[["fv.fieldname","=","df.fieldname"],["and","df.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'tool'"]]}]],["and","df.visible","=","1"],["and","df.deleted","=","0"]]],["groups fg","on",["df.fieldtype","=","fg.id"]],["tool t","on",["fv.ref_id","=","t.id"]]],left_join:[[[[{select:["fieldname"],from:"deffield df",inner_join:["groups fg","on",[["df.fieldtype","=","fg.id"],["and","fg.groupvalue","in",[[],"'integer'","'float'"]]]]}],"rf_number"],"on",["fv.fieldname","=","rf_number.fieldname"]],[[[{select:["fieldname"],from:"deffield df",inner_join:["groups fg","on",[["df.fieldtype","=","fg.id"],["and","fg.groupvalue","=","'date'"]]]}],"rf_date"],"on",["fv.fieldname","=","rf_date.fieldname"]],["customer rf_customer","on",["fv.value","=","{CAS_TEXT}rf_customer.id {CAE_TEXT}"]],["tool rf_tool","on",["fv.value","=","{CAS_TEXT}rf_tool.id {CAE_TEXT}"]],["trans rf_trans","on",["fv.value","=","{CAS_TEXT}rf_trans.id {CAE_TEXT}"]],["product rf_product","on",["fv.value","=","{CAS_TEXT}rf_product.id {CAE_TEXT}"]],["project rf_project","on",["fv.value","=","{CAS_TEXT}rf_project.id {CAE_TEXT}"]],["employee rf_employee","on",["fv.value","=","{CAS_TEXT}rf_employee.id {CAE_TEXT}"]],["place rf_place","on",["fv.value","=","{CAS_TEXT}rf_place.id {CAE_TEXT}"]]],where:[["fv.deleted","=","0"],["and","t.deleted","=","0"]]}},ToolEvents:{columns:{serial:!0,fromdate:!0,subject:!0},label:t("event_view"),edit:"event",fields:{serial:{fieldtype:"string",wheretype:"where",orderby:0,label:t("tool_serial"),sqlstr:"t.serial"},pdescription:{fieldtype:"string",wheretype:"where",orderby:1,label:t("tool_description"),sqlstr:"t.description "},calnumber:{fieldtype:"string",wheretype:"where",orderby:2,label:t("event_calnumber"),sqlstr:"e.calnumber"},eventgroup:{fieldtype:"string",wheretype:"where",orderby:3,label:t("event_group"),sqlstr:"eg.groupvalue"},fromdate:{fieldtype:"date",wheretype:"where",orderby:4,label:t("event_fromdate"),sqlstr:"{FMS_DATE}e.fromdate {FME_DATE}"},fromtime:{fieldtype:"string",wheretype:"where",orderby:5,label:t("event_fromtime"),sqlstr:"{FMS_TIME}e.fromdate {FME_TIME}"},todate:{fieldtype:"date",wheretype:"where",orderby:6,label:t("event_todate"),sqlstr:"{FMS_DATE}e.todate {FME_DATE}"},totime:{fieldtype:"string",wheretype:"where",orderby:7,label:t("event_totime"),sqlstr:"{FMS_TIME}e.todate {FME_TIME}"},subject:{fieldtype:"string",wheretype:"where",orderby:8,label:t("event_subject"),sqlstr:"e.subject"},place:{fieldtype:"string",wheretype:"where",orderby:9,label:t("event_place"),sqlstr:"e.place"},description:{fieldtype:"string",wheretype:"where",orderby:10,label:t("event_description"),sqlstr:"e.description"}},sql:{select:["{CCS}'event'{SEP}'//'{SEP} {CAS_TEXT}e.id {CAE_TEXT}{CCE} as id","e.id as row_id","t.serial","t.description as pdescription","e.calnumber","eg.groupvalue as eventgroup","{FMS_DATE}e.fromdate {FME_DATE} as fromdate","{FMS_TIME}e.fromdate {FME_TIME} as fromtime","{FMS_DATE}e.todate {FME_DATE} as todate","{FMS_TIME}e.todate {FME_TIME} as totime","e.subject","e.place","e.description"],from:"event e",inner_join:["tool t","on",["e.ref_id","=","t.id"]],left_join:["groups eg","on",["e.eventgroup","=","eg.id"]],where:[["e.deleted","=","0"],["and","t.deleted","=","0"],["and","e.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'tool'"]]}]]]}}}},transitem:function(){return{options:{deffield_sql:{select:["df.id","df.fieldname","g.groupvalue as fieldtype","df.description"],from:"deffield df",inner_join:["groups g","on",["g.id","=","df.fieldtype"]],where:[["df.deleted","=","0"],["and",[["df.visible","=","1"],["or","df.fieldname","in",[[],"'trans_wsdistance'","'trans_wsrepair'","'trans_wstotal'","'trans_wsnote'","'trans_reholiday'","'trans_rebadtool'","'trans_reother'","'trans_rentnote'"]]]],["and","df.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'trans'"]]}]]]}},TransItemHeadView:{columns:{transtype:!0,transnumber:!0,transdate:!0,custname:!0},label:t("document_view"),edit:"trans",fields:{transtype:{fieldtype:"string",wheretype:"where",orderby:0,label:t("document_transtype"),sqlstr:"case when mst.msg is null then tg.groupvalue else mst.msg end "},direction:{fieldtype:"string",wheretype:"where",orderby:1,label:t("document_direction"),sqlstr:"case when msd.msg is null then dg.groupvalue else msd.msg end "},transcast:{fieldtype:"string",wheretype:"where",orderby:2,label:t("document_transcast"),sqlstr:"case when msc.msg is null then fv.value else msc.msg end "},transnumber:{fieldtype:"string",wheretype:"where",orderby:3,label:t("document_transnumber"),sqlstr:"t.transnumber "},ref_transnumber:{fieldtype:"string",wheretype:"where",orderby:4,label:t("document_ref_transnumber"),sqlstr:"t.ref_transnumber "},crdate:{fieldtype:"date",wheretype:"where",orderby:5,label:t("document_crdate"),sqlstr:"t.crdate "},transdate:{fieldtype:"date",wheretype:"where",orderby:6,label:t("document_transdate"),sqlstr:"t.transdate "},duedate:{fieldtype:"date",wheretype:"where",orderby:7,label:t("document_duedate"),sqlstr:"{FMS_DATE}t.duedate {FME_DATE} "},custname:{fieldtype:"string",wheretype:"where",orderby:8,label:t("customer_custname"),sqlstr:"c.custname "},empnumber:{fieldtype:"string",wheretype:"where",orderby:9,label:t("employee_empnumber"),sqlstr:"e.empnumber "},department:{fieldtype:"string",wheretype:"where",orderby:10,label:t("document_department"),sqlstr:"deg.groupvalue "},pronumber:{fieldtype:"string",wheretype:"where",orderby:11,label:t("project_pronumber"),sqlstr:"p.pronumber "},paidtype:{fieldtype:"string",wheretype:"where",orderby:12,label:t("document_paidtype"),sqlstr:"case when msp.msg is null then ptg.groupvalue else msp.msg end "},curr:{fieldtype:"string",wheretype:"where",orderby:13,label:t("document_curr"),sqlstr:"t.curr "},netamount:{fieldtype:"float",wheretype:"where",orderby:14,label:t("item_netamount"),sqlstr:"irow.netamount "},vatamount:{fieldtype:"float",wheretype:"where",orderby:15,label:t("item_vatamount"),sqlstr:"irow.vatamount "},amount:{fieldtype:"float",wheretype:"where",orderby:16,label:t("item_amount"),sqlstr:"irow.amount "},paid:{fieldtype:"bool",wheretype:"where",orderby:17,label:t("document_paid"),sqlstr:"t.paid "},acrate:{fieldtype:"float",wheretype:"where",orderby:18,label:t("document_acrate"),sqlstr:"t.acrate "},notes:{fieldtype:"string",wheretype:"where",orderby:19,label:t("document_notes"),sqlstr:"t.notes "},intnotes:{fieldtype:"string",wheretype:"where",orderby:20,label:t("document_intnotes"),sqlstr:"t.intnotes "},transtate:{fieldtype:"string",wheretype:"where",orderby:21,label:t("document_transtate"),sqlstr:"case when mss.msg is null then sg.groupvalue else mss.msg end "},closed:{fieldtype:"bool",wheretype:"where",orderby:22,label:t("document_closed"),sqlstr:"t.closed "},deleted:{fieldtype:"bool",wheretype:"where",orderby:23,label:t("document_deleted"),sqlstr:"t.deleted "}},sql:{select:["{CCS}'trans'{SEP}'/'{SEP}tg.groupvalue{SEP}'/'{SEP} {CAS_TEXT}t.id {CAE_TEXT}{CCE} as id","t.id as row_id","case when mst.msg is null then tg.groupvalue else mst.msg end as transtype","case when msd.msg is null then dg.groupvalue else msd.msg end as direction","case when msc.msg is null then fv.value else msc.msg end as transcast","t.transnumber","t.ref_transnumber","{FMS_DATE}t.crdate {FME_DATE} as crdate","{FMS_DATE}t.transdate {FME_DATE} as transdate","{FMS_DATE}t.duedate {FME_DATE} as duedate","{CCS}'customer//'{SEP} {CAS_TEXT}c.id {CAE_TEXT}{CCE} as custname","c.custname as export_custname","{CCS}'employee//'{SEP} {CAS_TEXT}e.id {CAE_TEXT}{CCE} as empnumber","e.empnumber as export_empnumber","deg.groupvalue as department","{CCS}'project//'{SEP} {CAS_TEXT}p.id {CAE_TEXT}{CCE} as pronumber","p.pronumber as export_pronumber","case when msp.msg is null then ptg.groupvalue else msp.msg end as paidtype","t.curr","case when irow.netamount is null then '0' else {FMS_FLOAT}irow.netamount{FME_FLOAT} end as netamount","case when irow.netamount is null then 0 else irow.netamount end as export_netamount","case when irow.vatamount is null then '0' else {FMS_FLOAT}irow.vatamount{FME_FLOAT} end as vatamount","case when irow.vatamount is null then 0 else irow.vatamount end as export_vatamount","case when irow.amount is null then '0' else {FMS_FLOAT}irow.amount{FME_FLOAT} end as amount","case when irow.amount is null then 0 else irow.amount end as export_amount","t.paid","t.acrate","t.notes","t.intnotes","case when mss.msg is null then sg.groupvalue else mss.msg end as transtate","t.closed","t.deleted"],from:"trans t",inner_join:[["groups tg","on",[["t.transtype","=","tg.id"],["and","tg.groupvalue","in",[[],"'invoice'","'receipt'","'order'","'offer'","'worksheet'","'rent'"]]]],["groups dg","on",["t.direction","=","dg.id"]],["groups ptg","on",["t.paidtype","=","ptg.id"]],["groups sg","on",["t.transtate","=","sg.id"]]],left_join:[["customer c","on",["t.customer_id","=","c.id"]],["employee e","on",["t.employee_id","=","e.id"]],["groups deg","on",["t.department","=","deg.id"]],["project p","on",["t.project_id","=","p.id"]],["fieldvalue fv","on",[["t.id","=","fv.ref_id"],["and","fv.fieldname","=","'trans_transcast'"]]],["ui_message mst","on",[["mst.fieldname","=","tg.groupvalue"],["and","mst.secname","=","'transtype'"],["and","mst.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]],["ui_message msd","on",[["msd.fieldname","=","dg.groupvalue"],["and","msd.secname","=","'direction'"],["and","msd.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]],["ui_message msp","on",[["msp.fieldname","=","ptg.groupvalue"],["and","msp.secname","=","'paidtype'"],["and","msp.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]],["ui_message mss","on",[["mss.fieldname","=","sg.groupvalue"],["and","mss.secname","=","'transtate'"],["and","mss.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]],["ui_message msc","on",[["msc.fieldname","=","fv.value"],["and","msc.secname","=","'trans_transcast'"],["and","msc.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]],[[[{select:["trans_id","sum(netamount) as netamount","sum(vatamount) as vatamount","sum(amount) as amount"],from:"item",where:["deleted","=","0"],group_by:["trans_id"]}],"irow"],"on",["t.id","=","irow.trans_id"]]],where:[[[["t.deleted","=","0"],["or",[["tg.groupvalue","=","'invoice'"],["and","dg.groupvalue","=","'out'"]]],["or",[["tg.groupvalue","=","'receipt'"],["and","dg.groupvalue","=","'out'"]]]]]]}},TransItemFieldsView:{columns:{transtype:!0,transnumber:!0,fielddef:!0,deffield_value:!0},label:t("fields_view"),edit:"trans",fields:{transtype:{fieldtype:"string",wheretype:"where",orderby:0,label:t("document_transtype"),sqlstr:"case when mst.msg is null then tg.groupvalue else mst.msg end "},direction:{fieldtype:"string",wheretype:"where",orderby:1,label:t("document_direction"),sqlstr:"case when msd.msg is null then dg.groupvalue else msd.msg end "},transnumber:{fieldtype:"string",wheretype:"where",orderby:2,label:t("document_transnumber"),sqlstr:"t.transnumber "},fielddef:{fieldtype:"string",wheretype:"where",orderby:3,label:t("fields_fielddef"),sqlstr:"df.description "},deffield_value:{fieldtype:"string",wheretype:"where",orderby:4,label:t("fields_value"),sqlstr:"fv.value "},notes:{fieldtype:"string",wheretype:"where",orderby:5,label:t("fields_notes"),sqlstr:"fv.notes "}},sql:{select:["{CCS}'trans'{SEP}'/'{SEP}tg.groupvalue{SEP}'/'{SEP} {CAS_TEXT}t.id {CAE_TEXT}{CCE} as id","fv.id as row_id","'fieldvalue' as form","fv.fieldname","fg.groupvalue as fieldtype","case when mst.msg is null then tg.groupvalue else mst.msg end as transtype","case when msd.msg is null then dg.groupvalue else msd.msg end as direction","t.transnumber","df.description as fielddef","case when fg.groupvalue in ('bool') then fv.value when fg.groupvalue in ('integer') then {CCS}{FMS_INT}fv.value{FME_INT}{CCE} when fg.groupvalue in ('float') then {CCS}{FMS_FLOAT}fv.value{FME_FLOAT}{CCE} when fg.groupvalue in ('customer') then {CCS}'customer//'{SEP} {CAS_TEXT}rf_customer.id {CAE_TEXT}{CCE} when fg.groupvalue in ('tool') then {CCS}'tool//'{SEP} {CAS_TEXT}rf_tool.id {CAE_TEXT}{CCE} when fg.groupvalue in ('product') then {CCS}'product//'{SEP} {CAS_TEXT}rf_product.id {CAE_TEXT}{CCE} when fg.groupvalue in ('trans', 'transitem', 'transmovement', 'transpayment') then {CCS}'trans//'{SEP} {CAS_TEXT}rf_trans.id {CAE_TEXT}{CCE} when fg.groupvalue in ('project') then {CCS}'project//'{SEP} {CAS_TEXT}rf_project.id {CAE_TEXT}{CCE} when fg.groupvalue in ('employee') then {CCS}'employee//'{SEP} {CAS_TEXT}rf_employee.id {CAE_TEXT}{CCE} when fg.groupvalue in ('place') then {CCS}'place//'{SEP} {CAS_TEXT}rf_place.id {CAE_TEXT}{CCE} when fg.groupvalue in ('urlink') then {CCS}'url/'{SEP}fv.value{CCE} when fg.groupvalue in ('password') then '**********' when fg.groupvalue in ('notes', 'string', 'valuelist','date','time') then fv.value else null end as deffield_value, case when fg.groupvalue in ('bool','float','integer','date','time','urlink','notes', 'string', 'valuelist') then fv.value when fg.groupvalue in ('customer') then rf_customer.custname when fg.groupvalue in ('tool') then rf_tool.serial when fg.groupvalue in ('product') then rf_product.partnumber when fg.groupvalue in ('trans', 'transitem', 'transmovement', 'transpayment') then rf_trans.transnumber when fg.groupvalue in ('project') then rf_project.pronumber when fg.groupvalue in ('employee') then rf_employee.empnumber when fg.groupvalue in ('place') then rf_place.planumber when fg.groupvalue in ('password') then '**********' else null end as export_deffield_value, fv.notes"],from:"fieldvalue fv",inner_join:[["deffield df","on",[["fv.fieldname","=","df.fieldname"],["and","df.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'trans'"]]}]],["and","df.deleted","=","0"],["and",[["df.visible","=","1"],["or","df.fieldname","in",[[],"'trans_reholiday'","'trans_rebadtool'","'trans_reother'","'trans_rentnote'","'trans_wsdistance'","'trans_wsrepair'","'trans_wstotal'","'trans_wsnote'"]]]]]],["groups fg","on",["df.fieldtype","=","fg.id"]],["trans t","on",["fv.ref_id","=","t.id"]],["groups tg","on",[["t.transtype","=","tg.id"],["and","tg.groupvalue","in",[[],"'invoice'","'receipt'","'order'","'offer'","'worksheet'","'rent'"]]]],["groups dg","on",["t.direction","=","dg.id"]]],left_join:[["ui_message mst","on",[["mst.fieldname","=","tg.groupvalue"],["and","mst.secname","=","'transtype'"],["and","mst.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]],["ui_message msd","on",[["msd.fieldname","=","dg.groupvalue"],["and","msd.secname","=","'direction'"],["and","msd.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]],[[[{select:["fieldname"],from:"deffield df",inner_join:["groups fg","on",[["df.fieldtype","=","fg.id"],["and","fg.groupvalue","in",[[],"'integer'","'float'"]]]]}],"rf_number"],"on",["fv.fieldname","=","rf_number.fieldname"]],[[[{select:["fieldname"],from:"deffield df",inner_join:["groups fg","on",[["df.fieldtype","=","fg.id"],["and","fg.groupvalue","=","'date'"]]]}],"rf_date"],"on",["fv.fieldname","=","rf_date.fieldname"]],["customer rf_customer","on",["fv.value","=","{CAS_TEXT}rf_customer.id {CAE_TEXT}"]],["tool rf_tool","on",["fv.value","=","{CAS_TEXT}rf_tool.id {CAE_TEXT}"]],["trans rf_trans","on",["fv.value","=","{CAS_TEXT}rf_trans.id {CAE_TEXT}"]],["product rf_product","on",["fv.value","=","{CAS_TEXT}rf_product.id {CAE_TEXT}"]],["project rf_project","on",["fv.value","=","{CAS_TEXT}rf_project.id {CAE_TEXT}"]],["employee rf_employee","on",["fv.value","=","{CAS_TEXT}rf_employee.id {CAE_TEXT}"]],["place rf_place","on",["fv.value","=","{CAS_TEXT}rf_place.id {CAE_TEXT}"]]],where:[["fv.deleted","=","0"],["and",[["t.deleted","=","0"],["or",[["tg.groupvalue","=","'invoice'"],["and","dg.groupvalue","=","'out'"]]],["or",[["tg.groupvalue","=","'receipt'"],["and",["dg.groupvalue","=","'out'"]]]]]]]}},TransItemRowView:{columns:{transnumber:!0,curr:!0,description:!0,amount:!0},label:t("item_view"),edit:"trans",fields:{transtype:{fieldtype:"string",wheretype:"where",orderby:0,label:t("document_transtype"),sqlstr:"case when mst.msg is null then tg.groupvalue else mst.msg end "},direction:{fieldtype:"string",wheretype:"where",orderby:1,label:t("document_direction"),sqlstr:"case when msd.msg is null then dg.groupvalue else msd.msg end "},transnumber:{fieldtype:"string",wheretype:"where",orderby:2,label:t("document_transnumber"),sqlstr:"t.transnumber "},transdate:{fieldtype:"date",wheretype:"where",orderby:3,label:t("item_transdate"),sqlstr:"t.transdate "},partnumber:{fieldtype:"string",wheretype:"where",orderby:4,label:t("product_partnumber"),sqlstr:"p.partnumber "},description:{fieldtype:"string",wheretype:"where",orderby:5,label:t("item_description"),sqlstr:"i.description "},unit:{fieldtype:"string",wheretype:"where",orderby:6,label:t("item_unit"),sqlstr:"i.unit "},curr:{fieldtype:"string",wheretype:"where",orderby:7,label:t("document_curr"),sqlstr:"t.curr "},qty:{fieldtype:"float",wheretype:"where",orderby:8,label:t("item_qty"),sqlstr:"i.qty "},fxprice:{fieldtype:"float",wheretype:"where",orderby:9,label:t("item_fxprice"),sqlstr:"i.fxprice "},netamount:{fieldtype:"float",wheretype:"where",orderby:10,label:t("item_netamount"),sqlstr:"i.netamount "},discount:{fieldtype:"float",wheretype:"where",orderby:11,label:t("item_discount"),sqlstr:"i.discount "},taxcode:{fieldtype:"string",wheretype:"where",orderby:12,label:t("item_taxcode"),sqlstr:"tax.taxcode "},vatamount:{fieldtype:"float",wheretype:"where",orderby:13,label:t("item_vatamount"),sqlstr:"i.vatamount "},amount:{fieldtype:"float",wheretype:"where",orderby:14,label:t("item_amount"),sqlstr:"i.amount "},deposit:{fieldtype:"bool",wheretype:"where",orderby:15,label:t("item_deposit"),sqlstr:"i.deposit "},actionprice:{fieldtype:"bool",wheretype:"where",orderby:16,label:t("item_actionprice"),sqlstr:"i.actionprice "},ownstock:{fieldtype:"float",wheretype:"where",orderby:17,label:t("item_ownstock"),sqlstr:"i.ownstock "}},sql:{select:["{CCS}'trans'{SEP}'/'{SEP}tg.groupvalue{SEP}'/'{SEP} {CAS_TEXT}t.id {CAE_TEXT}{CCE} as id","i.id as row_id","'item' as form","i.id as form_id","case when mst.msg is null then tg.groupvalue else mst.msg end as transtype","case when msd.msg is null then dg.groupvalue else msd.msg end as direction","t.transnumber","{FMS_DATE}t.transdate {FME_DATE} as transdate","t.curr","{CCS}'product//'{SEP} {CAS_TEXT}p.id {CAE_TEXT}{CCE} as partnumber","p.partnumber as export_partnumber","i.description","i.unit","{FMS_FLOAT}i.qty{FME_FLOAT} as qty","i.qty as export_qty","{FMS_FLOAT}i.fxprice{FME_FLOAT} as fxprice","i.fxprice as export_fxprice","{FMS_FLOAT}i.netamount{FME_FLOAT} as netamount","i.netamount as export_netamount","i.discount as discount","tax.taxcode","{FMS_FLOAT}i.vatamount{FME_FLOAT} as vatamount","i.vatamount as export_vatamount","{FMS_FLOAT}i.amount{FME_FLOAT} as amount","i.amount as export_amount","i.deposit","i.actionprice","{FMS_FLOAT}i.ownstock{FME_FLOAT} as ownstock","i.ownstock as export_ownstock"],from:"item i",inner_join:[["trans t","on",["i.trans_id","=","t.id"]],["groups tg","on",["t.transtype","=","tg.id"]],["groups dg","on",["t.direction","=","dg.id"]],["product p","on",["i.product_id","=","p.id"]],["tax","on",["i.tax_id","=","tax.id"]]],left_join:[["ui_message mst","on",[["mst.fieldname","=","tg.groupvalue"],["and","mst.secname","=","'transtype'"],["and","mst.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]],["ui_message msd","on",[["msd.fieldname","=","dg.groupvalue"],["and","msd.secname","=","'direction'"],["and","msd.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]]],where:[["i.deleted","=","0"],["and",[["t.deleted","=","0"],["or",[["tg.groupvalue","=","'invoice'"],["and","dg.groupvalue","=","'out'"]]],["or",[["tg.groupvalue","=","'receipt'"],["and","dg.groupvalue","=","'out'"]]]]]]}}}},transmovement:function(){return{options:{deffield_sql:{select:["df.id","df.fieldname","g.groupvalue as fieldtype","df.description"],from:"deffield df",inner_join:["groups g","on",["g.id","=","df.fieldtype"]],where:[["df.deleted","=","0"],["and","df.visible","=","1"],["and","df.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'trans'"]]}]]]}},InventoryView:{columns:{warehouse:!0,partnumber:!0,unit:!0,sqty:!0},label:t("inventory_view"),readonly:!0,fields:{warehouse:{fieldtype:"string",wheretype:"where",orderby:0,label:t("inventory_warehouse"),sqlstr:"pl.description "},partnumber:{fieldtype:"string",wheretype:"where",orderby:1,label:t("product_partnumber"),sqlstr:"p.partnumber "},unit:{fieldtype:"string",wheretype:"where",orderby:2,label:t("product_unit"),sqlstr:"p.unit "},sqty:{fieldtype:"float",wheretype:"having",orderby:3,label:t("inventory_sqty"),sqlstr:"sum(mv.qty) "},posdate:{fieldtype:"date",wheretype:"having",orderby:4,label:t("inventory_posdate"),sqlstr:"{CAS_DATE}max(mv.shippingdate){CAE_DATE} "},description:{fieldtype:"string",wheretype:"where",orderby:5,label:t("product_description"),sqlstr:"p.description "}},sql:{select:["{CCS} {CAS_TEXT}pl.id {CAE_TEXT}{SEP}'/'{SEP} {CAS_TEXT}p.id {CAE_TEXT}{SEP}'/'{SEP} mv.notes{CCE} as row_id","pl.description as warehouse","p.partnumber as export_partnumber","{CCS}'product//'{SEP} {CAS_TEXT}p.id {CAE_TEXT}{CCE} as partnumber","p.description","p.unit","mv.notes as pgroup","{FMS_FLOAT}sum(mv.qty){FME_FLOAT} as sqty","sum(mv.qty) as export_sqty","{FMS_DATE}max(mv.shippingdate) {FME_DATE} as posdate"],from:"movement mv",inner_join:[["groups g","on",[["mv.movetype","=","g.id"],["and","g.groupvalue","=","'inventory'"]]],["place pl","on",["mv.place_id","=","pl.id"]],["product p","on",["mv.product_id","=","p.id"]],["trans t","on",[["mv.trans_id","=","t.id"],["and","t.deleted","=","0"]]],["groups tg","on",["t.transtype","=","tg.id"]],["groups dg","on",["t.direction","=","dg.id"]]],where:[["mv.deleted","=","0"],["and","t.deleted","=","0"]],group_by:["pl.id","pl.description","p.id","p.partnumber","p.description","p.unit","mv.notes"],having:[["sum(mv.qty)","<>","0"]]}},MovementView:{columns:{transtype:!0,shippingdate:!0,partnumber:!0,qty:!0},label:t("movement_view"),edit:"trans",fields:{transtype:{fieldtype:"string",wheretype:"where",orderby:0,label:t("document_transtype"),sqlstr:"case when mst.msg is null then tg.groupvalue else mst.msg end "},direction:{fieldtype:"string",wheretype:"where",orderby:1,label:t("document_direction"),sqlstr:"case when msd.msg is null then dg.groupvalue else msd.msg end "},transnumber:{fieldtype:"string",wheretype:"where",orderby:2,label:t("document_transnumber"),sqlstr:"t.transnumber "},shippingdate:{fieldtype:"date",wheretype:"where",orderby:3,label:t("movement_shippingdate"),sqlstr:"{CAS_DATE}mt.shippingdate{CAE_DATE} "},warehouse:{fieldtype:"string",wheretype:"where",orderby:4,label:t("inventory_warehouse"),sqlstr:"pt.description  "},partnumber:{fieldtype:"string",wheretype:"where",orderby:5,label:t("product_partnumber"),sqlstr:"p.partnumber  "},description:{fieldtype:"string",wheretype:"where",orderby:6,label:t("product_description"),sqlstr:"p.description  "},unit:{fieldtype:"string",wheretype:"where",orderby:7,label:t("product_unit"),sqlstr:"p.unit  "},pgroup:{fieldtype:"string",wheretype:"where",orderby:8,label:t("movement_batchnumber"),sqlstr:"mt.notes "},qty:{fieldtype:"float",wheretype:"where",orderby:9,label:t("movement_qty"),sqlstr:"mt.qty "},refnumber:{fieldtype:"string",wheretype:"where",orderby:10,label:t("movement_refnumber"),sqlstr:"case when it.transnumber is null then case when vt1.transnumber is null then case when vt2.transnumber is null then tl.transnumber end     else vt1.transnumber end else it.transnumber end "},refcustomer:{fieldtype:"string",wheretype:"where",orderby:11,label:t("movement_refcustomer"),sqlstr:"case when c1.custname is null then c2.custname else c1.custname end "}},sql:{select:["{CCS}'trans'{SEP}'/'{SEP}tg.groupvalue{SEP}'/'{SEP}case when it.id is null then {CAS_TEXT}t.id {CAE_TEXT} else {CAS_TEXT}it.id {CAE_TEXT} end{CCE} as id","mt.id as row_id","case when mst.msg is null then tg.groupvalue else mst.msg end as transtype","case when msd.msg is null then dg.groupvalue else msd.msg end as direction","t.transnumber","{FMS_DATE}mt.shippingdate {FME_DATE} as shippingdate","pt.description as warehouse","{CCS}'product//'{SEP} {CAS_TEXT}p.id {CAE_TEXT}{CCE} as partnumber","p.partnumber as export_partnumber","p.description","p.unit","mt.notes as pgroup","mt.qty","{FMS_FLOAT}mt.qty{FME_FLOAT} as qty","mt.qty as export_qty","case when it.transnumber is null then case when vt1.transnumber is null then case when vt2.transnumber is null then tl.transnumber end else vt1.transnumber end else it.transnumber end as refnumber","case when c1.custname is null then c2.custname else c1.custname end as refcustomer"],from:"movement mt",inner_join:[["trans t","on",["mt.trans_id","=","t.id"]],["groups gm","on",[["mt.movetype","=","gm.id"],["and","gm.groupvalue","=","'inventory'"]]],["groups tg","on",["t.transtype","=","tg.id"]],["groups dg","on",["t.direction","=","dg.id"]],["product p","on",["mt.product_id","=","p.id"]],["place pt","on",["mt.place_id","=","pt.id"]]],left_join:[["ui_message mst","on",[["mst.fieldname","=","tg.groupvalue"],["and","mst.secname","=","'transtype'"],["and","mst.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]],["ui_message msd","on",[["msd.fieldname","=","dg.groupvalue"],["and","msd.secname","=","'direction'"],["and","msd.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]],["link iln","on",[["iln.nervatype_1","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'movement'"]]}]],["and","iln.ref_id_1","=","mt.id"],["and","iln.nervatype_2","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'item'"]]}]]]],["item i","on",["iln.ref_id_2","=","i.id"]],["trans it","on",["i.trans_id","=","it.id"]],["customer c1","on",["it.customer_id","=","c1.id"]],["link tln","on",["tln.nervatype_1","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'trans'"]]}],["and","tln.ref_id_1","=","mt.trans_id"],["and","tln.nervatype_2","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'trans'"]]}]],["and","tln.deleted","=","0"]]],["trans tl","on",["tln.ref_id_2","=","tl.id"]],["customer c2","on",["tl.customer_id","=","c2.id"]],["link pln1","on",[["pln1.nervatype_1","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'movement'"]]}]],["and","pln1.ref_id_1","=","mt.id"],["and","pln1.nervatype_2","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'movement'"]]}]]]],["movement mv1","on",["pln1.ref_id_2","=","mv1.id"]],["trans vt1","on",["mv1.trans_id","=","vt1.id"]],["link pln2","on",["pln2.nervatype_1","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'movement'"]]}],["and","pln2.ref_id_2","=","mt.id"],["and","pln2.nervatype_2","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'movement'"]]}]]]],["movement mv2","on",["pln2.ref_id_1","=","mv2.id"]],["trans vt2","on",["mv2.trans_id","=","vt2.id"]]],where:[["mt.deleted","=","0"],["and","t.deleted","=","0"]]}},ToolMovement:{columns:{transnumber:!0,direction:!0,shippingdate:!0,serial:!0},label:t("toolmovement_view"),edit:"trans",fields:{transnumber:{fieldtype:"string",wheretype:"where",orderby:0,label:t("document_transnumber"),sqlstr:"t.transnumber "},crdate:{fieldtype:"date",wheretype:"where",orderby:1,label:t("document_crdate"),sqlstr:"t.crdate "},direction:{fieldtype:"string",wheretype:"where",orderby:2,label:t("document_direction"),sqlstr:"case when msd.msg is null then dg.groupvalue else msd.msg end "},refnumber:{fieldtype:"string",wheretype:"where",orderby:3,label:t("movement_refnumber"),sqlstr:"lt.transnumber "},empnumber:{fieldtype:"string",wheretype:"where",orderby:4,label:t("employee_empnumber"),sqlstr:"e.empnumber "},custname:{fieldtype:"string",wheretype:"where",orderby:5,label:t("customer_custname"),sqlstr:"c.custname "},shippingdate:{fieldtype:"date",wheretype:"where",orderby:6,label:t("movement_shippingdate"),sqlstr:"{CAS_DATE}mv.shippingdate {CAE_DATE} "},serial:{fieldtype:"string",wheretype:"where",orderby:7,label:t("tool_serial"),sqlstr:"tl.serial "},description:{fieldtype:"string",wheretype:"where",orderby:8,label:t("tool_description"),sqlstr:"tl.description "},mvnotes:{fieldtype:"string",wheretype:"where",orderby:9,label:t("movement_mvnotes"),sqlstr:"mv.notes "},closed:{fieldtype:"bool",wheretype:"where",orderby:10,label:t("document_closed"),sqlstr:"t.closed "},transtate:{fieldtype:"string",wheretype:"where",orderby:11,label:t("document_transtate"),sqlstr:"case when mss.msg is null then sg.groupvalue else mss.msg end "},notes:{fieldtype:"string",wheretype:"where",orderby:12,label:t("document_notes"),sqlstr:"t.notes "},intnotes:{fieldtype:"string",wheretype:"where",orderby:13,label:t("document_intnotes"),sqlstr:"t.intnotes "}},sql:{select:["{CCS}'trans'{SEP}'/'{SEP}tg.groupvalue{SEP}'/'{SEP} {CAS_TEXT}t.id {CAE_TEXT}{CCE} as id","mv.id as row_id","t.transnumber","{FMS_DATE}t.crdate{FME_DATE} as crdate","t.crdate as export_crdate","case when msd.msg is null then dg.groupvalue else msd.msg end as direction","lt.transnumber as export_refnumber","e.empnumber as export_empnumber","c.custname as export_custname","{CCS}'trans/'{SEP}ltg.groupvalue{SEP}'/'{SEP} {CAS_TEXT}lt.id {CAE_TEXT}{CCE} as refnumber","{CCS}'employee//'{SEP} {CAS_TEXT}e.id {CAE_TEXT}{CCE} as empnumber","{CCS}'customer//'{SEP} {CAS_TEXT}c.id {CAE_TEXT}{CCE} as custname","{FMS_DATETIME}mv.shippingdate {FME_DATETIME} as shippingdate","{CCS}'tool//'{SEP} {CAS_TEXT}tl.id {CAE_TEXT}{CCE} as serial","tl.serial as export_serial","tl.description","mv.notes as mvnotes","case when mss.msg is null then sg.groupvalue else mss.msg end as transtate","t.notes","t.intnotes","t.closed"],from:"trans t",inner_join:[["movement mv","on",["t.id","=","mv.trans_id"]],["tool tl","on",["mv.tool_id","=","tl.id"]],["groups tg","on",[["t.transtype","=","tg.id"],["and","tg.groupvalue","=","'waybill'"]]],["groups dg","on",["t.direction","=","dg.id"]],["groups sg","on",["t.transtate","=","sg.id"]]],left_join:[["employee e","on",["t.employee_id","=","e.id"]],["customer c","on",["t.customer_id","=","c.id"]],["ui_message mss","on",[["mss.fieldname","=","sg.groupvalue"],["and","mss.secname","=","'transtate'"],["and","mss.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]],["ui_message msd","on",[["msd.fieldname","=","dg.groupvalue"],["and","msd.secname","=","'direction'"],["and","msd.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]],["link lnk","on",[["t.id","=","lnk.ref_id_1"],["and","lnk.deleted","=","0"],["and","lnk.nervatype_1","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'trans'"]]}]],["and","lnk.nervatype_2","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'trans'"]]}]]]],["trans lt","on",["lnk.ref_id_2","=","lt.id"]],["groups ltg","on",["lt.transtype","=","ltg.id"]]],where:[["t.deleted","=","0"],["and","mv.deleted","=","0"]]}},FormulaView:{columns:{transnumber:!0,type:!0,partnumber:!0,qty:!0},label:t("formula_view"),edit:"trans",fields:{transnumber:{fieldtype:"string",wheretype:"where",orderby:0,label:t("document_transnumber"),sqlstr:"t.transnumber "},type:{fieldtype:"string",wheretype:"where",orderby:1,label:t("formula_type"),sqlstr:"case when mt.groupvalue = 'head' then 'in' else 'out' end "},partnumber:{fieldtype:"string",wheretype:"where",orderby:2,label:t("product_partnumber"),sqlstr:"p.partnumber "},description:{fieldtype:"string",wheretype:"where",orderby:3,label:t("product_description"),sqlstr:"p.description "},unit:{fieldtype:"string",wheretype:"where",orderby:4,label:t("product_unit"),sqlstr:"p.unit "},qty:{fieldtype:"float",wheretype:"where",orderby:5,label:t("movement_qty"),sqlstr:"mv.qty "},batch_no:{fieldtype:"string",wheretype:"where",orderby:6,label:t("movement_batchnumber"),sqlstr:"mv.notes "},planumber:{fieldtype:"string",wheretype:"where",orderby:7,label:t("inventory_warehouse"),sqlstr:"pl.planumber "},shared:{fieldtype:"bool",wheretype:"where",orderby:8,label:t("formula_shared"),sqlstr:"mv.shared "}},sql:{select:["{CCS}'trans'{SEP}'/'{SEP}tg.groupvalue{SEP}'/'{SEP} {CAS_TEXT}t.id {CAE_TEXT}{CCE} as id","mv.id as row_id","t.transnumber","case when mt.groupvalue = 'head' then 'in' else 'out' end as type","{CCS}'product//'{SEP} {CAS_TEXT}p.id {CAE_TEXT}{CCE} as partnumber","p.partnumber as export_partnumber","p.description","p.unit","{FMS_FLOAT}mv.qty{FME_FLOAT} as qty","mv.qty as export_qty","mv.notes as batch_no","pl.planumber","mv.shared"],from:"trans t",inner_join:[["movement mv","on",[["t.id","=","mv.trans_id"],["and","mv.deleted","=","0"]]],["groups tg","on",[["t.transtype","=","tg.id"],["and","tg.groupvalue","=","'formula'"]]],["groups mt","on",["mv.movetype","=","mt.id"]],["product p","on",["mv.product_id","=","p.id"]]],left_join:["place pl","on",["mv.place_id","=","pl.id"]],where:[["t.deleted","=","0"]]}},MovementFieldsView:{columns:{transtype:!0,transnumber:!0,fielddef:!0,deffield_value:!0},label:t("fields_view"),edit:"trans",fields:{transtype:{fieldtype:"string",wheretype:"where",orderby:0,label:t("document_transtype"),sqlstr:"case when mst.msg is null then tg.groupvalue else mst.msg end "},direction:{fieldtype:"string",wheretype:"where",orderby:1,label:t("document_direction"),sqlstr:"case when tg.groupvalue='bank' then '' else case when msd.msg is null then dg.groupvalue else msd.msg end end "},transnumber:{fieldtype:"string",wheretype:"where",orderby:2,label:t("document_transnumber"),sqlstr:"t.transnumber "},fielddef:{fieldtype:"string",wheretype:"where",orderby:3,label:t("fields_fielddef"),sqlstr:"df.description "},deffield_value:{fieldtype:"string",wheretype:"where",orderby:4,label:t("fields_value"),sqlstr:"fv.value "},notes:{fieldtype:"string",wheretype:"where",orderby:5,label:t("fields_notes"),sqlstr:"fv.notes "}},sql:{select:["{CCS}'trans'{SEP}'/'{SEP} tg.groupvalue{SEP}'/'{SEP} case when delt.ref_id is null then {CAS_TEXT}t.id {CAE_TEXT} else {CAS_TEXT}delt.ref_id {CAE_TEXT} end{CCE} as id","fv.id as row_id","fv.fieldname","'fieldvalue' as form","fg.groupvalue as fieldtype","case when mst.msg is null then tg.groupvalue else mst.msg end as transtype","case when tg.groupvalue='bank' then '' else case when msd.msg is null then dg.groupvalue else msd.msg end end as direction","t.transnumber","df.description as fielddef","case when fg.groupvalue in ('bool') then fv.value when fg.groupvalue in ('integer') then {CCS}{FMS_INT}fv.value{FME_INT}{CCE} when fg.groupvalue in ('float') then {CCS}{FMS_FLOAT}fv.value{FME_FLOAT}{CCE} when fg.groupvalue in ('customer') then {CCS}'customer//'{SEP} {CAS_TEXT}rf_customer.id {CAE_TEXT}{CCE} when fg.groupvalue in ('tool') then {CCS}'tool//'{SEP} {CAS_TEXT}rf_tool.id {CAE_TEXT}{CCE} when fg.groupvalue in ('product') then {CCS}'product//'{SEP} {CAS_TEXT}rf_product.id {CAE_TEXT}{CCE} when fg.groupvalue in ('trans', 'transitem', 'transmovement', 'transpayment') then {CCS}'trans//'{SEP} {CAS_TEXT}rf_trans.id {CAE_TEXT}{CCE} when fg.groupvalue in ('project') then {CCS}'project//'{SEP} {CAS_TEXT}rf_project.id {CAE_TEXT}{CCE} when fg.groupvalue in ('employee') then {CCS}'employee//'{SEP} {CAS_TEXT}rf_employee.id {CAE_TEXT}{CCE} when fg.groupvalue in ('place') then {CCS}'place//'{SEP} {CAS_TEXT}rf_place.id {CAE_TEXT}{CCE} when fg.groupvalue in ('urlink') then {CCS}'url/'{SEP}fv.value{CCE} when fg.groupvalue in ('password') then '**********' when fg.groupvalue in ('notes', 'string', 'valuelist','date','time') then fv.value else null end as deffield_value, case when fg.groupvalue in ('bool','float','integer','date','time','urlink','notes', 'string', 'valuelist') then fv.value when fg.groupvalue in ('customer') then rf_customer.custname when fg.groupvalue in ('tool') then rf_tool.serial when fg.groupvalue in ('product') then rf_product.partnumber when fg.groupvalue in ('trans', 'transitem', 'transmovement', 'transpayment') then rf_trans.transnumber when fg.groupvalue in ('project') then rf_project.pronumber when fg.groupvalue in ('employee') then rf_employee.empnumber when fg.groupvalue in ('place') then rf_place.planumber when fg.groupvalue in ('password') then '**********' else null end as export_deffield_value, fv.notes"],from:"fieldvalue fv",inner_join:[["deffield df","on",[["fv.fieldname","=","df.fieldname"],["and","df.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'trans'"]]}]],["and","df.deleted","=","0"],["and","df.visible","=","1"]]],["groups fg","on",["df.fieldtype","=","fg.id"]],["trans t","on",["fv.ref_id","=","t.id"]],["groups tg","on",[["t.transtype","=","tg.id"],["and","tg.groupvalue","in",[[],"'delivery'","'inventory'","'waybill'","'production'","'formula'"]]]],["groups dg","on",["t.direction","=","dg.id"]]],left_join:[["ui_message mst","on",[["mst.fieldname","=","tg.groupvalue"],["and","mst.secname","=","'transtype'"],["and","mst.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]],["ui_message msd","on",[["msd.fieldname","=","dg.groupvalue"],["and","msd.secname","=","'direction'"],["and","msd.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]],[[[{select:["fieldname"],from:"deffield df",inner_join:["groups fg","on",[["df.fieldtype","=","fg.id"],["and","fg.groupvalue","in",[[],"'integer'","'float'"]]]]}],"rf_number"],"on",["fv.fieldname","=","rf_number.fieldname"]],[[[{select:["fieldname"],from:"deffield df",inner_join:["groups fg","on",[["df.fieldtype","=","fg.id"],["and","fg.groupvalue","=","'date'"]]]}],"rf_date"],"on",["fv.fieldname","=","rf_date.fieldname"]],["customer rf_customer","on",["fv.value","=","{CAS_TEXT}rf_customer.id {CAE_TEXT}"]],["tool rf_tool","on",["fv.value","=","{CAS_TEXT}rf_tool.id {CAE_TEXT}"]],["trans rf_trans","on",["fv.value","=","{CAS_TEXT}rf_trans.id {CAE_TEXT}"]],["product rf_product","on",["fv.value","=","{CAS_TEXT}rf_product.id {CAE_TEXT}"]],["project rf_project","on",["fv.value","=","{CAS_TEXT}rf_project.id {CAE_TEXT}"]],["employee rf_employee","on",["fv.value","=","{CAS_TEXT}rf_employee.id {CAE_TEXT}"]],["place rf_place","on",["fv.value","=","{CAS_TEXT}rf_place.id {CAE_TEXT}"]],[[[{select:["mt.trans_id","min(it.id) as ref_id"],from:"movement mt",inner_join:[["link iln","on",["iln.nervatype_1","=",[[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'movement'"]]}],["and","iln.ref_id_1","=","mt.id"],["and","iln.nervatype_2","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'item'"]]}]]]]],["item i","on",["iln.ref_id_2","=","i.id"]]],left_join:["trans it","on",["i.trans_id","=","it.id"]],group_by:["mt.trans_id"]}],"delt"],"on",["fv.ref_id","=","delt.trans_id"]]],where:[["fv.deleted","=","0"],["and","t.deleted","=","0"]]}}}},transpayment:function(){return{options:{deffield_sql:{select:["df.id","df.fieldname","g.groupvalue as fieldtype","df.description"],from:"deffield df",inner_join:["groups g","on",["g.id","=","df.fieldtype"]],where:[["df.deleted","=","0"],["and","df.visible","=","1"],["and","df.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'trans'"]]}]]]}},PaymentView:{columns:{transnumber:!0,paiddate:!0,place:!0,curr:!0,amount:!0},label:t("payment_view"),edit:"trans",fields:{transtype:{fieldtype:"string",wheretype:"where",orderby:0,label:t("document_transtype"),sqlstr:"case when mst.msg is null then tg.groupvalue else mst.msg end "},direction:{fieldtype:"string",wheretype:"where",orderby:1,label:t("document_direction"),sqlstr:"case when tg.groupvalue='bank' then '' else case when msd.msg is null then dg.groupvalue else msd.msg end end "},transcast:{fieldtype:"string",wheretype:"where",orderby:2,label:t("document_transcast"),sqlstr:"case when msc.msg is null then fv.value else msc.msg end "},transnumber:{fieldtype:"string",wheretype:"where",orderby:3,label:t("document_transnumber"),sqlstr:"t.transnumber "},ref_transnumber:{fieldtype:"string",wheretype:"where",orderby:4,label:t("document_ref_transnumber"),sqlstr:"t.ref_transnumber "},crdate:{fieldtype:"date",wheretype:"where",orderby:5,label:t("document_crdate"),sqlstr:"t.crdate "},paiddate:{fieldtype:"date",wheretype:"where",orderby:6,label:t("payment_paiddate"),sqlstr:"pm.paiddate "},place:{fieldtype:"string",wheretype:"where",orderby:7,label:t("payment_place"),sqlstr:"pc.description "},curr:{fieldtype:"string",wheretype:"where",orderby:8,label:t("payment_curr"),sqlstr:"pc.curr "},amount:{fieldtype:"float",wheretype:"where",orderby:9,label:t("payment_amount"),sqlstr:"case when dg.groupvalue='out' then -pm.amount else pm.amount end "},description:{fieldtype:"string",wheretype:"where",orderby:10,label:t("payment_description"),sqlstr:"pm.notes "},empnumber:{fieldtype:"string",wheretype:"where",orderby:11,label:t("employee_empnumber"),sqlstr:"e.empnumber "},transtate:{fieldtype:"string",wheretype:"where",orderby:12,label:t("document_transtate"),sqlstr:"case when mss.msg is null then sg.groupvalue else mss.msg end "},closed:{fieldtype:"bool",wheretype:"where",orderby:13,label:t("document_closed"),sqlstr:"t.closed "},deleted:{fieldtype:"bool",wheretype:"where",orderby:14,label:t("document_deleted"),sqlstr:"t.deleted "},notes:{fieldtype:"string",wheretype:"where",orderby:15,label:t("document_notes"),sqlstr:"t.notes "},intnotes:{fieldtype:"string",wheretype:"where",orderby:16,label:t("document_intnotes"),sqlstr:"t.intnotes "}},sql:{select:["{CCS}'trans'{SEP}'/'{SEP}tg.groupvalue{SEP}'/'{SEP} {CAS_TEXT}t.id {CAE_TEXT}{CCE} as id","pm.id as row_id","case when mst.msg is null then tg.groupvalue else mst.msg end as transtype","case when tg.groupvalue='bank' then '' else case when msd.msg is null then dg.groupvalue else msd.msg end end as direction","case when msc.msg is null then fv.value else msc.msg end as transcast","t.transnumber","t.ref_transnumber","{FMS_DATE}t.crdate {FME_DATE} as crdate","{FMS_DATE}pm.paiddate {FME_DATE} as paiddate","{CCS}'place//'{SEP} {CAS_TEXT}pc.id {CAE_TEXT}{CCE} as place, pc.description as export_place","pc.curr","{FMS_FLOAT}case when dg.groupvalue='out' then -pm.amount else pm.amount end{FME_FLOAT} as amount","case when dg.groupvalue='out' then -pm.amount else pm.amount end as export_amount","pm.notes as description","{CCS}'employee//'{SEP} {CAS_TEXT}e.id {CAE_TEXT}{CCE} as empnumber","e.empnumber as export_empnumber","case when mss.msg is null then sg.groupvalue else mss.msg end as transtate","t.notes","t.intnotes","t.closed","t.deleted as deleted"],from:"trans t",inner_join:[["groups tg","on",["t.transtype","=","tg.id"]],["groups dg","on",["t.direction","=","dg.id"]],["place pc","on",["t.place_id","=","pc.id"]],["groups sg","on",["t.transtate","=","sg.id"]],["payment pm","on",[["t.id","=","pm.trans_id"],["and","pm.deleted","=","0"]]]],left_join:[["employee e","on",["t.employee_id","=","e.id"]],["fieldvalue fv","on",[["t.id","=","fv.ref_id"],["and","fv.fieldname","=","'trans_transcast'"]]],["ui_message mst","on",[["mst.fieldname","=","tg.groupvalue"],["and","mst.secname","=","'transtype'"],["and","mst.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]],["ui_message msd","on",[["msd.fieldname","=","dg.groupvalue"],["and","msd.secname","=","'direction'"],["and","msd.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]],["ui_message mss","on",[["mss.fieldname","=","sg.groupvalue"],["and","mss.secname","=","'transtate'"],["and","mss.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]],["ui_message msc","on",[["msc.fieldname","=","fv.value"],["and","msc.secname","=","'trans_transcast'"],["and","msc.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]]],where:[[[["t.deleted","=","0"],["or",["tg.groupvalue","=","'cash'"]]]]]}},PaymentFieldsView:{columns:{transtype:!0,direction:!0,transnumber:!0,fielddef:!0,deffield_value:!0},label:t("fields_view"),edit:"trans",fields:{transtype:{fieldtype:"string",wheretype:"where",orderby:0,label:t("document_transtype"),sqlstr:"case when mst.msg is null then tg.groupvalue else mst.msg end "},direction:{fieldtype:"string",wheretype:"where",orderby:1,label:t("document_direction"),sqlstr:"case when tg.groupvalue='bank' then '' else case when msd.msg is null then dg.groupvalue else msd.msg end end "},transnumber:{fieldtype:"string",wheretype:"where",orderby:2,label:t("document_transnumber"),sqlstr:"t.transnumber "},fielddef:{fieldtype:"string",wheretype:"where",orderby:3,label:t("fields_fielddef"),sqlstr:"df.description "},deffield_value:{fieldtype:"string",wheretype:"where",orderby:4,label:t("fields_value"),sqlstr:"fv.value "},notes:{fieldtype:"string",wheretype:"where",orderby:5,label:t("fields_notes"),sqlstr:"fv.notes "}},sql:{select:["{CCS}'trans'{SEP}'/'{SEP}tg.groupvalue{SEP}'/'{SEP} {CAS_TEXT}t.id {CAE_TEXT}{CCE} as id","fv.id as row_id","fv.fieldname","'fieldvalue' as form","fg.groupvalue as fieldtype","case when mst.msg is null then tg.groupvalue else mst.msg end as transtype","case when tg.groupvalue='bank' then '' else case when msd.msg is null then dg.groupvalue else msd.msg end end as direction","t.transnumber","df.description as fielddef","case when fg.groupvalue in ('bool') then fv.value when fg.groupvalue in ('integer') then {CCS}{FMS_INT}fv.value{FME_INT}{CCE} when fg.groupvalue in ('float') then {CCS}{FMS_FLOAT}fv.value{FME_FLOAT}{CCE} when fg.groupvalue in ('customer') then {CCS}'customer//'{SEP} {CAS_TEXT}rf_customer.id {CAE_TEXT}{CCE} when fg.groupvalue in ('tool') then {CCS}'tool//'{SEP} {CAS_TEXT}rf_tool.id {CAE_TEXT}{CCE} when fg.groupvalue in ('product') then {CCS}'product//'{SEP} {CAS_TEXT}rf_product.id {CAE_TEXT}{CCE} when fg.groupvalue in ('trans', 'transitem', 'transmovement', 'transpayment') then {CCS}'trans//'{SEP} {CAS_TEXT}rf_trans.id {CAE_TEXT}{CCE} when fg.groupvalue in ('project') then {CCS}'project//'{SEP} {CAS_TEXT}rf_project.id {CAE_TEXT}{CCE} when fg.groupvalue in ('employee') then {CCS}'employee//'{SEP} {CAS_TEXT}rf_employee.id {CAE_TEXT}{CCE} when fg.groupvalue in ('place') then {CCS}'place//'{SEP} {CAS_TEXT}rf_place.id {CAE_TEXT}{CCE} when fg.groupvalue in ('urlink') then {CCS}'url/'{SEP}fv.value{CCE} when fg.groupvalue in ('password') then '**********' when fg.groupvalue in ('notes', 'string', 'valuelist','date','time') then fv.value else null end as deffield_value, case when fg.groupvalue in ('bool','float','integer','date','time','urlink','notes', 'string', 'valuelist') then fv.value when fg.groupvalue in ('customer') then rf_customer.custname when fg.groupvalue in ('tool') then rf_tool.serial when fg.groupvalue in ('product') then rf_product.partnumber when fg.groupvalue in ('trans', 'transitem', 'transmovement', 'transpayment') then rf_trans.transnumber when fg.groupvalue in ('project') then rf_project.pronumber when fg.groupvalue in ('employee') then rf_employee.empnumber when fg.groupvalue in ('place') then rf_place.planumber when fg.groupvalue in ('password') then '**********' else null end as export_deffield_value, fv.notes"],from:"fieldvalue fv",inner_join:[["deffield df","on",[["fv.fieldname","=","df.fieldname"],["and","df.nervatype","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'trans'"]]}]],["and","df.deleted","=","0"],["and","df.visible","=","1"]]],["groups fg","on",["df.fieldtype","=","fg.id"]],["trans t","on",["fv.ref_id","=","t.id"]],["groups tg","on",[["t.transtype","=","tg.id"],["and","tg.groupvalue","in",[[],"'bank'","'cash'"]]]],["groups dg","on",["t.direction","=","dg.id"]]],left_join:[["ui_message mst","on",[["mst.fieldname","=","tg.groupvalue"],["and","mst.secname","=","'transtype'"],["and","mst.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]],["ui_message msd","on",[["msd.fieldname","=","dg.groupvalue"],["and","msd.secname","=","'direction'"],["and","msd.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]],[[[{select:["fieldname"],from:"deffield df",inner_join:["groups fg","on",[["df.fieldtype","=","fg.id"],["and","fg.groupvalue","in",[[],"'integer'","'float'"]]]]}],"rf_number"],"on",["fv.fieldname","=","rf_number.fieldname"]],[[[{select:["fieldname"],from:"deffield df",inner_join:["groups fg","on",[["df.fieldtype","=","fg.id"],["and","fg.groupvalue","=","'date'"]]]}],"rf_date"],"on",["fv.fieldname","=","rf_date.fieldname"]],["customer rf_customer","on",["fv.value","=","{CAS_TEXT}rf_customer.id {CAE_TEXT}"]],["tool rf_tool","on",["fv.value","=","{CAS_TEXT}rf_tool.id {CAE_TEXT}"]],["trans rf_trans","on",["fv.value","=","{CAS_TEXT}rf_trans.id {CAE_TEXT}"]],["product rf_product","on",["fv.value","=","{CAS_TEXT}rf_product.id {CAE_TEXT}"]],["project rf_project","on",["fv.value","=","{CAS_TEXT}rf_project.id {CAE_TEXT}"]],["employee rf_employee","on",["fv.value","=","{CAS_TEXT}rf_employee.id {CAE_TEXT}"]],["place rf_place","on",["fv.value","=","{CAS_TEXT}rf_place.id {CAE_TEXT}"]]],where:[["fv.deleted","=","0"],["and",[["t.deleted","=","0"],["or",["tg.groupvalue","=","'cash'"]]]],["and","fv.ref_id","in",[{select:["trans_id"],from:"payment"}]]]}},PaymentInvoiceView:{columns:{paidnumber:!0,paiddate:!0,pcurr:!0,paidamount:!0,invnumber:!0},label:t("payment_invoices"),edit:"trans",fields:{transtype:{fieldtype:"string",wheretype:"where",orderby:0,label:t("document_transtype"),sqlstr:"case when mst.msg is null then tg.groupvalue else mst.msg end "},direction:{fieldtype:"string",wheretype:"where",orderby:1,label:t("document_direction"),sqlstr:"case when tg.groupvalue='bank' then '' else case when msd.msg is null then dg.groupvalue else msd.msg end end "},paiddate:{fieldtype:"date",wheretype:"where",orderby:2,label:t("payment_paiddate"),sqlstr:"p.paiddate "},place:{fieldtype:"string",wheretype:"where",orderby:3,label:t("payment_place"),sqlstr:"pa.description "},paidnumber:{fieldtype:"string",wheretype:"where",orderby:4,label:t("payment_paidnumber"),sqlstr:"tp.transnumber "},pcurr:{fieldtype:"string",wheretype:"where",orderby:5,label:t("payment_pcurr"),sqlstr:"pa.curr "},paidamount:{fieldtype:"float",wheretype:"where",orderby:6,label:t("payment_amount"),sqlstr:"{CAS_FLOAT}af.value {CAE_FLOAT} "},prate:{fieldtype:"float",wheretype:"where",calc:"avg",orderby:7,label:t("payment_rate"),sqlstr:"{CAS_FLOAT}rf.value {CAE_FLOAT} "},invnumber:{fieldtype:"string",wheretype:"where",orderby:8,label:t("payment_invnumber"),sqlstr:"inv.transnumber "},icurr:{fieldtype:"string",wheretype:"where",orderby:9,label:t("payment_icurr"),sqlstr:"inv.curr "},invamount:{fieldtype:"float",wheretype:"where",orderby:10,label:t("payment_iamount"),sqlstr:"irow.amount "},pnotes:{fieldtype:"string",wheretype:"where",orderby:11,label:t("payment_description"),sqlstr:"p.notes "}},sql:{select:["{CCS}'trans'{SEP}'/'{SEP}tg.groupvalue{SEP}'/'{SEP} {CAS_TEXT}t.id {CAE_TEXT}{CCE} as id","ln.id as row_id","case when mst.msg is null then tg.groupvalue else mst.msg end as transtype","case when tg.groupvalue='bank' then '' else case when msd.msg is null then dg.groupvalue else msd.msg end end as direction","{FMS_DATE}p.paiddate {FME_DATE} as paiddate","pa.description as place","t.transnumber as paidnumber","pa.curr as pcurr","{FMS_FLOAT}{CAS_FLOAT}af.value {CAE_FLOAT}{FME_FLOAT} as paidamount","{CAS_FLOAT}af.value {CAE_FLOAT} as export_paidamount","{FMS_FLOAT}{CAS_FLOAT}rf.value {CAE_FLOAT}{FME_FLOAT} as prate","{CAS_FLOAT}rf.value {CAE_FLOAT} as export_prate","{CCS}'trans/'{SEP}itg.groupvalue{SEP}'/'{SEP} {CAS_TEXT}inv.id {CAE_TEXT}{CCE} as invnumber","inv.transnumber as export_invnumber","inv.curr as icurr","{FMS_FLOAT}irow.amount{FME_FLOAT} as invamount","irow.amount as export_invamount","p.notes as pnotes"],from:"link ln",inner_join:[["payment p","on",[["ln.ref_id_1","=","p.id"],["and","p.deleted","=","0"]]],["trans t","on",["p.trans_id","=","t.id"]],["groups tg","on",["t.transtype","=","tg.id"]],["groups dg","on",["t.direction","=","dg.id"]],["place pa","on",["t.place_id","=","pa.id"]],["trans inv","on",["ln.ref_id_2","=","inv.id"]],["groups itg","on",["inv.transtype","=","itg.id"]],[[[{select:["trans_id","sum(amount) as amount"],from:"item",where:["deleted","=","0"],group_by:["trans_id"]}],"irow"],"on",["inv.id","=","irow.trans_id"]],["fieldvalue af","on",[["ln.id","=","af.ref_id"],["and","af.fieldname","=","'link_qty'"]]],["fieldvalue rf","on",[["ln.id","=","rf.ref_id"],["and","rf.fieldname","=","'link_rate'"]]]],left_join:[["ui_message mst","on",[["mst.fieldname","=","tg.groupvalue"],["and","mst.secname","=","'transtype'"],["and","mst.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]],["ui_message msd","on",[["msd.fieldname","=","dg.groupvalue"],["and","msd.secname","=","'direction'"],["and","msd.lang","=",[{select:["value"],from:"fieldvalue",where:["fieldname","=","'default_lang'"]}]]]]],where:[["ln.deleted","=","0"],["and","ln.nervatype_1","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'payment'"]]}]],["and","ln.nervatype_2","=",[{select:["id"],from:"groups",where:[["groupname","=","'nervatype'"],["and","groupvalue","=","'trans'"]]}]]]}}}}}},v=r(4925),y=(r(2580),"Server_modal__CRk+4"),h="Server_dialog__z0hsD",w="Server_panel__Hfwmc",b="Server_panelTitle__mw0M3",E="Server_closeIcon__7EMdT",C=r(8907),T=r(4721),S=r(5750),A=r(8025),q=r(6417),j=["cmd","fields","values","className","getText","onClose","onOK"],x=function(e){var t=e.cmd,r=e.fields,n=e.values,l=e.className,i=e.getText,d=e.onClose,p=e.onOK,c=(0,v.Z)(e,j),f=(0,u.useState)((0,s.Z)({},n)),m=(0,o.Z)(f,2),g=m[0],_=m[1];return(0,q.jsx)("div",{className:"modal".concat(" ",y),children:(0,q.jsx)("div",(0,s.Z)((0,s.Z)({className:"dialog".concat(" ",h)},c),{},{children:(0,q.jsxs)("div",{className:"".concat(w," ").concat(l),children:[(0,q.jsx)("div",{className:"".concat(b," ","primary"),children:(0,q.jsxs)("div",{className:"row full",children:[(0,q.jsx)("div",{className:"cell",children:(0,q.jsx)(C.Z,{value:t.description,leftIcon:(0,q.jsx)(S.Z,{iconKey:"Share"}),iconWidth:"20px"})}),(0,q.jsx)("div",{className:"cell align-right".concat(" ",E),children:(0,q.jsx)(S.Z,{id:"closeIcon",iconKey:"Times",onClick:d})})]})}),r.map((function(e,t){return(0,q.jsx)(A.Z,{row:{rowtype:"field",name:e.fieldname,datatype:e.fieldtypeName,label:e.description},values:(0,s.Z)({},g),options:{},data:{audit:"all",current:{},dataset:{}},onEdit:function(e){return _((0,s.Z)((0,s.Z)({},g),{},(0,a.Z)({},e.name,e.value)))},getText:i},t)})),(0,q.jsx)("div",{className:"row full section container-small secondary-title",children:(0,q.jsxs)("div",{className:"row full",children:[(0,q.jsx)("div",{className:"cell padding-small half",children:(0,q.jsx)(T.Z,{id:"btn_cancel",className:"full".concat(" ",E," "),onClick:function(){return d()},value:(0,q.jsx)(C.Z,{center:!0,value:i("msg_cancel"),leftIcon:(0,q.jsx)(S.Z,{iconKey:"Times"}),iconWidth:"20px"})})}),(0,q.jsx)("div",{className:"cell padding-small half",children:(0,q.jsx)(T.Z,{id:"btn_ok",className:"full primary",onClick:function(){return p({cmd:t,fields:r,values:(0,s.Z)({},g)})},value:(0,q.jsx)(C.Z,{center:!0,value:i("msg_ok"),leftIcon:(0,q.jsx)(S.Z,{iconKey:"Check"}),iconWidth:"20px"})})})]})})]})}))})};x.defaultProps={cmd:{},fields:[],values:{},className:"",getText:void 0,onClose:void 0,onOK:void 0};var X=x,F=r(9820),P="Total_modal__ZfPrW",M="Total_dialog__zVKQm",k="Total_panel__PRPib",Z="Total_panelTitle__jDcIJ",N="Total_closeIcon__AvaO2",D="Total_maxInput__SN0wR",O=r(6360),I=["total","className","getText","onClose"],L=function(e){var t=e.total,r=e.className,n=e.getText,a=e.onClose,l=(0,v.Z)(e,I);return(0,q.jsx)("div",{className:"modal".concat(" ",P),children:(0,q.jsx)("div",(0,s.Z)((0,s.Z)({className:"dialog".concat(" ",M)},l),{},{children:(0,q.jsxs)("div",{className:"".concat(k," ").concat(r),children:[(0,q.jsx)("div",{className:"".concat(Z," ","primary"),children:(0,q.jsxs)("div",{className:"row full",children:[(0,q.jsx)("div",{className:"cell",children:(0,q.jsx)(C.Z,{value:n("browser_total"),leftIcon:(0,q.jsx)(S.Z,{iconKey:"InfoCircle"}),iconWidth:"20px"})}),(0,q.jsx)("div",{className:"cell align-right".concat(" ",N),children:(0,q.jsx)(S.Z,{id:"closeIcon",iconKey:"Times",onClick:a})})]})}),(0,q.jsx)("div",{className:"row full container section-small",children:Object.keys(t.totalFields).map((function(e){return(0,q.jsxs)("div",{className:"row full mobile",children:[(0,q.jsx)("div",{className:"cell bold padding-tiny",children:(0,q.jsx)(C.Z,{className:"bold",value:t.totalLabels[e]})}),(0,q.jsx)("div",{className:"cell padding-tiny right mobile",children:(0,q.jsx)(O.Z,{className:"align-right bold".concat(" ",D),value:(r=t.totalFields[e],r.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")),disabled:"disabled"})})]},e);var r}))}),(0,q.jsx)("div",{className:"row full section container-small secondary-title",children:(0,q.jsx)("div",{className:"row full",children:(0,q.jsx)("div",{className:"cell padding-small",children:(0,q.jsx)(T.Z,{id:"btn_ok",className:"full primary",onClick:a,value:(0,q.jsx)(C.Z,{center:!0,value:n("msg_ok"),leftIcon:(0,q.jsx)(S.Z,{iconKey:"Check"}),iconWidth:"20px"})})})})})]})}))})};L.defaultProps={total:{totalFields:{},totalLabels:{},count:0},className:"",getText:void 0,onClose:void 0};var K=L,$=r(4848),V="Search_sidebar__yYTHb",B="Search_separator__iTW8q",R="Search_panelGroup__WVR7s",W="Search_panelButton__8Dcr4",z="Search_selectButton__Sl-B6",H="Search_groupButton__4Jq6e",J=["side","groupKey","auditFilter","className","getText","onEvent"],U=function(e){var t=e.side,r=e.groupKey,n=e.auditFilter,a=e.className,l=e.getText,o=e.onEvent,i=(0,v.Z)(e,J),d=function(e){return e===r?z:H},u=function(e){return(0,q.jsxs)("div",{className:"row full",children:[(0,q.jsx)(T.Z,{id:"btn_group_"+e,className:"full medium".concat(" ",d(e)),onClick:function(){return o("changeData",["group_key",e])},value:(0,q.jsx)(C.Z,{value:l("search_"+e),leftIcon:(0,q.jsx)(S.Z,{iconKey:"FileText"}),iconWidth:"20px"})}),r===e?(0,q.jsxs)("div",{className:"row full".concat(" ",R),children:[(0,q.jsx)(T.Z,{id:"btn_view_"+e,className:"full medium".concat(" ",W),onClick:function(){return o("quickView",[e])},value:(0,q.jsx)(C.Z,{value:l("quick_search"),leftIcon:(0,q.jsx)(S.Z,{iconKey:"Bolt"}),iconWidth:"20px"})}),(0,q.jsx)(T.Z,{id:"btn_browser_"+e,className:"full medium".concat(" ",W),onClick:function(){return o("showBrowser",[e])},value:(0,q.jsx)(C.Z,{value:l("browser_"+e),leftIcon:(0,q.jsx)(S.Z,{iconKey:"Search"}),iconWidth:"20px"})})]}):null]},e)};return(0,q.jsxs)("div",(0,s.Z)((0,s.Z)({},i),{},{className:"".concat(V," ").concat("auto"!==t?t:""," ").concat(a),children:[u("transitem"),"disabled"!==n.trans.bank[0]||"disabled"!==n.trans.cash[0]?u("transpayment"):null,"disabled"!==n.trans.delivery[0]||"disabled"!==n.trans.inventory[0]||"disabled"!==n.trans.waybill[0]||"disabled"!==n.trans.production[0]||"disabled"!==n.trans.formula[0]?u("transmovement"):null,(0,q.jsx)("div",{className:B}),["customer","product","employee","tool","project"].map((function(e){return"disabled"!==n[e][0]?u(e):null})),(0,q.jsx)("div",{className:B}),(0,q.jsx)(T.Z,{id:"btn_report",className:"full medium".concat(" ",d("report")),onClick:function(){o("changeData",["group_key","report"]),o("quickView",["report"])},value:(0,q.jsx)(C.Z,{value:l("search_report"),leftIcon:(0,q.jsx)(S.Z,{iconKey:"ChartBar"}),iconWidth:"20px"})}),(0,q.jsx)(T.Z,{id:"btn_office",className:"full medium".concat(" ",d("office")),onClick:function(){return o("changeData",["group_key","office"])},value:(0,q.jsx)(C.Z,{value:l("search_office"),leftIcon:(0,q.jsx)(S.Z,{iconKey:"Inbox"}),iconWidth:"20px"})}),"office"===r?(0,q.jsxs)("div",{className:"row full".concat(" ",R),children:[(0,q.jsx)(T.Z,{id:"btn_printqueue",className:"full medium primary".concat(" ",W),onClick:function(){return o("checkEditor",[{ntype:"printqueue",ttype:null,id:null}])},value:(0,q.jsx)(C.Z,{value:l("title_printqueue"),leftIcon:(0,q.jsx)(S.Z,{iconKey:"Print"}),iconWidth:"20px"})}),(0,q.jsx)(T.Z,{id:"btn_rate",className:"full medium primary".concat(" ",W),onClick:function(){return o("showBrowser",["rate"])},value:(0,q.jsx)(C.Z,{value:l("title_rate"),leftIcon:(0,q.jsx)(S.Z,{iconKey:"Globe"}),iconWidth:"20px"})}),(0,q.jsx)(T.Z,{id:"btn_servercmd",className:"full medium primary".concat(" ",W),onClick:function(){return o("quickView",["servercmd"])},value:(0,q.jsx)(C.Z,{value:l("title_servercmd"),leftIcon:(0,q.jsx)(S.Z,{iconKey:"Share"}),iconWidth:"20px"})})]}):null]}))};U.defaultProps={side:"auto",groupKey:"",auditFilter:{},className:"",onEvent:void 0,getText:void 0};var Q=U,Y=r(6946),G="Browser_panel__AOoYh",ee="Browser_panelTitle__QmMQW",te="Browser_barButton__xYmn9",re="Browser_selected__m24+A",ne="Browser_dropdownBox__p7kmr",ae="Browser_filterDelete__ydCY5",le="Browser_dropdownContent__0eiNy",se="Browser_dropItem__D2PVM",oe="Browser_active__5c8YO",ie="Browser_filterPanel__n+Efn",de="Browser_resultTitle__WI0Se",ue="Browser_resultTitlePlus__0ZkOb",pe="Browser_editCol__ho6vv",ce="Browser_colBox__I07PX",fe="Browser_selectCol__rwUQp",me=r(1012),ge=r(3331),_e=r(8470),ve=["data","keyMap","viewDef","className","paginationPage","dateFormat","timeFormat","filter_opt_1","filter_opt_2","getText","onEvent"],ye=function(e){var t=e.data,r=e.keyMap,n=e.viewDef,l=e.className,i=e.paginationPage,d=e.dateFormat,p=e.timeFormat,f=e.filter_opt_1,m=e.filter_opt_2,g=e.getText,_=e.onEvent,y=(0,v.Z)(e,ve),h=t.vkey,w=t.view,b=t.show_header,E=t.show_dropdown,A=t.show_columns,j=t.result,x=t.columns,X=t.filters,F=t.deffield,P=t.page,M=(0,u.useState)({dropdown:E,header:b,columns:A}),k=(0,o.Z)(M,2),Z=k[0],N=k[1],D={view:{columnDef:{id:"view",Header:"",headerStyle:{},Cell:function(e){var t=e.row;e.value;return n.readonly?(0,q.jsx)(S.Z,{iconKey:"CaretRight",width:9,height:24}):(0,q.jsx)(S.Z,{id:"edit_"+t.original.id,iconKey:"Edit",width:24,height:21.3,onClick:function(){return _("onEdit",["id",t.original.id,t.original])},className:pe})},cellStyle:{width:25,padding:"7px 3px 3px 8px"}}}};Object.keys(n.fields).forEach((function(e){if(x[w][e])switch(n.fields[e].fieldtype){case"float":case"integer":D=c()(D,{$merge:(0,a.Z)({},e,{fieldtype:"number",label:n.fields[e].label})});break;case"bool":D=c()(D,{$merge:(0,a.Z)({},e,{fieldtype:"bool",label:n.fields[e].label})});break;default:D="deffield_value"===e?c()(D,{$merge:(0,a.Z)({},e,{fieldtype:"deffield",label:n.fields[e].label})}):c()(D,{$merge:(0,a.Z)({},e,{fieldtype:"string",label:n.fields[e].label})})}}));var I=function(){var e={};return Object.keys(n.fields).filter((function(e){return!0===x[w][e]})).forEach((function(t){e[t]=n.fields[t]})),e},L=function(e,t){var r={totalFields:{},totalLabels:{},count:0};return t&&Object.keys(e).includes("deffield_value")?t.filter((function(e){return"integer"===e.fieldtype||"float"===e.fieldtype})).forEach((function(e){r=c()(r,{totalFields:{$merge:(0,a.Z)({},e.fieldname,0)},totalLabels:{$merge:(0,a.Z)({},e.fieldname,e.description)}})})):Object.keys(e).filter((function(t){return("integer"===e[t].fieldtype||"float"===e[t].fieldtype)&&"avg"!==e[t].calc})).forEach((function(t){r=c()(r,{totalFields:{$merge:(0,a.Z)({},t,0)},totalLabels:{$merge:(0,a.Z)({},t,e[t].label)}})})),r=c()(r,{$merge:{count:Object.keys(r.totalFields).length}})}(n.fields,F);return(0,q.jsx)("div",(0,s.Z)((0,s.Z)({},y),{},{className:"".concat(l),onClick:function(e){N((0,s.Z)((0,s.Z)({},Z),{},{dropdown:!1}))},children:(0,q.jsxs)("div",{className:"".concat(G),children:[(0,q.jsx)("div",{className:"".concat(ee," ","primary"),children:(0,q.jsx)(C.Z,{value:g("browser_"+h)})}),(0,q.jsxs)("div",{className:"section container",children:[(0,q.jsx)("div",{className:"row full",children:(0,q.jsx)("div",{className:"cell",children:(0,q.jsx)(T.Z,{id:"btn_header",className:"full primary",onClick:function(e){e.stopPropagation(),_("changeData",["show_header",!Z.header]),N((0,s.Z)((0,s.Z)({},Z),{},{header:!Z.header}))},value:(0,q.jsx)(C.Z,{value:n.label,leftIcon:(0,q.jsx)(S.Z,{iconKey:"Filter"})})})})}),Z.header?(0,q.jsxs)("div",{className:"".concat(ie," ","border"),children:[(0,q.jsxs)("div",{className:"row full",children:[(0,q.jsx)("div",{className:"cell top",children:(0,q.jsx)(T.Z,{id:"btn_search",className:"border-button".concat(" ",te),onClick:function(){return _("browserView",[])},value:(0,q.jsx)(C.Z,{className:"hide-small",value:g("browser_search"),leftIcon:(0,q.jsx)(S.Z,{iconKey:"Search",height:18,width:18})})})}),(0,q.jsxs)("div",{className:"cell align-right",children:[(0,q.jsx)(T.Z,{id:"btn_bookmark",className:"border-button small-button".concat(" ",te),onClick:function(){return _("bookmarkSave",[])},value:(0,q.jsx)(C.Z,{value:g("browser_bookmark"),leftIcon:(0,q.jsx)(S.Z,{iconKey:"Star",height:14,width:15.75})})}),(0,q.jsx)(T.Z,{id:"btn_export",className:"border-button small-button".concat(" ",te),disabled:0===j.length?"disabled":"",onClick:function(){return _("exportResult",[I()])},value:(0,q.jsx)(C.Z,{value:g("browser_export"),leftIcon:(0,q.jsx)(S.Z,{iconKey:"Download",height:14,width:14})})}),(0,q.jsx)(T.Z,{id:"btn_help",className:"border-button small-button".concat(" ",te),onClick:function(){return _("showHelp",["program/browser"])},value:(0,q.jsx)(C.Z,{value:g("browser_help"),leftIcon:(0,q.jsx)(S.Z,{iconKey:"QuestionCircle",height:14,width:14})})})]})]}),(0,q.jsx)("div",{className:"row full section-small-top",children:(0,q.jsxs)("div",{className:"cell",children:[(0,q.jsxs)("div",{className:"".concat(ne),children:[(0,q.jsx)(T.Z,{id:"btn_views",className:"border-button".concat(" ",te," ").concat(Z.dropdown?re:""),onClick:function(e){e.stopPropagation(),N((0,s.Z)((0,s.Z)({},Z),{},{dropdown:!Z.dropdown}))},value:(0,q.jsx)(C.Z,{className:"hide-small",value:g("browser_views"),leftIcon:(0,q.jsx)(S.Z,{iconKey:"Eye",height:18,width:20.25})})}),Z.dropdown?(0,q.jsx)("div",{className:"".concat(le," ","border dialog"),children:Object.keys(r).map((function(e,t){return"options"!==e?(0,q.jsx)("div",{id:"view_"+e,onClick:function(){return _("showBrowser",[h,e])},className:"".concat(se," ").concat(e===w?oe:null),children:(0,q.jsx)(C.Z,{value:r[e].label,leftIcon:e===w?(0,q.jsx)(S.Z,{iconKey:"Check"}):(0,q.jsx)(S.Z,{iconKey:"Eye"})})},t):null}))}):null]}),(0,q.jsx)(T.Z,{id:"btn_columns",className:"border-button".concat(" ",te),onClick:function(e){e.stopPropagation(),_("changeData",["show_columns",!Z.columns]),N((0,s.Z)((0,s.Z)({},Z),{},{columns:!Z.columns}))},value:(0,q.jsx)(C.Z,{className:"hide-small",value:g("browser_columns"),leftIcon:(0,q.jsx)(S.Z,{iconKey:"Columns",height:18,width:18})})}),(0,q.jsx)(T.Z,{id:"btn_filter",className:"border-button".concat(" ",te),onClick:function(){return _("addFilter",[])},value:(0,q.jsx)(C.Z,{className:"hide-small",value:g("browser_filter"),leftIcon:(0,q.jsx)(S.Z,{iconKey:"Plus",height:18,width:15.75})})}),(0,q.jsx)(T.Z,{id:"btn_total",className:"border-button".concat(" ",te),disabled:0===L.count||0===j.length?"disabled":"",onClick:function(){return _("showTotal",[n.fields,L])},value:(0,q.jsx)(C.Z,{className:"hide-small",value:g("browser_total"),leftIcon:(0,q.jsx)(S.Z,{iconKey:"InfoCircle",height:18,width:18})})})]})}),Z.columns?(0,q.jsx)("div",{className:"".concat(ce," ","border"),children:Object.keys(n.fields).map((function(e){return(0,q.jsx)("div",{id:"col_"+e,className:"cell padding-tiny tiny left".concat(" \n                  ",!0===x[w][e]?fe:pe),onClick:function(){return _("setColumns",[e,!(!0===x[w][e])])},children:(0,q.jsx)(C.Z,{value:n.fields[e].label,leftIcon:!0===x[w][e]?(0,q.jsx)(S.Z,{iconKey:"CheckSquare"}):(0,q.jsx)(S.Z,{iconKey:"SquareEmpty"})})},e)}))}):null,X[w].map((function(e,t){return(0,q.jsxs)("div",{className:"section-small-top",children:[(0,q.jsx)("div",{className:"cell",children:(0,q.jsx)(ge.Z,{id:"filter_name_"+t,value:e.fieldname,onChange:function(e){return _("editFilter",[t,"fieldname",e])},options:Object.keys(n.fields).filter((function(e){return"id"!==e&&"_id"!==e})).flatMap((function(e){return"deffield_value"===e?F.map((function(e){return{value:e.fieldname,text:g(e.fieldname,e.description)}})):{value:e,text:n.fields[e].label}}))})}),(0,q.jsx)("div",{className:"cell",children:(0,q.jsx)(ge.Z,{id:"filter_type_"+t,value:e.filtertype,onChange:function(e){return _("editFilter",[t,"filtertype",e])},options:(["date","float","integer"].includes(e.fieldtype)?m:f).map((function(e){return{value:e[0],text:e[1]}}))})}),(0,q.jsxs)("div",{className:"cell mobile",children:["==N"!==e.filtertype?(0,q.jsxs)("div",{className:"cell",children:["bool"===e.fieldtype?(0,q.jsx)(ge.Z,{id:"filter_value_"+t,value:e.value,onChange:function(e){return _("editFilter",[t,"value",e])},options:[{value:"0",text:g("label_no")},{value:"1",text:g("label_yes")}]}):null,"integer"===e.fieldtype||"float"===e.fieldtype?(0,q.jsx)(O.Z,{id:"filter_value_"+t,value:e.value,onChange:function(e){return _("editFilter",[t,"value",e])},type:"float"===e.fieldtype?"number":e.fieldtype,className:"align-right"}):null,"date"===e.fieldtype?(0,q.jsx)(_e.Z,{id:"filter_value_"+t,value:e.value,dateTime:!1,isEmpty:!1,onChange:function(e){return _("editFilter",[t,"value",e])}}):null,"string"===e.fieldtype?(0,q.jsx)(O.Z,{id:"filter_value_"+t,value:e.value,onChange:function(e){return _("editFilter",[t,"value",e])}}):null]}):null,(0,q.jsx)("div",{className:"cell",children:(0,q.jsx)(T.Z,{id:"btn_delete_filter_"+t,className:" ".concat("border-button"," ",ae),onClick:function(){return _("deleteFilter",[t])},value:(0,q.jsx)(S.Z,{iconKey:"Times"})})})]})]},t)}))]}):null,(0,q.jsx)("div",{className:"row full section-small-top",children:(0,q.jsxs)("div",{className:"row full border",children:[(0,q.jsxs)("div",{className:"cell".concat(" ",de),children:[j.length," ",(0,q.jsx)(C.Z,{value:g("browser_result")})]}),n.actions_new?(0,q.jsx)("div",{className:"cell".concat(" ",ue),children:(0,q.jsx)(T.Z,{id:"btn_actions_new",className:"small-button",onClick:function(){return _("setFormActions",[{params:n.actions_new,row:void 0}])},value:(0,q.jsx)(S.Z,{iconKey:"Plus"})})}):null]})}),(0,q.jsx)("div",{className:"row full",children:(0,q.jsx)(me.Z,{rowKey:"row_id",fields:D,rows:j,filterPlaceholder:g("placeholder_filter"),labelYes:g("label_yes"),labelNo:g("label_no"),dateFormat:d,timeFormat:p,paginationPage:i,paginationTop:!0,onEditCell:function(e,t,r){return _("onEdit",[e,t,r])},currentPage:P,onCurrentPage:function(e){return _("onPage",[e])}})})]})]})}))};ye.defaultProps={data:{vkey:"",view:"",show_header:!0,show_dropdown:!1,show_columns:!1,result:[],columns:{},filters:{},deffield:[],page:0},keyMap:{},viewDef:{fields:{},label:"",readonly:!1},paginationPage:(0,$.$8)("paginationPage"),dateFormat:(0,$.$8)("dateFormat"),timeFormat:(0,$.$8)("timeFormat"),filter_opt_1:(0,$.$8)("filter_opt_1"),filter_opt_2:(0,$.$8)("filter_opt_2"),className:"",onEvent:void 0,getText:void 0};var he=ye,we=function(e){var t=e.data,r=e.queries,n=e.quick,a=e.ui,l=e.login,s=e.current,o=e.onEvent,i=e.editRow,d=e.quickSearch,p=e.onPage,c=e.getText;return(0,q.jsxs)(u.Fragment,{children:[(0,q.jsx)(Q,{side:s.side,groupKey:t.group_key,auditFilter:l.audit_filter,onEvent:o,getText:c}),(0,q.jsx)("div",{className:"page padding-normal".concat(" ",s.theme),children:"browser"===t.seltype?(0,q.jsx)(he,{id:"browser_"+t.vkey,data:t,keyMap:r[t.vkey](),viewDef:r[t.vkey]()[t.view],paginationPage:a.paginationPage,dateFormat:a.dateFormat,timeFormat:a.timeFormat,filter_opt_1:a.filter_opt_1,filter_opt_2:a.filter_opt_2,onEvent:o,getText:c}):(0,q.jsx)(Y.default,{id:"selector_"+t.qview,className:"margin0",view:t.qview,columns:n[t.qview]().columns,result:t.result,filter:t.qfilter,currentPage:t.page,onCurrentPage:p,getText:c,onClose:null,onSelect:i,onSearch:d})})]})};we.defaultProps={data:(0,s.Z)((0,s.Z)({},he.defaultProps.data),{},{qview:"",qfilter:""}),current:{},queries:{},quick:{},ui:{},login:{},onEvent:void 0,editRow:void 0,quickSearch:void 0,onPage:void 0,getText:void 0};var be=(0,u.memo)(we,(function(e,t){return e.data===t.data&&e.current.side===t.current.side&&e.data.update===t.data.update})),Ee=function(e){var t=(0,u.useContext)(f.ZP),r=t.data,i=t.setData,p=function(e,t){var r=(0,m.xZ)(e,t),l=_({getText:r.getText});return{defaultFilterValue:function(e){return"date"===e?(0,g.Z)(new Date,{representation:"date"}):["bool","integer","float"].includes(e)?0:""},getFilterWhere:function(e){switch(e.filtertype){case"==N":return"string"===e.fieldtype?["and",[[e.sqlstr,"like","''"],["or",e.sqlstr,"is null"]]]:["and",e.sqlstr,"is null"];case"!==":return"string"===e.fieldtype?["and",["lower("+e.sqlstr+")","not like","{CCS}{JOKER}{SEP}lower(?){SEP}{JOKER}{CCE}"]]:["and",[e.sqlstr,"<>","?"]];case">==":return["and",[e.sqlstr,">=","?"]];case"<==":return["and",[e.sqlstr,"<=","?"]];default:return"string"===e.fieldtype?["and",["lower("+e.sqlstr+")","like","{CCS}{JOKER}{SEP}lower(?){SEP}{JOKER}{CCE}"]]:["and",[e.sqlstr,"=","?"]]}},showBrowser:function(s,o,i){i=i||e.search,t("current",{side:"hide"},(0,n.Z)(d().mark((function n(){var u,p,f,g,_,v,y,h,w;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return u=c()(i,{$merge:{seltype:"browser",vkey:s,view:"undefined"===typeof o?Object.keys(l[s]())[1]:o,result:[],deffield:[],show_dropdown:!1,show_header:"undefined"===typeof i.show_header||i.show_header,show_columns:"undefined"!==typeof i.show_columns&&i.show_columns,page:i.page||0}}),p=[{key:"deffield",text:(0,m.aT)(e.login.data.engine,l[s]().options.deffield_sql).sql,values:[]}],f={method:"POST",data:p},n.next=5,r.requestData("/view",f);case 5:if(!(g=n.sent).error){n.next=8;break}return n.abrupt("return",r.resultError(g));case 8:if((u=c()(u,{$merge:{deffield:g.deffield}})).filters[u.view]||(u=c()(u,{filters:{$merge:(0,a.Z)({},u.view,[])}})),_=l[s]()[u.view],"undefined"===typeof u.columns[u.view])for(u=c()(u,{columns:{$merge:(0,a.Z)({},u.view,{})}}),v=0;v<Object.keys(_.columns).length;v++)y=Object.keys(_.columns)[v],u=c()(u,{columns:(0,a.Z)({},u.view,{$merge:(0,a.Z)({},y,_.columns[y])})});if(0===Object.keys(u.columns[u.view]).length)for(h=0;h<3;h++)w=Object.keys(_.fields)[h],u=c()(u,{columns:(0,a.Z)({},u.view,{$merge:(0,a.Z)({},w,!0)})});t("search",u),t("current",{module:"search"});case 15:case"end":return n.stop()}}),n)}))))},showServerCmd:function(a){var l=e.login.data.menuCmds.filter((function(e){return e.id===parseInt(a,10)}))[0];if(l){var o=e.login.data.menuFields.filter((function(e){return e.menu_id===parseInt(a,10)})),i=c()({},{$set:{cmd:l,fields:o,values:{}}});o.forEach((function(e){switch(e.fieldtypeName){case"bool":i.values[e.fieldname]=!1;break;case"float":case"integer":i.values[e.fieldname]=0;break;default:i.values[e.fieldname]=""}})),t("current",{modalForm:(0,q.jsx)(X,(0,s.Z)((0,s.Z)({},i),{},{getText:r.getText,onClose:function(){t("current",{modalForm:null})},onOK:function(a){t("current",{modalForm:null},(0,n.Z)(d().mark((function t(){var n,l,s,o,i,u;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=new URLSearchParams,l=c()({},{$set:a.values}),a.fields.forEach((function(e){"bool"===e.fieldtypeName?(n.append(e.fieldname,a.values[e.fieldname]?1:0),l[e.fieldname]=a.values[e.fieldname]?1:0):n.append(e.fieldname,a.values[e.fieldname])})),"get"!==a.cmd.methodName){t.next=9;break}""===(s=a.cmd.address||"")&&a.cmd.funcname&&""!==a.cmd.funcname&&(s="SERVER"===e.session.serverURL?e.session.proxy+e.session.apiPath+"/"+a.cmd.funcname:e.login.server+"/"+a.cmd.funcname),""!==s&&window.open(s+"?"+n.toString(),"_system"),t.next=32;break;case 9:if(o={key:a.cmd.funcname||a.cmd.menukey,values:l},!a.cmd.address||""===a.cmd.address){t.next=23;break}return t.prev=11,t.next=14,(0,m.WY)(a.cmd.address,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});case 14:i=t.sent,t.next=21;break;case 17:return t.prev=17,t.t0=t.catch(11),r.resultError(t.t0),t.abrupt("return",null);case 21:t.next=26;break;case 23:return t.next=25,r.requestData("/function",{method:"POST",data:o});case 25:i=t.sent;case 26:if(!i.error){t.next=29;break}return r.resultError(i),t.abrupt("return",null);case 29:u=i,"object"===typeof i&&(u=JSON.stringify(i,null,"  ")),r.showToast({type:"success",title:r.getText("ms_server_response"),message:u});case 32:case"end":return t.stop()}}),t,null,[[11,17]])}))))}}))})}}}}(r,i),v=(0,m.xZ)(r,i),y=(0,u.useState)(c()(e,{$merge:{engine:r.login.data.engine,login:r.login.data,queries:_({getText:v.getText}),quick:(0,F.Quick)({getText:v.getText}),ui:(0,$.$8)("ui"),showHelp:v.showHelp}})),h=(0,o.Z)(y,1)[0];return h.data=c()(h.data,{$merge:(0,s.Z)({},r[h.key])}),h.current=c()(h.current,{$merge:(0,s.Z)({},r.current)}),(0,u.useEffect)((function(){if(h.current&&h.current.content){var e=h.current.content;i("current",{content:null},(function(){p.showBrowser.apply(p,(0,l.Z)(e))}))}}),[i,p,h]),h.getText=function(e,t){return v.getText(e,t)},h.onEvent=function(e,t){h[e].apply(h,(0,l.Z)(t))},h.checkEditor=function(e){i("current",{module:"edit",content:e})},h.quickView=function(e){i(h.key,{seltype:"selector",result:[],qview:e,qfilter:"",page:0}),i("current",{side:"hide"})},h.editRow=function(e,t){var r=e.id.split("/"),n=c()({},{$set:{ntype:r[0],ttype:r[1],id:parseInt(r[2],10),item:e}});"servercmd"===n.ntype?p.showServerCmd(n.id):i("current",{module:"edit",content:n})},h.setFormActions=function(e){e.nextKey="FORM_ACTIONS",i("current",{module:"edit",content:e})},h.onEdit=function(e,t,r){var n=t.split("/"),a=c()({},{$set:{ntype:n[0],ttype:n[1],id:n[2]}});"id"===e&&(a=c()(a,{$merge:{form:r.form,form_id:r.form_id}})),i("current",{module:"edit",content:a})},h.onPage=function(e){i(h.key,{page:e})},h.changeData=function(e,t){i(h.key,(0,a.Z)({},e,t))},h.setColumns=function(e,t){var r=c()(h.data.columns,{});t?r=c()(r,(0,a.Z)({},h.data.view,{$merge:(0,a.Z)({},e,!0)})):(delete r[h.data.view][e],r=c()(r,{$merge:(0,a.Z)({},h.data.view,r[h.data.view])})),i(h.key,{columns:r,update:(new Date).getTime()})},h.addFilter=function(){var e=h.queries[h.data.vkey]()[h.data.view],t=e.fields[Object.keys(e.fields)[0]],r=c()(h.data.filters,{});r=c()(r,(0,a.Z)({},h.data.view,{$push:[{id:(new Date).getTime().toString(),fieldtype:t.fieldtype,fieldname:Object.keys(e.fields)[0],sqlstr:t.sqlstr,wheretype:t.wheretype,filtertype:"===",value:p.defaultFilterValue(t.fieldtype)}]})),i(h.key,{filters:r})},h.deleteFilter=function(e){var t=c()(h.data.filters,{});t=c()(t,(0,a.Z)({},h.data.view,{$splice:[[e,1]]})),i(h.key,{filters:t})},h.editFilter=function(e,t,r){var n=h.queries[h.data.vkey]()[h.data.view],l=c()(h.data.filters,{});if("filtertype"!==t&&"value"!==t||(l=c()(l,(0,a.Z)({},h.data.view,(0,a.Z)({},e,{$merge:(0,a.Z)({},t,r)})))),"fieldname"===t)if(Object.keys(n.fields).includes(r)){var s=n.fields[r];l=c()(l,(0,a.Z)({},h.data.view,(0,a.Z)({},e,{$merge:{fieldname:r,fieldtype:s.fieldtype,sqlstr:s.sqlstr,wheretype:s.wheretype,filtertype:"===",value:p.defaultFilterValue(s.fieldtype)}})))}else{var o=h.data.deffield.filter((function(e){return e.fieldname===r}))[0],d={bool:{fieldtype:"bool",sqlstr:"fg.groupvalue='bool' and case when fv.value='true' then 1 else 0 end "},integer:{fieldtype:"integer",sqlstr:"fg.groupvalue='integer' and {FMSF_NUMBER} {CAS_INT}fv.value {CAE_INT} {FMEF_CONVERT} "},float:{fieldtype:"float",sqlstr:"fg.groupvalue='float' and {FMSF_NUMBER} {CAS_FLOAT}fv.value {CAE_FLOAT} {FMEF_CONVERT} "},date:{fieldtype:"date",sqlstr:"fg.groupvalue='date' and {FMSF_DATE} {CASF_DATE}fv.value{CAEF_DATE} {FMEF_CONVERT} "},customer:{fieldtype:"string",sqlstr:"rf_customer.custname "},tool:{fieldtype:"string",sqlstr:"rf_tool.serial "},product:{fieldtype:"string",sqlstr:"rf_product.partnumber "},trans:{fieldtype:"string",sqlstr:"rf_trans.transnumber "},transitem:{fieldtype:"string",sqlstr:"rf_trans.transnumber "},transmovement:{fieldtype:"string",sqlstr:"rf_trans.transnumber "},transpayment:{fieldtype:"string",sqlstr:"rf_trans.transnumber "},project:{fieldtype:"string",sqlstr:"rf_project.pronumber "},employee:{fieldtype:"string",sqlstr:"rf_employee.empnumber "},place:{fieldtype:"string",sqlstr:"rf_place.planumber "}},u="string",f="fv.value ";d[o.fieldtype]&&(u=d[o.fieldtype].fieldtype,f=d[o.fieldtype].sqlstr),l=c()(l,(0,a.Z)({},h.data.view,(0,a.Z)({},e,{$merge:{fieldname:o.fieldname,fieldlimit:["and","fv.fieldname","=","'"+o.fieldname+"'"],fieldtype:u,sqlstr:f,wheretype:"where",filtertype:"===",value:""}})))}i(h.key,{filters:l})},h.showBrowser=function(e,t){p.showBrowser(e,t,h.data)},h.quickSearch=function(){var e=(0,n.Z)(d().mark((function e(t){var r;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.quickSearch(h.data.qview,t);case 2:if(!(r=e.sent).error){e.next=5;break}return e.abrupt("return",v.resultError(r));case 5:i(h.key,{result:r.result,qfilter:t,page:0});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h.browserView=(0,n.Z)(d().mark((function e(){var t,r,n,a,s,o,u,f;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=h.queries[h.data.vkey]()[h.data.view],r=c()({},{$set:t.sql}),n=[],a=[],h.data.filters[h.data.view].filter((function(e){return"where"===e.wheretype})).forEach((function(e){a.push(p.getFilterWhere(e)),"==N"!==e.filtertype&&n.push(e.value)})),a.length>0&&(r=c()(r,{where:{$push:(0,l.Z)(a)}})),a=[],h.data.filters[h.data.view].filter((function(e){return"having"===e.wheretype})).forEach((function(e){a.push(p.getFilterWhere(e)),"==N"!==e.filtertype&&n.push(e.value)})),a.length>0&&(r=c()(r,{having:{$push:(0,l.Z)(a)}})),(a=v.getDataFilter(h.data.vkey,[],h.data.view)).length>0&&(r=c()(r,{where:{$push:[a]}})),(s=v.getUserFilter(h.data.vkey)).where.length>0&&(r=c()(r,{where:{$push:s.where}}),n=n.concat(s.params)),o=[{key:"result",text:(0,m.aT)(h.engine,r).sql,values:n}],u={method:"POST",data:o},e.next=17,v.requestData("/view",u);case 17:if(!(f=e.sent).error){e.next=20;break}return e.abrupt("return",v.resultError(f));case 20:i(h.key,{result:f.result,dropdown:"",page:0});case 21:case"end":return e.stop()}}),e)}))),h.showTotal=function(e,t){var r=Object.keys(e).includes("deffield_value"),n=function(e){return isNaN(parseFloat(e))?0:parseFloat(e)};h.data.result.forEach((function(e){r?"undefined"!==typeof t.totalFields[e.fieldname]&&(t=c()(t,{totalFields:{$merge:(0,a.Z)({},e.fieldname,t.totalFields[e.fieldname]+n(e.export_deffield_value))}})):Object.keys(t.totalFields).forEach((function(r){t="undefined"!==typeof e["export_"+r]?c()(t,{totalFields:{$merge:(0,a.Z)({},r,t.totalFields[r]+n(e["export_"+r]))}}):c()(t,{totalFields:{$merge:(0,a.Z)({},r,t.totalFields[r]+n(e[r]))}})}))})),i("current",{modalForm:(0,q.jsx)(K,{total:t,getText:v.getText,onClose:function(){i("current",{modalForm:null})}})})},h.exportResult=function(e){var t=h.data.view+".csv",r="",n=Object.keys(e).map((function(t){return e[t].label}));r+=n.join(h.ui.export_sep)+"\n",h.data.result.forEach((function(t){var n=Object.keys(e).map((function(e){return"undefined"!=typeof t["export_"+e]?t["export_"+e]:t[e]}));r+=n.join(h.ui.export_sep)+"\n"}));var a=URL.createObjectURL(new Blob([r],{type:"text/csv;charset=utf-8;"}));(0,m.GX)(a,t)},h.bookmarkSave=function(){v.saveBookmark(["browser",h.queries[r.search.vkey]()[r.search.view].label])},(0,q.jsx)(be,(0,s.Z)({},h))};Ee.defaultProps=(0,s.Z)((0,s.Z)({key:"search"},we.defaultProps),{},{showHelp:void 0,setFormActions:void 0,onEdit:void 0,changeData:void 0,setColumns:void 0,defaultFilterValue:void 0,addFilter:void 0,deleteFilter:void 0,editFilter:void 0,showBrowser:void 0,quickSearch:void 0,browserView:void 0,showTotal:void 0,exportResult:void 0,bookmarkSave:void 0});var Ce=Ee}}]);