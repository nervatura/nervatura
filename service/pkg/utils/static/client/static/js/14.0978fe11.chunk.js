(self.webpackChunknervatura_client=self.webpackChunknervatura_client||[]).push([[14],{5586:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return Dt}});var n=r(5861),a=r(4942),i=r(2982),s=r(1413),l=r(885),o=r(7757),c=r.n(o),u=r(7313),d=r(4754),p=r.n(d),m=r(7559),f=r(9155),v=r(5919),x=r(9004),g=r(3576),_=r(8502),y=r(241),h=r(6431),b=r.n(h),k=r(9206),j=r(5578),w=r(3421),Z=r(7112),T=r(4848),N=r(5468),E=r(4925),$=(r(2580),"Formula_modal__8CEPD"),q="Formula_dialog__7fDmm",I="Formula_panel__WIEk9",D="Formula_panelTitle__hm6vu",C="Formula_closeIcon__Q7rz8",O=r(8907),S=r(4721),F=r(6360),P=r(3331),K=r(5750),R=r(6417),L=["formula","formulaValues","partnumber","description","className","getText","onClose","onFormula"],A=function(e){var t=e.formula,r=e.formulaValues,n=e.partnumber,a=e.description,i=e.className,o=e.getText,c=e.onClose,d=e.onFormula,p=(0,E.Z)(e,L),m=(0,u.useState)({formula:t}),f=(0,l.Z)(m,2),v=f[0],x=f[1];return(0,R.jsx)("div",{className:"modal".concat(" ",$),children:(0,R.jsx)("div",(0,s.Z)((0,s.Z)({className:"dialog".concat(" ",q)},p),{},{children:(0,R.jsxs)("div",{className:"".concat(I," ").concat(i),children:[(0,R.jsx)("div",{className:"".concat(D," ","primary"),children:(0,R.jsxs)("div",{className:"row full",children:[(0,R.jsx)("div",{className:"cell",children:(0,R.jsx)(O.Z,{value:o("label_formula"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Magic"}),iconWidth:"20px"})}),(0,R.jsx)("div",{className:"cell align-right".concat(" ",C),children:(0,R.jsx)(K.Z,{id:"closeIcon",iconKey:"Times",onClick:c})})]})}),(0,R.jsxs)("div",{className:"row full container-small section-small",children:[(0,R.jsx)("div",{className:"row full",children:(0,R.jsxs)("div",{className:"cell padding-small",children:[(0,R.jsx)("div",{children:(0,R.jsx)(O.Z,{className:"bold",value:o("product_partnumber")})}),(0,R.jsx)(F.Z,{className:"full",value:n,disabled:"disabled"})]})}),(0,R.jsx)("div",{className:"row full",children:(0,R.jsx)("div",{className:"cell padding-small",children:(0,R.jsx)(F.Z,{className:"full",value:a,disabled:"disabled"})})}),(0,R.jsx)("div",{className:"row full",children:(0,R.jsx)("div",{className:"cell padding-small",children:(0,R.jsx)(P.Z,{id:"formula",className:"full",value:v.formula,placeholder:"",onChange:function(e){return x((0,s.Z)((0,s.Z)({},v),{},{formula:e}))},options:r})})})]}),(0,R.jsx)("div",{className:"row full section container-small secondary-title",children:(0,R.jsxs)("div",{className:"row full",children:[(0,R.jsx)("div",{className:"cell padding-small half",children:(0,R.jsx)(S.Z,{id:"btn_cancel",className:"full".concat(" ",C," "),disabled:""===v.formula?"disabled":"",onClick:function(){return c()},value:(0,R.jsx)(O.Z,{center:!0,value:o("msg_cancel"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Times"}),iconWidth:"20px"})})}),(0,R.jsx)("div",{className:"cell padding-small half",children:(0,R.jsx)(S.Z,{id:"btn_formula",className:"full primary",disabled:""===v.formula?"disabled":"",onClick:function(){return d(parseInt(v.formula,10))},value:(0,R.jsx)(O.Z,{center:!0,value:o("msg_ok"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Check"}),iconWidth:"20px"})})})]})})]})}))})};A.defaultProps={formula:"",formulaValues:[],partnumber:"",description:"",className:"",getText:void 0,onClose:void 0,onFormula:void 0};var W=A,M="Shipping_modal__TRC2h",U="Shipping_dialog__vOu01",z="Shipping_panel__uN5xj",V="Shipping_panelTitle__qxeY5",H="Shipping_closeIcon__SONGK",B=["partnumber","description","unit","batch_no","qty","className","getText","onClose","onShipping"],Q=function(e){var t=e.partnumber,r=e.description,n=e.unit,a=e.batch_no,i=e.qty,o=e.className,c=e.getText,d=e.onClose,p=e.onShipping,m=(0,E.Z)(e,B),f=(0,u.useState)({batch_no:a,qty:i}),v=(0,l.Z)(f,2),x=v[0],g=v[1];return(0,R.jsx)("div",{className:"modal".concat(" ",M),children:(0,R.jsx)("div",(0,s.Z)((0,s.Z)({className:"dialog".concat(" ",U)},m),{},{children:(0,R.jsxs)("div",{className:"".concat(z," ").concat(o),children:[(0,R.jsx)("div",{className:"".concat(V," ","primary"),children:(0,R.jsxs)("div",{className:"row full",children:[(0,R.jsx)("div",{className:"cell",children:(0,R.jsx)(O.Z,{value:c("shipping_movement_product"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Truck"}),iconWidth:"20px"})}),(0,R.jsx)("div",{className:"cell align-right".concat(" ",H),children:(0,R.jsx)(K.Z,{id:"closeIcon",iconKey:"Times",onClick:d})})]})}),(0,R.jsxs)("div",{className:"row full container-small section-small",children:[(0,R.jsx)("div",{className:"row full",children:(0,R.jsxs)("div",{className:"cell padding-small",children:[(0,R.jsx)("div",{children:(0,R.jsx)(O.Z,{className:"bold",value:c("product_partnumber")})}),(0,R.jsx)(F.Z,{className:"full",value:t,disabled:"disabled"})]})}),(0,R.jsx)("div",{className:"row full",children:(0,R.jsxs)("div",{className:"cell padding-small",children:[(0,R.jsx)("div",{children:(0,R.jsx)(O.Z,{className:"bold",value:c("product_description")})}),(0,R.jsx)(F.Z,{className:"full",value:r,disabled:"disabled"})]})}),(0,R.jsx)("div",{className:"row full",children:(0,R.jsxs)("div",{className:"cell padding-small",children:[(0,R.jsx)("div",{children:(0,R.jsx)(O.Z,{className:"bold",value:c("product_unit")})}),(0,R.jsx)(F.Z,{className:"full",value:n,disabled:"disabled"})]})}),(0,R.jsx)("div",{className:"row full",children:(0,R.jsxs)("div",{className:"cell padding-small",children:[(0,R.jsx)("div",{children:(0,R.jsx)(O.Z,{className:"bold",value:c("movement_batchnumber")})}),(0,R.jsx)(F.Z,{id:"batch_no",className:"full",value:x.batch_no,autoFocus:!0,onChange:function(e){return g((0,s.Z)((0,s.Z)({},x),{},{batch_no:e}))}})]})}),(0,R.jsx)("div",{className:"row full",children:(0,R.jsxs)("div",{className:"cell padding-small",children:[(0,R.jsx)("div",{children:(0,R.jsx)(O.Z,{className:"bold",value:c("movement_qty")})}),(0,R.jsx)(F.Z,{id:"qty",className:"full align-right",value:x.qty,type:"number",onChange:function(e){return g((0,s.Z)((0,s.Z)({},x),{},{qty:e}))}})]})})]}),(0,R.jsx)("div",{className:"row full section container-small secondary-title",children:(0,R.jsxs)("div",{className:"row full",children:[(0,R.jsx)("div",{className:"cell padding-small half",children:(0,R.jsx)(S.Z,{id:"btn_cancel",className:"full".concat(" ",H," "),onClick:function(){return d()},value:(0,R.jsx)(O.Z,{center:!0,value:c("msg_cancel"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Times"}),iconWidth:"20px"})})}),(0,R.jsx)("div",{className:"cell padding-small half",children:(0,R.jsx)(S.Z,{id:"btn_ok",className:"full primary",onClick:function(){return p(x.batch_no,parseFloat(x.qty))},value:(0,R.jsx)(O.Z,{center:!0,value:c("msg_ok"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Check"}),iconWidth:"20px"})})})]})})]})}))})};Q.defaultProps={partnumber:"",description:"",unit:"",batch_no:"",qty:0,className:"",getText:void 0,onClose:void 0,onShipping:void 0};var G=Q,X="Stock_modal__UXfV+",Y="Stock_dialog__1-OdF",J="Stock_panel__hE8yK",ee="Stock_panelTitle__CDq7X",te="Stock_closeIcon__VWhpa",re=r(1012),ne=["partnumber","partname","rows","selectorPage","className","onClose","getText"],ae=function(e){var t=e.partnumber,r=e.partname,n=e.rows,a=e.selectorPage,i=e.className,l=e.onClose,o=e.getText,c=(0,E.Z)(e,ne),u={warehouse:{fieldtype:"string",label:o("delivery_place")},batch_no:{fieldtype:"string",label:o("movement_batchnumber")},description:{fieldtype:"string",label:o("product_description")},sqty:{fieldtype:"number",label:o("shipping_stock")}};return(0,R.jsx)("div",{className:"modal".concat(" ",X),children:(0,R.jsx)("div",(0,s.Z)((0,s.Z)({className:"dialog".concat(" ",Y)},c),{},{children:(0,R.jsxs)("div",{className:"".concat(J," ").concat(i),children:[(0,R.jsx)("div",{className:"".concat(ee," ","primary"),children:(0,R.jsxs)("div",{className:"row full",children:[(0,R.jsx)("div",{className:"cell",children:(0,R.jsx)(O.Z,{value:o("shipping_stocks"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Book"}),iconWidth:"20px"})}),(0,R.jsx)("div",{className:"cell align-right".concat(" ",te),children:(0,R.jsx)(K.Z,{id:"closeIcon",iconKey:"Times",onClick:l})})]})}),(0,R.jsxs)("div",{className:"row full container-small section-small",children:[(0,R.jsx)("div",{className:"row full",children:(0,R.jsxs)("div",{className:"cell padding-small",children:[(0,R.jsx)("div",{children:(0,R.jsx)(O.Z,{className:"bold",value:t})}),(0,R.jsx)("div",{children:(0,R.jsx)(O.Z,{value:r})})]})}),(0,R.jsx)("div",{className:"row full",children:(0,R.jsx)(re.Z,{rowKey:"id",fields:u,rows:n,tableFilter:!0,filterPlaceholder:o("placeholder_filter"),paginationPage:a,paginationTop:!0,hidePaginatonSize:!0})})]}),(0,R.jsx)("div",{className:"row full section container-small secondary-title",children:(0,R.jsx)("div",{className:"row full",children:(0,R.jsx)("div",{className:"cell padding-small",children:(0,R.jsx)(S.Z,{id:"btn_ok",className:"full primary",onClick:l,value:(0,R.jsx)(O.Z,{center:!0,value:o("msg_ok"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Check"}),iconWidth:"20px"})})})})})]})}))})};ae.defaultProps={partnumber:"",partname:"",rows:[],selectorPage:(0,T.$8)("selectorPage"),className:"",getText:void 0,onClose:void 0};var ie=ae,se="Trans_modal__D2W4t",le="Trans_dialog__g0ar9",oe="Trans_panel__DfIoU",ce="Trans_panelTitle__azpBO",ue="Trans_closeIcon__LO6gj",de="Trans_editCol__NnVKG",pe=["baseTranstype","transtype","direction","doctypes","directions","refno","nettoDiv","netto","fromDiv","from","elementCount","className","getText","onClose","onCreate"],me=function(e){var t=e.baseTranstype,r=e.transtype,n=e.direction,a=e.doctypes,i=e.directions,o=e.refno,c=e.nettoDiv,d=e.netto,p=e.fromDiv,m=e.from,f=e.elementCount,v=e.className,x=e.getText,g=e.onClose,_=e.onCreate,y=(0,E.Z)(e,pe),h=(0,u.useState)({transtype:r,direction:n,refno:o,netto:d,from:m,nettoDiv:c,fromDiv:p}),b=(0,l.Z)(h,2),k=b[0],j=b[1],w=a.map((function(e){return{value:e,text:e}})),Z=i.map((function(e){return{value:e,text:e}}));return(0,R.jsx)("div",{className:"modal".concat(" ",se),children:(0,R.jsx)("div",(0,s.Z)((0,s.Z)({className:"dialog".concat(" ",le)},y),{},{children:(0,R.jsxs)("div",{className:"".concat(oe," ").concat(v),children:[(0,R.jsx)("div",{className:"".concat(ce," ","primary"),children:(0,R.jsxs)("div",{className:"row full",children:[(0,R.jsx)("div",{className:"cell",children:(0,R.jsx)(O.Z,{value:x("msg_create_title"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"FileText"}),iconWidth:"20px"})}),(0,R.jsx)("div",{className:"cell align-right".concat(" ",ue),children:(0,R.jsx)(K.Z,{id:"closeIcon",iconKey:"Times",onClick:g})})]})}),(0,R.jsxs)("div",{className:"row full container-small section-small",children:[(0,R.jsx)("div",{className:"row full",children:(0,R.jsx)("div",{className:"cell padding-small",children:(0,R.jsx)("div",{children:(0,R.jsx)(O.Z,{className:"bold",value:x("msg_create_new")})})})}),(0,R.jsxs)("div",{className:"row full",children:[(0,R.jsx)("div",{className:"cell half padding-small",children:(0,R.jsx)(P.Z,{id:"transtype",className:"full",value:k.transtype,onChange:function(e){return function(e){var r=k.nettoDiv,n=k.fromDiv;["invoice","receipt"].includes(e)&&["order","rent","worksheet"].includes(t)?(r=!0,0===f&&(n=!0)):(r=!1,n=!1),j((0,s.Z)((0,s.Z)({},k),{},{transtype:e,nettoDiv:r,fromDiv:n}))}(e)},options:w})}),(0,R.jsx)("div",{className:"cell half padding-small",children:(0,R.jsx)(P.Z,{id:"direction",className:"full",value:k.direction,onChange:function(e){return j((0,s.Z)((0,s.Z)({},k),{},{direction:e}))},options:Z})})]}),(0,R.jsx)("div",{className:"row full",children:(0,R.jsx)("div",{className:"cell padding-small",children:(0,R.jsx)("div",{id:"refno",className:"padding-small".concat(" ",de),onClick:function(){return j((0,s.Z)((0,s.Z)({},k),{},{refno:!k.refno}))},children:(0,R.jsx)(O.Z,{className:"bold",value:x("msg_create_setref"),leftIcon:(0,R.jsx)(K.Z,{iconKey:k.refno?"CheckSquare":"SquareEmpty"})})})})}),k.nettoDiv?(0,R.jsx)("div",{className:"row full",children:(0,R.jsx)("div",{className:"cell padding-small",children:(0,R.jsx)("div",{id:"netto",className:"padding-small".concat(" ",de),onClick:function(){return j((0,s.Z)((0,s.Z)({},k),{},{netto:!k.netto}))},children:(0,R.jsx)(O.Z,{className:"bold",value:x("msg_create_deduction"),leftIcon:(0,R.jsx)(K.Z,{iconKey:k.netto?"CheckSquare":"SquareEmpty"})})})})}):null,k.fromDiv?(0,R.jsx)("div",{className:"row full",children:(0,R.jsx)("div",{className:"cell padding-small",children:(0,R.jsx)("div",{id:"from",className:"padding-small".concat(" ",de),onClick:function(){return j((0,s.Z)((0,s.Z)({},k),{},{from:!k.from}))},children:(0,R.jsx)(O.Z,{className:"bold",value:x("msg_create_delivery"),leftIcon:(0,R.jsx)(K.Z,{iconKey:k.from?"CheckSquare":"SquareEmpty"})})})})}):null]}),(0,R.jsx)("div",{className:"row full section container-small secondary-title",children:(0,R.jsxs)("div",{className:"row full",children:[(0,R.jsx)("div",{className:"cell padding-small half",children:(0,R.jsx)(S.Z,{id:"btn_cancel",className:"full".concat(" ",ue," "),onClick:function(){return g()},value:(0,R.jsx)(O.Z,{center:!0,value:x("msg_cancel"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Times"}),iconWidth:"20px"})})}),(0,R.jsx)("div",{className:"cell padding-small half",children:(0,R.jsx)(S.Z,{id:"btn_create",className:"full primary",onClick:function(){return _({newTranstype:k.transtype,newDirection:k.direction,refno:k.refno,fromInventory:k.from&&k.fromDiv,nettoQty:k.netto&&k.nettoDiv})},value:(0,R.jsx)(O.Z,{center:!0,value:x("msg_ok"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Check"}),iconWidth:"20px"})})})]})})]})}))})};me.defaultProps={baseTranstype:"",transtype:"",direction:"",doctypes:[],directions:[],refno:!0,nettoDiv:!1,netto:!0,fromDiv:!1,from:!1,elementCount:0,className:"",getText:void 0,onClose:void 0,onCreate:void 0};var fe=me,ve="Report_modal__6GcDQ",xe="Report_dialog__MxkX+",ge="Report_panel__iq5sB",_e="Report_panelTitle__jiznV",ye="Report_closeIcon__Mk-HR",he="Report_copyInput__w9Inc",be=["title","template","templates","orient","size","copy","className","getText","onClose","onOutput"],ke=function(e){var t=e.title,r=e.template,n=e.templates,a=e.orient,i=e.size,o=e.copy,c=e.className,d=e.getText,p=e.onClose,m=e.onOutput,f=(0,E.Z)(e,be),v=(0,u.useState)({template:r,orient:a,size:i,copy:o}),x=(0,l.Z)(v,2),g=x[0],_=x[1],y=function(e){m({type:e,template:g.template,title:t,orient:g.orient,size:g.size,copy:g.copy})},h=T.h.ui.report_orientation.map((function(e){return{value:e[0],text:d(e[1])}})),b=T.h.ui.report_size.map((function(e){return{value:e[0],text:e[1]}}));return(0,R.jsx)("div",{className:"modal".concat(" ",ve),children:(0,R.jsx)("div",(0,s.Z)((0,s.Z)({className:"dialog".concat(" ",xe)},f),{},{children:(0,R.jsxs)("div",{className:"".concat(ge," ").concat(c),children:[(0,R.jsx)("div",{className:"".concat(_e," ","primary"),children:(0,R.jsxs)("div",{className:"row full",children:[(0,R.jsx)("div",{className:"cell",children:(0,R.jsx)(O.Z,{value:t,leftIcon:(0,R.jsx)(K.Z,{iconKey:"ChartBar"}),iconWidth:"20px"})}),(0,R.jsx)("div",{className:"cell align-right".concat(" ",ye),children:(0,R.jsx)(K.Z,{id:"closeIcon",iconKey:"Times",onClick:p})})]})}),(0,R.jsxs)("div",{className:"row full container-small section-small",children:[(0,R.jsx)("div",{className:"row full",children:(0,R.jsxs)("div",{className:"cell padding-small",children:[(0,R.jsx)("div",{children:(0,R.jsx)(O.Z,{className:"bold",text:"msg_template"})}),(0,R.jsx)(P.Z,{id:"template",className:"full",value:g.template,onChange:function(e){return _((0,s.Z)((0,s.Z)({},g),{},{template:e}))},options:n})]})}),(0,R.jsx)("div",{className:"row full",children:(0,R.jsxs)("div",{className:"cell padding-small",children:[(0,R.jsx)("div",{children:(0,R.jsx)(O.Z,{className:"bold",text:"msg_report_prop"})}),(0,R.jsx)(P.Z,{id:"orient",value:g.orient,onChange:function(e){return _((0,s.Z)((0,s.Z)({},g),{},{orient:e}))},options:h}),(0,R.jsx)(P.Z,{id:"size",value:g.size,onChange:function(e){return _((0,s.Z)((0,s.Z)({},g),{},{size:e}))},options:b}),(0,R.jsx)(F.Z,{id:"copy",className:"".concat(he),type:"integer",value:g.copy,onChange:function(e){return _((0,s.Z)((0,s.Z)({},g),{},{copy:e}))}})]})})]}),(0,R.jsxs)("div",{className:"row full section container-small secondary-title",children:[(0,R.jsxs)("div",{className:"row full",children:[(0,R.jsx)("div",{className:"cell padding-small half",children:(0,R.jsx)(S.Z,{id:"btn_print",className:"full primary",disabled:""===r?"disabled":"",onClick:function(){return y("print")},label:d("msg_print")})}),(0,R.jsx)("div",{className:"cell padding-small half",children:(0,R.jsx)(S.Z,{id:"btn_pdf",className:"full primary",disabled:""===r?"disabled":"",onClick:function(){return y("pdf")},label:d("msg_export_pdf")})})]}),(0,R.jsxs)("div",{className:"row full",children:[(0,R.jsx)("div",{className:"cell padding-small half",children:(0,R.jsx)(S.Z,{id:"btn_xml",className:"full primary",disabled:""===r?"disabled":"",onClick:function(){return y("xml")},label:d("msg_export_xml")})}),(0,R.jsx)("div",{className:"cell padding-small half",children:(0,R.jsx)(S.Z,{id:"btn_printqueue",className:"full primary",disabled:""===r?"disabled":"",onClick:function(){return y("printqueue")},label:d("msg_printqueue")})})]})]})]})}))})};ke.defaultProps={title:"",template:"",templates:[],orient:"portrait",size:"a4",copy:1,className:"",getText:void 0,onClose:void 0,onOutput:void 0};var je=ke,we=function(e,t){var r=(0,f.xZ)(e,t),i=(0,Z.o)(e,t),l=(0,Z.c)(e,t),o=(0,w.E)({getText:r.getText}),u=(0,j.i)({getText:r.getText}),d=function(e,t){if(e=parseFloat(e),isNaN(e))return e;t||(t=0);var r=Math.pow(10,t);return Math.floor(e*r+(e*r*10%10>=5?1:0))/r},m=function(t){var r=new URLSearchParams;return r.append("reportkey",t.template),r.append("orientation",t.orient),r.append("size",t.size),r.append("output",t.type),t.filters?"/report?".concat(r.toString(),"&").concat(t.filters):(r.append("nervatype",t.nervatype||e.edit.current.type),"/report?".concat(r.toString(),"&filters[@id]=").concat(t.id||e.edit.current.item.id))},h=function(){var t=(0,n.Z)(c().mark((function t(n,a){var i,s,l,o,u;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.edit.dataset.report.filter((function(e){return e.reportkey===n}))[0],s=e.login.data.groups.filter((function(t){return"nervatype"===t.groupname&&t.groupvalue===e.edit.current.type}))[0],l={nervatype:s.id,ref_id:e.edit.current.item.id,qty:parseInt(a),employee_id:e.login.data.employee.id,report_id:i.id},o={method:"POST",data:[l]},t.next=6,r.requestData("/ui_printqueue",o);case 6:if(!(u=t.sent).error){t.next=9;break}return t.abrupt("return",r.resultError(u));case 9:r.showToast({type:"success",autoClose:!0,title:r.getText("msg_successful"),message:r.getText("report_add_groups")});case 10:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),E=function(){var e=(0,n.Z)(c().mark((function e(t){var n,a,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("printqueue"!==t.type){e.next=2;break}return e.abrupt("return",h(t.template,t.copy));case 2:return e.next=4,r.requestData(m(t),{});case 4:if(!(n=e.sent)||!n.error){e.next=8;break}return r.resultError(n),e.abrupt("return",!1);case 8:return a=URL.createObjectURL(n,{type:"pdf"===t.type?"application/pdf":"application/xml; charset=UTF-8"}),"print"===t.type?b()({printable:a,type:"pdf",base64:!1}):(i=(i=t.title+"_"+(0,v.Z)(new Date,{representation:"date"})+"."+t.type).split("/").join("_"),(0,f.GX)(a,i)),e.abrupt("return",!0);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(){var a=(0,n.Z)(c().mark((function n(){var a,i,s;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=p()(e.edit,{}),i={method:"POST",data:[{key:"items",text:(0,f.aT)(e.login.data.engine,u.printqueue.items(a.printqueue)).sql,values:[]}]},n.next=4,r.requestData("/view",i);case 4:if(!(s=n.sent).error){n.next=7;break}return n.abrupt("return",r.resultError(s));case 7:a=p()(a,{dataset:{$merge:{items:s.items}}}),t("edit",a);case 9:case"end":return n.stop()}}),n)})));return function(){return a.apply(this,arguments)}}(),q=function(){var t=(0,n.Z)(c().mark((function t(n){var a,i,s,l,o,u,d;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=[],e.edit.current.fieldvalue.forEach((function(e){e.selected&&("bool"===e.fieldtype?a.push("filters[".concat(e.name,"]=").concat(e.fieldtype?"1":"0")):a.push("filters[".concat(e.name,"]=").concat(e.value)))})),i=e.edit.current.item,s={type:"auto",template:i.reportkey,title:i.reportkey,orient:i.orientation,size:i.size,filters:a.join("&")},t.t0=n,t.next="xml"===t.t0?7:"csv"===t.t0?10:12;break;case 7:return s.type="xml",s.ctype="application/xml; charset=UTF-8",t.abrupt("break",14);case 10:return s.ctype="text/csv; charset=UTF-8",t.abrupt("break",14);case 12:return s.ctype="application/pdf",t.abrupt("break",14);case 14:return t.next=16,r.requestData(m(s),{});case 16:if(!(l=t.sent)||!l.error){t.next=19;break}return t.abrupt("return",r.resultError(l));case 19:if("csv"===n?(u=new Blob([l],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(u),n="csv"):o=URL.createObjectURL(l,{type:s.ctype}),"print"!==n){t.next=24;break}b()({printable:o,type:"pdf",base64:!1}),t.next=27;break;case 24:return d=(d=s.title+"_"+(0,v.Z)(new Date,{representation:"date"})+"."+n).split("/").join("_"),t.abrupt("return",(0,f.GX)(o,d));case 27:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),I=function(n,l,o){var c=p()({},{$set:o||e.edit});if("undefined"===typeof c.dataset[c.current.type]||0===c.dataset[c.current.type].length)return r.showToast({type:"error",autoClose:!1,title:r.getText("msg_warning"),message:r.getText("msg_editor_invalid")}),!1;if("disabled"===(c=p()(c,{$merge:{template:l,panel:l.options.panel,caption:l.options.title,audit:r.getAuditFilter(c.current.type,c.current.transtype)[0]}})).audit)return!1;if(null===c.dataset[c.current.type][0].id?(c=p()(c,{current:{$merge:{item:c.dataset[c.current.type][0]}}}),l.options.search_form?c=p()(c,{$merge:{title_field:l.options.title_field}}):("all"!==c.audit&&"update"!==c.audit||(c=p()(c,{$merge:{dirty:!0}})),c=p()(c,{$merge:{title_field:r.getText("label_new")+" "+l.options.title}})),"undefined"!==typeof l.options.extend&&(c=p()(c,{current:{$merge:{extend:i({tablename:l.options.extend,dataset:c.dataset,current:c.current})}}}))):(c=p()(c,{current:{$merge:{item:p()(i({tablename:c.current.type,dataset:c.dataset,current:c.current}),{$merge:c.dataset[c.current.type][0]})}}}),"undefined"!==typeof l.options.extend&&"undefined"!==typeof(c=p()(c,{current:{$merge:{extend:i({tablename:l.options.extend,dataset:c.dataset,current:c.current})}}})).dataset[l.options.extend]&&c.dataset[l.options.extend].length>0&&(c=p()(c,{current:{$merge:{extend:p()(c.current.extend,{$merge:c.dataset[l.options.extend][0]})}}}))),"trans"===(c=p()(c,{current:{$merge:{state:"normal",page:0}}})).current.type&&("undefined"!==typeof c.dataset.trans[0].transcast&&"cancellation"===c.dataset.trans[0].transcast&&(c=p()(c,{current:{$merge:{state:"cancellation"}}})),c.dataset.pattern)){var u=c.dataset.pattern.filter((function(e){return 1===e.defpattern}))[0];c=p()(c,{current:{$merge:{template:u?u.id:""}}})}if("normal"===c.current.state&&1===c.current.item.deleted?c=p()(c,{current:{$merge:{state:"deleted"}}}):1===c.current.item.closed&&(c=p()(c,{current:{$merge:{state:"closed"}}})),c=p()(c,{current:{$merge:{fieldvalue:c.dataset.fieldvalue||[]}}}),Object.keys(c.template.view).forEach((function(e){c=p()(c,{template:{view:(0,a.Z)({},e,{$merge:{view_audit:"all"}})}}),c="setting"===e?p()(c,{template:{view:(0,a.Z)({},e,{$merge:{view_audit:"disabled"}})}}):p()(c,{template:{view:(0,a.Z)({},e,{$merge:{view_audit:r.getAuditFilter(l.view[e].audit_type||e,l.view[e].audit_transtype||null)[0]}})}})})),"report"===c.current.type){var d=JSON.parse(c.dataset.report[0].report);Object.keys(d.fields).forEach((function(e,t){var r=d.fields[e],n=r.selected?r.selected:"in"===r.wheretype,a=p()({},{$set:{id:t+1,rowtype:"reportfield",datatype:r.fieldtype,name:e,label:r.description,selected:n,empty:"in"===r.wheretype?"false":"true",value:r.value}});switch(r.fieldtype){case"bool":break;case"valuelist":a=p()(a,{$merge:{description:"in"!==r.wheretype?r.valuelist.split("|").unshift(""):r.valuelist.split("|")}});break;case"date":"undefined"===typeof a.value&&(a=r.defvalue?p()(a,{$merge:{value:(0,v.Z)((0,x.Z)(new Date,parseInt(r.defvalue,10)),{representation:"date"})}}):"in"===r.wheretype?p()(a,{$merge:{value:(0,v.Z)(new Date,{representation:"date"})}}):p()(a,{$merge:{value:""}}));break;case"integer":case"float":"undefined"===typeof a.value&&(a=p()(a,{$merge:{value:r.defvalue&&""!==r.defvalue?r.defvalue:"0"}}));break;default:a=p()(a,{$merge:{datatype:"string"}})}"undefined"===typeof a.value&&(a=p()(a,{$merge:{value:r.defvalue?r.defvalue:""}})),c=p()(c,{current:{fieldvalue:{$push:[a]}}})}))}n.shipping&&("undefined"===typeof(c=p()(c,{current:{$merge:{form_type:"transitem_shipping",direction:c.dataset.groups.filter((function(e){return e.id===c.current.item.direction}))[0].groupvalue}}})).dataset.shiptemp&&(c=p()(c,{dataset:{$merge:{shiptemp:[]}}})),(c=p()(c,{current:{item:{$merge:{delivery_type:r.getText("delivery_"+c.current.direction)}}}})).current.shippingdate?c=p()(c,{current:{item:{$merge:{shippingdate:c.current.shippingdate}}}}):(c=p()(c,{current:{$merge:{shippingdate:(0,v.Z)(new Date,{representation:"date"})+"T00:00:00"}}}),c=p()(c,{current:{item:{$merge:{shippingdate:(0,v.Z)(new Date,{representation:"date"})+"T00:00:00"}}}})),c.current.shipping_place_id?c=p()(c,{current:{item:{$merge:{shipping_place_id:c.current.shipping_place_id}}}}):(c=p()(c,{current:{$merge:{shipping_place_id:null}}}),c=p()(c,{current:{item:{$merge:{shipping_place_id:null}}}})),(c=p()(c,{dataset:{$merge:{shipping_items_:[]}}})).dataset.shipping_items.forEach((function(e,t){var r=p()(e,{$merge:{id:t+1,qty:parseFloat(e.qty)}}),n=c.dataset.transitem_shipping.filter((function(e){return e.id===r.item_id+"-"+r.product_id}))[0];if("undefined"!==typeof n){var a="out"===c.current.direction?-parseFloat(n.sqty):parseFloat(n.sqty);r=p()(r,{$merge:{tqty:a,diff:parseFloat(r.qty)-a}})}else r=p()(r,{$merge:{qty:parseFloat(r.qty),tqty:0,diff:parseFloat(r.qty)}});var i=c.dataset.shiptemp.filter((function(e){return e.id===r.item_id+"-"+r.product_id}))[0];"undefined"!==typeof i&&(r=p()(r,{$merge:{edited:!0}})),c=p()(c,{dataset:{shipping_items_:{$push:[r]}}})}))),"printqueue"===c.current.type&&(c="undefined"===typeof c.printqueue?p()(c,{$merge:{printqueue:c.current.item}}):p()(c,{current:{item:{$merge:(0,s.Z)({},c.printqueue)}}})),"normal"!==(c=p()(c,{panel:{$merge:{form:!0,state:c.current.state}}})).panel.state&&(c=p()(c,{$merge:{audit:"readonly"}})),"readonly"===c.audit&&"deleted"!==(c=p()(c,{panel:{$merge:{save:!1,link:!1,delete:!1,new:!1,pattern:!1,password:!1,formula:!1}}})).panel.state&&(c=p()(c,{panel:{$merge:{trans:!1}}})),"all"!==c.audit&&"deleted"!==(c=p()(c,{panel:{$merge:{delete:!1,new:!1}}})).panel.state&&(c=p()(c,{panel:{$merge:{trans:!1}}})),"deleted"===c.panel.state&&(c=p()(c,{panel:{$merge:{copy:!1,create:!1}}})),c=p()(c,{current:{$merge:{view:n.form||"form"}}}),t("edit",c),t("current",{module:"edit",edit:!0,side:"hide"})},D=function(){var s=(0,n.Z)(c().mark((function n(s){var l,d,m,v,x,g,_,y;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(l=s.ntype,d=s.ttype,m=s.id,v=p()({},{$set:{dataset:{},current:{type:l,transtype:d},dirty:!1,form_dirty:!1,preview:null}}),null===m&&(x=i({tablename:l,transtype:d,dataset:v.dataset,current:v.current})),g=[],k.Z[l](d).forEach((function(t){var r={};"table"===t.infoType?(r={select:["*"],from:t.classAlias},t.where&&(r.where=t.where),t.order&&(r.order_by=t.order)):r="undefined"!==typeof u[l][t.sqlKey]?u[l][t.sqlKey](l):"undefined"!==typeof u[l][t.infoName]?u[l][t.infoName](l):u.all[t.infoName](l);var n=(0,f.aT)(e.login.data.engine,r);null!==m||0===n.prmCount?g=p()(g,{$push:[{key:t.infoName,text:n.sql,values:n.prmCount>0&&null!==m?Array(n.prmCount).fill(m):[]}]}):v=p()(v,{dataset:{$merge:(0,a.Z)({},t.infoName,[])}})})),!(g.length>0)){n.next=19;break}return"report"!==l&&k.Z.report().forEach((function(t){var r={key:t.infoName,sql:u.report[t.infoName](l),values:[]};if("report"===t.infoName?"printqueue"!==l&&(r.values.push(e.login.data.employee.usergroup),r.values.push(v.current.type)):"message"===t.infoName?(r.values.push(v.current.type),r.values.push(v.current.type)):r.values.push(v.current.type),"trans"===v.current.type){var n=["and","r.transtype","=",[[],{select:["id"],from:"groups",where:[["groupname","=","'transtype'"],["and","groupvalue","=","?"]]}]];"message"===t.infoName?(r.sql.where[0][2][0].from[0][0][0].where[0].push(n),r.sql.where[0][2][0].from[0][0][1].where[0].push(n),r.values.splice(1,0,v.current.transtype)):r.sql.where.push(n),r.values.push(v.current.transtype)}g=p()(g,{$push:[{key:r.key,text:(0,f.aT)(e.login.data.engine,r.sql).sql,values:r.values}]})})),_={method:"POST",data:g},n.next=11,r.requestData("/view",_);case 11:if(!(y=n.sent).error){n.next=14;break}return n.abrupt("return",r.resultError(y));case 14:v=p()(v,{dataset:{$merge:y}}),null===m&&(null===x&&(x=i({tablename:l,transtype:d,dataset:v.dataset,current:v.current})),"delivery"===d&&(x=p()(x,{$merge:{direction:v.dataset.groups.filter((function(e){return"direction"===e.groupname&&"transfer"===e.groupvalue}))[0].id}})),v=p()(v,{dataset:{$merge:(0,a.Z)({},l,[x])}})),t("edit",v,(function(){if(!s.cb_key||"SET_EDITOR"===s.cb_key)return"trans"===l?s.shipping?I(s,o.shipping(v.dataset[l][0],v,(0,T.$8)("ui")),v):I(s,o[d](v.dataset[l][0],v,(0,T.$8)("ui")),v):I(s,o[l](v.dataset[l][0],v,(0,T.$8)("ui")),v)})),n.next=21;break;case 19:v=p()(v,{dataset:{$merge:(0,a.Z)({},l,[i({tablename:l,transtype:d,dataset:v.dataset,current:v.current})])}}),t("edit",v,(function(){if(!s.cb_key||"SET_EDITOR"===s.cb_key)return I(s,o[l](v.dataset[l][0],v,(0,T.$8)("ui")),v)}));case 21:case"end":return n.stop()}}),n)})));return function(e){return s.apply(this,arguments)}}(),C=function(r){var n=p()(e.edit,{}),s=o[r.fkey]({},n,(0,T.$8)("ui")).options.data;switch("undefined"===typeof s&&(s=r.fkey),n=p()(n,{$merge:{form_dirty:!1}}),n=p()(n,{current:{$merge:{form_type:r.fkey,form_datatype:s}}}),n=p()(n,{current:{$merge:{form:i({tablename:s,dataset:n.dataset,current:n.current})}}}),n=null!==r.id?p()(n,{current:{$merge:{form:n.dataset[r.fkey].filter((function(e){return e.id===parseInt(r.id,10)}))[0]}}}):p()(n,{current:{$merge:{form_dirty:!0}}}),n=p()(n,{current:{$merge:{form_template:o[r.fkey](n.current.form,n,(0,T.$8)("ui"))}}}),r.fkey){case"price":case"discount":n=p()(n,{current:{$merge:{price_link_customer:null,price_customer_id:null}}}),null!==r.id&&(n=p()(n,{current:{$merge:{price_link_customer:n.current.form.link_customer,price_customer_id:n.current.form.customer_id}}}));break;case"invoice_link":var l={id:(n=p()(n,{current:{$merge:{invoice_link_fieldvalue:n.dataset.invoice_link_fieldvalue}}})).current.form.id,ref_id_1:"",transnumber:"",curr:""},c=n.dataset.invoice_link.filter((function(e){return e.id===n.current.form.id}))[0];"undefined"!==typeof c&&(l=c),n=p()(n,{current:{$merge:{invoice_link:[l]}}});break;case"payment_link":var u={id:(n=p()(n,{current:{$merge:{payment_link_fieldvalue:n.dataset.payment_link_fieldvalue}}})).current.form.id,ref_id_2:"",transnumber:"",curr:""},d=n.dataset.payment_link.filter((function(e){return e.id===n.current.form.id}))[0];"undefined"!==typeof d&&(u=d),n=p()(n,{current:{$merge:{payment_link:[u]}}}),r.link_field&&(n=p()(n,{current:{form:{$merge:(0,a.Z)({},r.link_field,r.link_id)}}}))}var m=p()(n.current.form_template.options.panel,{$merge:{form:!0,state:n.current.state}});"normal"!==n.panel.state&&(n=p()(n,{$merge:{audit:"readonly"}})),"readonly"===n.audit&&(m=p()(m,{$merge:{save:!1}})),"all"!==n.audit&&(m=p()(m,{$merge:{link:!1,delete:!1,new:!1}})),n=p()(n,{$merge:{panel:m}}),t("edit",n)},O=function(a){var i=function(){D({ntype:e.edit.current.type,ttype:e.edit.current.transtype,id:e.edit.current.item.id,form:a.fkey})},s=function(){var e=(0,n.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==a.id){e.next=4;break}i(),e.next=13;break;case 4:return t=a.table?a.table:a.fkey,e.next=7,r.requestData("/"+t,{method:"DELETE",query:{id:a.id}});case 7:if(!(n=e.sent)||!n.error){e.next=10;break}return e.abrupt("return",r.resultError(n));case 10:return e.next=12,r.createHistory("save");case 12:i();case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();a.prompt?s():t("current",{modalForm:(0,R.jsx)(N.default,{title:r.getText("msg_warning"),message:r.getText("msg_delete_text"),infoText:r.getText("msg_delete_info"),labelOK:r.getText("msg_ok"),labelCancel:r.getText("msg_cancel"),onCancel:function(){t("current",{modalForm:null})},onOK:function(e){t("current",{modalForm:null},(function(){s()}))}}),side:"hide"})},S=function(t,r,n,s,l){var o=t.findIndex((function(e){return e.ref_id===n&&e.fieldname===r}));if(-1===o){var c=p()(i({tablename:"fieldvalue",current:e.edit.current}),{$merge:{fieldname:r,ref_id:n,value:"undefined"===typeof l||null===l?s:l}});t=p()(t,{$push:[c]})}else l&&(t=p()(t,(0,a.Z)({},o,{$merge:{value:l}})));return t},F=function(t,r){var n={},a=i({tablename:t,dataset:e.edit.dataset,current:e.edit.current});for(var s in r)a.hasOwnProperty(s)&&(n[s]=r[s]);return n},P=function(){var t=(0,n.Z)(c().mark((function t(){var n,s,o,u,d,m,f,v,x,g,_,y;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=p()(e.edit,{}),s=F(n.current.form_datatype,n.current.form),t.next=4,l(n.current.form_datatype,s);case 4:if(!(s=t.sent).error){t.next=8;break}return r.resultError(s),t.abrupt("return",null);case 8:return t.next=10,r.requestData("/"+n.current.form_datatype,{method:"POST",data:[s]});case 10:if(!(o=t.sent).error){t.next=14;break}return r.resultError(o),t.abrupt("return",null);case 14:return null===n.current.form.id&&(n=p()(n,{current:{form:{$merge:{id:o[0]}}}})),n=p()(n,{$merge:{form_dirty:!1}}),t.next=18,r.createHistory("save");case 18:t.t0=n.current.form_type,t.next="movement"===t.t0?21:"price"===t.t0||"discount"===t.t0?44:"invoice_link"===t.t0||"payment_link"===t.t0?62:75;break;case 21:if("delivery"!==n.current.transtype){t.next=43;break}return u=[],d=null,"undefined"!==typeof(m=n.dataset.movement_transfer.filter((function(e){return e.id===n.current.form.id}))[0])?(m=n.dataset.movement.filter((function(e){return e.id===m.ref_id}))[0],m=p()(i({tablename:"movement",dataset:n.dataset,current:n.current}),{$merge:m})):(m=p()(i({tablename:"movement",dataset:n.dataset,current:n.current}),{$merge:{place_id:n.current.item.place_id}}),d=p()(i({tablename:"link",dataset:n.dataset,current:n.current}),{$merge:{nervatype_1:e.login.data.groups.filter((function(e){return"nervatype"===e.groupname&&"movement"===e.groupvalue}))[0].id,nervatype_2:e.login.data.groups.filter((function(e){return"nervatype"===e.groupname&&"movement"===e.groupvalue}))[0].id,ref_id_2:n.current.form.id}})),m=p()(m,{$merge:{product_id:n.current.form.product_id,qty:-n.current.form.qty,notes:n.current.form.notes}}),u.push(F("movement",m)),n.dataset.movement_transfer.forEach((function(e){(m=p()(i({tablename:"movement",dataset:n.dataset,current:n.current}),{$merge:F("movement",e)})).id!==n.current.form.id&&m.place_id!==n.current.form.place_id&&(m=p()(m,{$merge:{place_id:n.current.form.place_id}}),u.push(m))})),t.next=31,r.requestData("/movement",{method:"POST",data:u});case 31:if(!(f=t.sent).error){t.next=35;break}return r.resultError(f),t.abrupt("return",null);case 35:if(null===d){t.next=43;break}return d=p()(d,{$merge:{ref_id_1:f[0]}}),t.next=39,r.requestData("/link",{method:"POST",data:[d]});case 39:if(!(f=t.sent).error){t.next=43;break}return r.resultError(f),t.abrupt("return",null);case 43:case 61:case 74:case 75:return t.abrupt("break",76);case 44:if(null===n.current.price_link_customer&&null===n.current.price_customer_id){t.next=61;break}if(null!==n.current.price_customer_id){t.next=54;break}return t.next=48,r.requestData("/link",{method:"DELETE",query:{id:n.current.price_link_customer}});case 48:if(!(o=t.sent)||!o.error){t.next=52;break}return r.resultError(o),t.abrupt("return",null);case 52:t.next=61;break;case 54:return v=p()(i({tablename:"link",dataset:n.dataset,current:n.current}),{$merge:{id:n.current.price_link_customer,nervatype_1:e.login.data.groups.filter((function(e){return"nervatype"===e.groupname&&"price"===e.groupvalue}))[0].id,ref_id_1:n.current.form.id,nervatype_2:e.login.data.groups.filter((function(e){return"nervatype"===e.groupname&&"customer"===e.groupvalue}))[0].id,ref_id_2:n.current.price_customer_id}}),t.next=57,r.requestData("/link",{method:"POST",data:[v]});case 57:if(!(o=t.sent).error){t.next=61;break}return r.resultError(o),t.abrupt("return",null);case 62:for(x=n.current.form_type+"_fieldvalue",g=0;g<n.current[x].length;g++)null===n.current[x][g].ref_id&&(n=p()(n,{current:(0,a.Z)({},x,(0,a.Z)({},g,{$merge:{ref_id:n.current.form.id}}))}));return _={link_qty:"0",link_rate:"1"},y=n.current[x],Object.keys(_).forEach((function(e){y=S(y,e,n.current.form.id,_[e])})),n=p()(n,{current:{$merge:(0,a.Z)({},x,y)}}),t.next=70,r.requestData("/fieldvalue",{method:"POST",data:y});case 70:if(!(o=t.sent).error){t.next=74;break}return r.resultError(o),t.abrupt("return",null);case 76:return t.abrupt("return",n);case 77:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),K=function(e,t,r){if(null!==t)switch(e){case"customer":return t===r.custtype;case"place":return t===r.placetype;case"product":return t===r.protype;case"tool":return t===r.toolgroup;case"trans":return t===r.transtype}return!0},L=function(){var t=(0,n.Z)(c().mark((function t(){var n,s,o,d,m,x,y,h,b,k,j,w;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=p()(e.edit,{}),s=F(n.current.type,n.current.item),t.next=4,l(n.current.type,s);case 4:if(!(s=t.sent).error){t.next=7;break}return t.abrupt("return",r.resultError(s));case 7:return null===n.current.item.id&&n.dataset.deffield&&n.dataset.deffield.forEach((function(e){if(1===e.addnew){var t=K(n.current.type,e.subtype,n.current.item);if(!n.current.fieldvalue.filter((function(t){return t.fieldname===e.fieldname}))[0]&&t){var r=n.dataset.groups.filter((function(t){return t.id===e.fieldtype}))[0].groupvalue;switch(r){case"bool":case"integer":case"float":n=p()(n,{current:{$merge:{fieldvalue:S(n.current.fieldvalue,e.fieldname,null,null,0)}}});break;case"valuelist":n=p()(n,{current:{$merge:{fieldvalue:S(n.current.fieldvalue,e.fieldname,null,null,e.valuelist.split("|")[0])}}})}}}})),t.next=10,r.requestData("/"+n.current.type,{method:"POST",data:[s]});case 10:if(!(o=t.sent).error){t.next=14;break}return r.resultError(o),t.abrupt("return",null);case 14:return null===n.current.item.id&&(n=p()(n,{current:{item:{$merge:{id:o[0]}}}})),n=p()(n,{$merge:{dirty:!1}}),t.next=18,r.createHistory("save");case 18:if("undefined"!==typeof n.current.extend&&(null===n.current.extend.ref_id&&(n=p()(n,{current:{extend:{$merge:{ref_id:n.current.item.id}}}})),null===n.current.extend.trans_id&&(n=p()(n,{current:{extend:{$merge:{trans_id:n.current.item.id}}}}))),"undefined"!==typeof n.current.fieldvalue)for(d=0;d<n.current.fieldvalue.length;d++)null===n.current.fieldvalue[d].ref_id&&(n=p()(n,{current:{fieldvalue:(0,a.Z)({},d,{$merge:{ref_id:n.current.item.id}})}}));if("trans"!==n.current.type){t.next=50;break}n=p()(n,{current:{$merge:{fieldvalue:S(n.current.fieldvalue,"trans_transcast",n.current.item.id,null,"normal")}}}),t.t0=n.current.transtype,t.next="invoice"===t.t0?25:"worksheet"===t.t0?33:"rent"===t.t0?36:"delivery"===t.t0?39:49;break;case 25:return m={method:"POST",data:[{key:"fields",text:(0,f.aT)(e.login.data.engine,u.trans.invoice_customer()).sql,values:[n.current.item.customer_id]}]},t.next=28,r.requestData("/view",m);case 28:if(!(x=t.sent).error){t.next=31;break}return t.abrupt("return",r.resultError(x));case 31:return x.fields.length>0&&Object.keys(x.fields[0]).forEach((function(e){n=p()(n,{current:{$merge:{fieldvalue:S(n.current.fieldvalue,e,n.current.item.id,null,x.fields[0][e])}}})})),t.abrupt("break",50);case 33:return y={trans_wsdistance:0,trans_wsrepair:0,trans_wstotal:0,trans_wsnote:""},Object.keys(y).forEach((function(e){n=p()(n,{current:{$merge:{fieldvalue:S(n.current.fieldvalue,e,n.current.item.id,null,y[e])}}})})),t.abrupt("break",50);case 36:return h={trans_reholiday:0,trans_rebadtool:0,trans_reother:0,trans_rentnote:""},Object.keys(h).forEach((function(e){n=p()(n,{current:{$merge:{fieldvalue:S(n.current.fieldvalue,e,n.current.item.id,null,h[e])}}})})),t.abrupt("break",50);case 39:if(b=[],n.dataset.movement.forEach((function(e){var t=p()(i({tablename:"movement",dataset:n.dataset,current:n.current}),{$merge:e});(0,_.Z)((0,g.Z)(t.shippingdate),(0,g.Z)(n.current.item.transdate))||(t=p()(t,{$merge:{shippingdate:(0,v.Z)((0,g.Z)(n.current.item.transdate))}}),b.push(t))})),!(b.length>0)){t.next=48;break}return t.next=44,r.requestData("/movement",{method:"POST",data:b});case 44:if(!(o=t.sent).error){t.next=48;break}return r.resultError(o),t.abrupt("return",null);case 48:case 49:return t.abrupt("break",50);case 50:if(!(n.current.fieldvalue.length>0)){t.next=58;break}return t.next=53,r.requestData("/fieldvalue",{method:"POST",data:n.current.fieldvalue});case 53:if(!(o=t.sent).error){t.next=57;break}return r.resultError(o),t.abrupt("return",null);case 57:for(k=0;k<o.length;k++)n.current.fieldvalue[k].id||(n=p()(n,{current:{fieldvalue:(0,a.Z)({},k,{$merge:{id:o[k]}})}}));case 58:if("undefined"===typeof n.current.extend){t.next=96;break}j=String(n.template.options.extend).split("_")[0],w=p()(n.current.extend,{}),t.t1=n.current.transtype,t.next="waybill"===t.t1?64:"formula"===t.t1?81:"production"===t.t1?84:87;break;case 64:if(j=w.seltype,"transitem"!==w.seltype){t.next=72;break}j="link",w=i({tablename:"link",dataset:n.dataset,current:n.current}),w=n.dataset.translink.length>0?p()(w,{$merge:n.dataset.translink[0]}):p()(w,{$merge:{nervatype_1:e.login.data.groups.filter((function(e){return"nervatype"===e.groupname&&"trans"===e.groupvalue}))[0].id,nervatype_2:e.login.data.groups.filter((function(e){return"nervatype"===e.groupname&&"trans"===e.groupvalue}))[0].id,ref_id_1:n.current.item.id}}),w=p()(w,{$merge:{ref_id_2:n.current.extend.ref_id}}),t.next=80;break;case 72:if(w=null,!(n.dataset.translink.length>0)){t.next=80;break}return t.next=76,r.requestData("/link",{method:"DELETE",query:{id:n.dataset.translink[0].id}});case 76:if(!(o=t.sent)||!o.error){t.next=80;break}return r.resultError(o),t.abrupt("return",null);case 80:return t.abrupt("break",87);case 81:return w=p()(w,{$unset:["product"]}),w=p()(w,{$merge:{shippingdate:(0,v.Z)((0,g.Z)(n.current.item.transdate))}}),t.abrupt("break",87);case 84:return w=p()(w,{$unset:["product"]}),w=p()(w,{$merge:{shippingdate:n.current.item.duedate,place_id:n.current.item.place_id}}),t.abrupt("break",87);case 87:if(null===w){t.next=96;break}return t.next=90,r.requestData("/"+j,{method:"POST",data:[w]});case 90:if(!(o=t.sent).error){t.next=94;break}return r.resultError(o),t.abrupt("return",null);case 94:null===w.id&&(w=p()(w,{$merge:{id:o[0]}})),n=p()(n,{current:{$merge:{extend:w}}});case 96:return t.abrupt("return",n);case 97:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),A=function(){var t=(0,n.Z)(c().mark((function t(n){var a,s,l,o,m,g,_,y,h,b,k,j,w,Z,T,N,E,$,q,I,C,O,P,R,L,A,W,M,U,z;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=function(e){return"waybill"===e.transtype?"link":"delivery"!==e.transtype||"normal"!==e.transcast||"in"!==e.direction&&"out"!==e.direction?"copy"===e.cmdtype&&"normal"===e.transcast?"":"normal"!==e.transcast||e.refno?"reflink":"refnumber":""},s=p()(e.edit.dataset.trans[0],{}),l=e.edit.dataset.groups.filter((function(e){return e.id===s.transtype}))[0].groupvalue,o=s.transtype,m=e.edit.dataset.groups.filter((function(e){return e.id===s.direction}))[0].groupvalue,g=s.direction,"undefined"===typeof n.new_transtype||"undefined"===typeof n.new_direction){t.next=16;break}if(l=n.new_transtype,"undefined"===typeof(_=e.login.data.audit.filter((function(e){return"trans"===e.nervatypeName&&e.subtypeName===l}))[0])){t.next=13;break}if("disabled"!==_.item.inputfilterName){t.next=13;break}return r.showToast({type:"info",title:r.getText("msg_warning"),message:r.getText("msg_create_disabled_err")+" "+l}),t.abrupt("return",!1);case 13:o=e.edit.dataset.groups.filter((function(e){return"transtype"===e.groupname&&e.groupvalue===l}))[0].id,m=n.new_direction,g=e.edit.dataset.groups.filter((function(e){return"direction"===e.groupname&&e.groupvalue===m}))[0].id;case 16:if("receipt"!==l&&"worksheet"!==l||"in"!==m){t.next=19;break}return r.showToast({type:"info",title:r.getText("msg_warning"),message:r.getText("msg_input_invalid")+" in"}),t.abrupt("return",!1);case 19:if("cancellation"!==s.transcast){t.next=22;break}return r.showToast({type:"info",title:r.getText("msg_warning"),message:r.getText("msg_create_cancellation_err1")}),t.abrupt("return",!1);case 22:if("cancellation"!==n.transcast||"invoice"!==l&&"receipt"!==l||0!==s.deleted){t.next=25;break}return r.showToast({type:"info",title:r.getText("msg_warning"),message:r.getText("msg_create_cancellation_err2")}),t.abrupt("return",!1);case 25:if(!("cancellation"===n.transcast&&e.edit.dataset.cancel_link.length>0)){t.next=28;break}return r.showToast({type:"info",title:r.getText("msg_warning"),message:r.getText("msg_create_cancellation_err3"+e.edit.dataset.cancel_link[0].transnumber)}),t.abrupt("return",!1);case 28:if("amendment"!==n.transcast||1!==s.deleted){t.next=31;break}return r.showToast({type:"info",title:r.getText("msg_warning"),message:r.getText("msg_create_amendment_err")}),t.abrupt("return",!1);case 31:return y=p()({},{$set:{id:null,transtype:o,transnumber:null,crdate:(0,v.Z)(new Date,{representation:"date"}),transdate:(0,v.Z)(new Date,{representation:"date"}),duedate:null,customer_id:s.customer_id,employee_id:s.employee_id,department:s.department,project_id:s.project_id,place_id:s.place_id,paidtype:s.paidtype,curr:s.curr,notax:s.notax,paid:0,acrate:s.acrate,notes:s.notes,intnotes:s.intnotes,fnote:s.fnote,transtate:e.edit.dataset.transtate.filter((function(e){return"transtate"===e.groupname&&"ok"===e.groupvalue}))[0].id,closed:0,deleted:0,direction:g,cruser_id:e.login.data.employee.id,trans_transcast:n.transcast||"normal"}}),null!==s.duedate&&(y.duedate=(0,v.Z)(new Date,{representation:"date"})+"T00:00:00"),"invoice"===l&&"out"===m?"undefined"!==typeof(h=e.edit.dataset.settings.filter((function(e){return"default_deadline"===e.fieldname}))[0])&&(y.duedate=(0,v.Z)((0,x.Z)(new Date,parseInt(h.value,10)),{representation:"date"})+"T00:00:00"):"receipt"===l&&(y.customer_id=null),"refnumber"!==(b=a({transtype:l,transcast:n.transcast,direction:m,cmdtype:n.cmdtype,refno:n.refno}))&&"reflink"!==b||(y.ref_transnumber=s.transnumber),k=l+"_"+m,"waybill"!==l&&"cash"!==l||(k=l),j={method:"POST",data:{key:"nextNumber",values:{numberkey:k,step:!0}}},t.next=41,r.requestData("/function",j);case 41:if(!(w=t.sent).error){t.next=45;break}return r.resultError(w),t.abrupt("return",null);case 45:return"cancellation"===n.transcast?(y.transnumber=w+"/C","delivery"!==l&&"inventory"!==l&&(y.deleted=1),y.transdate=s.transdate,y.duedate=s.duedate):"amendment"===n.transcast?y.transnumber=w+"/A":y.transnumber=w,t.next=48,r.requestData("/trans",{method:"POST",data:[y]});case 48:if(!(w=t.sent).error){t.next=52;break}return r.resultError(w),t.abrupt("return",null);case 52:if(y.id=w[0],Z=[],e.edit.current.fieldvalue.forEach((function(t){if("trans_transcast"!==t.fieldname){var r=e.edit.dataset.deffield.filter((function(e){return e.fieldname===t.fieldname}))[0],a=K("trans",r.subtype,y);if(0===t.deleted&&1===r.visible&&a||0===t.deleted&&a&&"copy"===n.cmdtype){var i=F("fieldvalue",t);i.id=null,i.ref_id=y.id,Z.push(i)}}})),"invoice"!==l){t.next=63;break}return T={method:"POST",data:[{key:"fields",text:(0,f.aT)(e.login.data.engine,u.trans.invoice_customer()).sql,values:[y.customer_id]}]},t.next=59,r.requestData("/view",T);case 59:if(!(N=t.sent).error){t.next=62;break}return t.abrupt("return",r.resultError(N));case 62:N.fields.length>0&&Object.keys(N.fields[0]).forEach((function(e){Z=S(Z,e,y.id,N.fields[0][e])}));case 63:if(!(Z.length>0)){t.next=70;break}return t.next=66,r.requestData("/fieldvalue",{method:"POST",data:Z});case 66:if(!(w=t.sent).error){t.next=70;break}return r.resultError(w),t.abrupt("return",null);case 70:if("link"!==b&&"reflink"!==b){t.next=78;break}return E=p()(i({tablename:"link"}),{$merge:{nervatype_1:e.edit.dataset.groups.filter((function(e){return"nervatype"===e.groupname&&"trans"===e.groupvalue}))[0].id,ref_id_1:y.id,nervatype_2:e.edit.dataset.groups.filter((function(e){return"nervatype"===e.groupname&&"trans"===e.groupvalue}))[0].id,ref_id_2:s.id}}),t.next=74,r.requestData("/link",{method:"POST",data:[E]});case 74:if(!(w=t.sent).error){t.next=78;break}return r.resultError(w),t.abrupt("return",null);case 78:if($=[],"invoice"===l||"receipt"===l?(q=function(e,t,r){var n=0;return e.forEach((function(e){e.product_id===t&&e.deposit===r&&(n+=e.qty)})),n},I=function(e,t,r){return e.netamount=d(e.fxprice*(1-e.discount/100)*e.qty,r),e.vatamount=d(e.fxprice*(1-e.discount/100)*e.qty*t,r),e.amount=d(e.netamount+e.vatamount,r),e},C={},n.from_inventory&&e.edit.dataset.transitem_invoice?e.edit.dataset.transitem_shipping.forEach((function(t){var r=e.edit.dataset.item.filter((function(e){return e.id===t.id}))[0];if("undefined"!==typeof r){var n=t.sqty;if("out"===e.edit.dataset.groups.filter((function(e){return e.id===s.direction}))[0].groupvalue&&(n=-t.sqty),0===r.deleted&&n>0&&(Object.keys(C).includes(r.product_id)||(n-=q(e.edit.dataset.transitem_invoice,r.product_id,0),C[r.product_id]=!0),0!==n)){var a=F("item",r);a.qty=n,a=I(a,r.rate,s.digit),$.push(a)}}})):e.edit.dataset.item.forEach((function(t){if(0===t.deleted)if(n.netto_qty&&e.edit.dataset.transitem_invoice){var r=t.qty;if(Object.keys(C).includes(t.product_id)||(r-=q(e.edit.dataset.transitem_invoice,t.product_id,0),C[t.product_id]=!0),0!==r){var a=F("item",t);a.qty=r,a=I(a,t.rate,s.digit),$.push(a)}}else $.push(F("item",t))})),$.forEach((function(t){if(1===t.deposit){var r=q(e.edit.dataset.transitem_invoice,t.product_id,1);if(0!==r){var n=F("item",t);n.qty=-r,$.unshift(n)}}}))):e.edit.dataset.item.forEach((function(e){0===e.deleted&&$.push(F("item",e))})),$.forEach((function(e){if(e.id=null,e.trans_id=y.id,e.ownstock=0,"invoice"!==l&&"receipt"!==l&&(e.deposit=0),"cancellation"===n.transcast&&(e.qty=-e.qty,e.netamount=-e.netamount,e.vatamount=-e.vatamount,e.amount=-e.amount),"amendment"===n.transcast){var t=F("item",e);t.qty=-t.qty,t.netamount=-t.netamount,t.vatamount=-t.vatamount,t.amount=-t.amount,$.push(t)}})),!($.length>0)){t.next=88;break}return t.next=84,r.requestData("/item",{method:"POST",data:$});case 84:if(!(w=t.sent).error){t.next=88;break}return r.resultError(w),t.abrupt("return",null);case 88:if(O=[],e.edit.dataset.payment.forEach((function(e){if(0===e.deleted){var t=F("payment",e);t.id=null,t.trans_id=y.id,"cancellation"===n.transcast&&(t.amount=-t.amount),O.push(t)}})),!(O.length>0)){t.next=97;break}return t.next=93,r.requestData("/payment",{method:"POST",data:O});case 93:if(!(w=t.sent).error){t.next=97;break}return r.resultError(w),t.abrupt("return",null);case 97:if(P=[],R=[],"formula"!==l&&"production"!==l||((L=F("movement",e.edit.dataset.movement_head[0])).id=null,L.trans_id=y.id,P.push(L)),(e.edit.dataset.movement||[]).forEach((function(e){if(0===e.deleted){(e.item_id||e.ref_id)&&R.push({id:e.id,item_id:e.item_id,ref_id:e.ref_id});var t=F("movement",e);t.id=null,t.trans_id=y.id,"cancellation"===n.transcast&&(t.qty=-t.qty),P.push(t)}})),!(P.length>0)){t.next=121;break}return t.next=105,r.requestData("/movement",{method:"POST",data:P});case 105:if(!(w=t.sent).error){t.next=109;break}return r.resultError(w),t.abrupt("return",null);case 109:for(A=[],W=e.edit.dataset.groups.filter((function(e){return"nervatype"===e.groupname&&"movement"===e.groupvalue}))[0].id,M=e.edit.dataset.groups.filter((function(e){return"nervatype"===e.groupname&&"item"===e.groupvalue}))[0].id,U=function(t){var r=p()(i({tablename:"link"}),{$merge:{nervatype_1:W}});null!==R[t].item_id?(r.ref_id_1=w[t].id,r.nervatype_2=M,r.ref_id_2=R[t].item_id,A.push(r)):null!==R[t].ref_id&&(r.ref_id_1=w[e.edit.dataset.movement.findIndex((function(e){return e.id===R[t].ref_id}))].id,r.nervatype_2=W,r.ref_id_2=w[e.edit.dataset.movement.findIndex((function(e){return e.id===R[t].id}))].id,A.push(r))},z=0;z<R.length;z++)U(z);if(!(A.length>0)){t.next=121;break}return t.next=117,r.requestData("/link",{method:"POST",data:A});case 117:if(!(w=t.sent).error){t.next=121;break}return r.resultError(w),t.abrupt("return",null);case 121:return t.next=123,r.createHistory("save");case 123:D({ntype:"trans",ttype:l,id:y.id});case 124:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),M=function(a,l,o){var m=function(l){switch(l){case"LOAD_EDITOR":D(a);break;case"SET_EDITOR_ITEM":C(a);break;case"LOAD_FORMULA":t("current",{modalForm:(0,R.jsx)(W,{formula:"",partnumber:e.edit.dataset.movement_head[0].partnumber,description:e.edit.dataset.movement_head[0].description,formulaValues:e.edit.dataset.formula_head.map((function(e){return{value:String(e.id),text:e.transnumber}})),getText:r.getText,onClose:function(){return t("current",{modalForm:null})},onFormula:function(a){t("current",{modalForm:null},(function(){!function(a){t("current",{modalForm:(0,R.jsx)(N.default,{title:r.getText("msg_warning"),message:r.getText("ms_load_formula"),infoText:r.getText("msg_delete_info")+" "+r.getText("ms_continue_warning"),defaultOK:!0,labelOK:r.getText("msg_ok"),labelCancel:r.getText("msg_cancel"),onCancel:function(){t("current",{modalForm:null})},onOK:function(s){t("current",{modalForm:null},(0,n.Z)(c().mark((function n(){var s,l,o,m,v,x,g,_,y;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s={method:"POST",data:[{key:"formula",text:(0,f.aT)(e.login.data.engine,u.trans.formula_items()).sql,values:[a]}]},n.next=3,r.requestData("/view",s);case 3:if(!(l=n.sent).error){n.next=6;break}return n.abrupt("return",r.resultError(l));case 6:o=e.edit.dataset.movement_head[0].qty,m=e.edit.dataset.movement_head[0].place_id,v=e.edit.dataset.formula_head.filter((function(e){return e.id===a}))[0].qty,x=[],l.formula.forEach((function(t){var r=p()(i({tablename:"movement",dataset:e.edit.dataset,current:e.edit.current}),{$merge:{product_id:t.product_id,place_id:null===t.place_id?m:t.place_id,qty:1===t.shared?-Math.ceil(o/v):-d(o/v*t.qty,2)}});x.push(r)})),g=0;case 12:if(!(g<e.edit.dataset.movement.length)){n.next=21;break}return n.next=15,r.requestData("/movement",{method:"DELETE",query:{id:e.edit.dataset.movement[g].id}});case 15:if(!(_=n.sent)||!_.error){n.next=18;break}return n.abrupt("return",r.resultError(_));case 18:g++,n.next=12;break;case 21:return n.next=23,r.requestData("/movement",{method:"POST",data:x});case 23:if(!(y=n.sent).error){n.next=26;break}return n.abrupt("return",r.resultError(y));case 26:t("current",{modalForm:null},(function(){D({ntype:e.edit.current.type,ttype:e.edit.current.transtype,id:e.edit.current.item.id,form:"movement"})}));case 27:case"end":return n.stop()}}),n)}))))}})})}(a)}))}}),side:"hide"});break;case"NEW_FIELDVALUE":!function(t){var a=function(){var t=(0,n.Z)(c().mark((function t(n){var a,i;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={method:"POST",data:[n]},t.next=3,r.requestData("/fieldvalue",a);case 3:if(!(i=t.sent).error){t.next=6;break}return t.abrupt("return",r.resultError(i));case 6:D({ntype:e.edit.current.type,ttype:e.edit.current.transtype,id:e.edit.current.item.id,form:"fieldvalue",form_id:i[0]});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();if(""===t)return r.showToast({type:"error",title:r.getText("msg_warning"),message:r.getText("fields_deffield_missing")});var s=e.edit.dataset.deffield.filter((function(e){return e.fieldname===t}))[0],l=e.login.data.groups.filter((function(e){return e.id===s.fieldtype}))[0].groupvalue,o=p()(i({tablename:"fieldvalue"}),{$merge:{id:null,fieldname:s.fieldname}}),u=!1;switch(l){case"bool":o=p()(o,{$merge:{value:"false"}});break;case"date":o=p()(o,{$merge:{value:(0,v.Z)(new Date,{representation:"date"})}});break;case"time":o=p()(o,{$merge:{value:"00:00"}});break;case"float":case"integer":o=p()(o,{$merge:{value:"0"}});break;case"valuelist":o=p()(o,{$merge:{value:s.valuelist.split("|")[0]}});break;case"customer":case"tool":case"trans":case"transitem":case"transmovement":case"transpayment":case"product":case"project":case"employee":case"place":u=!0}u?r.onSelector(l,"",(function(e,t){var r=e.id.split("/");o=p()(o,{$merge:{value:String(parseInt(r[2],10))}}),a(o)})):a(o)}(a.fieldname);break;case"CREATE_TRANS":A(a);break;case"CREATE_TRANS_OPTIONS":!function(){var n=p()(e.edit,{}),a={directions:["in","out"],baseTranstype:n.current.transtype,transtype:n.current.transtype,direction:n.dataset.groups.filter((function(e){return e.id===n.current.item.direction}))[0].groupvalue,elementCount:parseInt(n.dataset.element_count[0].pec,10),doctypes:["order","worksheet","rent","invoice","receipt"],refno:!0,netto:!0,from:!1,nettoDiv:!1,fromDiv:!1};switch(a.transtype){case"offer":a.doctypes=["offer","order","worksheet","rent"],a.transtype="order",a.nettoDiv=!1,a.fromDiv=!1;break;case"order":case"worksheet":case"rent":a.doctypes=["offer","order","worksheet","rent","invoice","receipt"],a.transtype="invoice",a.nettoDiv=!0,0===a.elementCount?a.fromDiv=!0:a.fromDiv=!1;break;case"invoice":a.doctypes=["order","worksheet","rent","invoice","receipt"],a.transtype="order",a.nettoDiv=!1,a.fromDiv=!1;break;default:a.transtype="order"}t("current",{modalForm:(0,R.jsx)(fe,(0,s.Z)((0,s.Z)({},a),{},{getText:r.getText,onClose:function(){return t("current",{modalForm:null})},onCreate:function(e){t("current",{modalForm:null},(function(){A({cmdtype:"create",transcast:"normal",new_transtype:e.newTranstype,new_direction:e.newDirection,refno:e.refno,from_inventory:e.fromInventory,netto_qty:e.nettoQty})}))}})),side:"hide"})}();break;case"FORM_ACTIONS":H(a)}};!0===e.edit.dirty&&e.edit.current.item||!0===e.edit.dirty&&"template"===e.edit.current.type||!0===e.edit.form_dirty&&e.edit.current.form?t("current",{modalForm:(0,R.jsx)(N.default,{title:r.getText("msg_warning"),message:r.getText("msg_dirty_text"),infoText:r.getText("msg_delete_info"),defaultOK:!0,labelOK:r.getText("msg_save"),labelCancel:r.getText("msg_cancel"),onCancel:function(){t("current",{modalForm:null},(function(){o?t("edit",{dirty:!1,form_dirty:!1},(function(){m(o)})):m(l)}))},onOK:function(r){t("current",{modalForm:null},(0,n.Z)(c().mark((function r(){var n;return c().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=!1,!e.edit.form_dirty){r.next=7;break}return r.next=4,P();case 4:n=r.sent,r.next=13;break;case 7:if("template"!==e.edit.current.type){r.next=10;break}r.next=13;break;case 10:return r.next=12,L();case 12:n=r.sent;case 13:if(!n){r.next=15;break}return r.abrupt("return",t("edit",n,(function(){m(l)})));case 15:return r.abrupt("return",m(o));case 16:case"end":return r.stop()}}),r)}))))}}),side:"hide"}):m(o||l)},U=function(){var t=(0,n.Z)(c().mark((function t(n,a,i){var s,l;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("trans"!==n.ntype&&"transitem"!==n.ntype&&"transmovement"!==n.ntype&&"transpayment"!==n.ntype||null!==n.ttype){t.next=10;break}return s={method:"POST",data:[{key:"transtype",text:(0,f.aT)(e.login.data.engine,{select:["groupvalue"],from:"groups g",inner_join:["trans t","on",[["g.id","=","t.transtype"],["and","t.id","=","?"]]]}).sql,values:[n.id]}]},t.next=4,r.requestData("/view",s);case 4:if(!(l=t.sent).error){t.next=7;break}return t.abrupt("return",r.resultError(l));case 7:M({ntype:"trans",ttype:l.transtype[0].groupvalue,id:n.id},a,i),t.next=11;break;case 10:M(n,a,i);case 11:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}(),z=function(){var a=(0,n.Z)(c().mark((function n(a){var i,s;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i={method:"POST",data:[{key:"stock",text:(0,f.aT)(e.login.data.engine,u.trans.shipping_stock()).sql,values:[a.product_id]}]},n.next=3,r.requestData("/view",i);case 3:if(!(s=n.sent).error){n.next=6;break}return n.abrupt("return",r.resultError(s));case 6:0===s.stock.length&&r.showToast({type:"info",title:r.getText("msg_warning"),message:r.getText("ms_no_stock")}),t("current",{modalForm:(0,R.jsx)(ie,{partnumber:a.partnumber,partname:a.partname,rows:s.stock,getText:r.getText,onClose:function(){return t("current",{modalForm:null})}})});case 8:case"end":return n.stop()}}),n)})));return function(e){return a.apply(this,arguments)}}(),V=function(){var e=(0,n.Z)(c().mark((function e(t,r){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.current.item,e.next=3,E({type:n.mode,template:r.reportkey,title:r.refnumber,orient:n.orientation,size:n.size,copy:r.copies,nervatype:r.typename,id:r.ref_id});case 3:O({fkey:"items",table:"ui_printqueue",id:r.id,prompt:!0});case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),H=function(n,i){var s=n.row||{},l=i||e.edit;switch(n.params.action){case"loadEditor":M({ntype:n.params.ntype||l.current.type,ttype:n.params.ttype||l.current.transtype,id:s.id||null},"LOAD_EDITOR");break;case"newEditorItem":M({fkey:n.params.fkey,id:null},"SET_EDITOR_ITEM");break;case"editEditorItem":C({fkey:n.params.fkey,id:s.id});break;case"deleteEditorItem":O({fkey:n.params.fkey,table:n.params.table,id:s.id});break;case"loadShipping":M({ntype:n.params.ntype||l.current.type,ttype:n.params.ttype||l.current.transtype,id:n.params.id||l.current.item.id,shipping:!0},"LOAD_EDITOR");break;case"addShippingRow":!0!==s.edited&&(l=p()(l,{dataset:{shiptemp:{$push:[{id:s.item_id+"-"+s.product_id,item_id:s.item_id,product_id:s.product_id,product:s.product,partnumber:s.partnumber,partname:s.partname,unit:s.unit,batch_no:"",qty:s.diff,diff:0,oqty:s.qty,tqty:s.tqty}]}}}),I({shipping:!0,form:"shipping_items"},l.template,l));break;case"showShippingStock":z({product_id:s.product_id,partnumber:s.partnumber,partname:s.partname});break;case"editShippingRow":t("current",{modalForm:(0,R.jsx)(G,{partnumber:s.partnumber,description:s.product,unit:s.unit,batch_no:s.batch_no,qty:s.qty,getText:r.getText,onClose:function(){return t("current",{modalForm:null})},onShipping:function(e,r){t("current",{modalForm:null},(function(){var n=l.dataset.shiptemp.findIndex((function(e){return e.id===s.id}));l=p()(l,{dataset:{shiptemp:(0,a.Z)({},n,{$merge:{batch_no:e,qty:r,diff:s.oqty-(s.tqty+r)}})}}),t("edit",l)}))}})});break;case"deleteShippingRow":var o=l.dataset.shiptemp.findIndex((function(e){return e.id===s.id}));l=p()(l,{dataset:{shiptemp:{$splice:[[o,1]]}}}),I({shipping:!0,form:"shiptemp_items"},l.template,l);break;case"exportQueueItem":V(l,s)}},B=function(t,r){switch(e.login.data.transfilterName){case"usergroup":t.where.push(["and","cruser_id","in",[{select:["id"],from:"employee",where:["usergroup","=","?"]}]]),r.push(e.login.data.employee.usergroup);break;case"own":t.where.push(["and","cruser_id","=","?"]),r.push(e.login.data.employee.id)}return[t,r]},Q=function(){var t=(0,n.Z)(c().mark((function t(){var n,a,i,s,l,o,u;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("trans"===e.edit.current.type&&null!==e.edit.current.item.id){t.next=2;break}return t.abrupt("return");case 2:return n=e.edit.current.transtype,a=e.edit.dataset.groups.filter((function(t){return t.id===e.edit.current.item.direction}))[0].groupvalue,i={select:["max(id) as id"],from:"trans",where:[["transtype","=","?"]]},s=[e.edit.current.item.transtype],"cash"!==n&&"waybill"!==n&&(i.where.push(["and","direction","=","?"]),s.push(e.edit.current.item.direction)),null!==e.edit.current.item.id&&(i.where.push(["and","id","<","?"]),s.push(e.edit.current.item.id)),"invoice"===n&&"out"===a||"receipt"===n&&"out"===a||"cash"===n||i.where.push(["and","deleted","=","0"]),l=B(i,s),o={method:"POST",data:[{key:"prev",text:(0,f.aT)(e.login.data.engine,l[0]).sql,values:l[1]}]},t.next=13,r.requestData("/view",o);case 13:if(!(u=t.sent).error){t.next=16;break}return t.abrupt("return",r.resultError(u));case 16:null!==u.prev[0].id&&M({ntype:"trans",ttype:n,id:u.prev[0].id},"LOAD_EDITOR");case 17:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),X=function(){var t=(0,n.Z)(c().mark((function t(){var n,a,i,s,l,o,u;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.edit.current.transtype,a=e.edit.dataset.groups.filter((function(t){return t.id===e.edit.current.item.direction}))[0].groupvalue,i={select:["min(id) as id"],from:"trans",where:[["transtype","=","?"],["and","id",">","?"]]},s=[e.edit.current.item.transtype,e.edit.current.item.id],"cash"!==n&&"waybill"!==n&&(i.where.push(["and","direction","=","?"]),s.push(e.edit.current.item.direction)),"invoice"===n&&"out"===a||"receipt"===n&&"out"===a||"cash"===n||i.where.push(["and","deleted","=","0"]),l=B(i,s),o={method:"POST",data:[{key:"next",text:(0,f.aT)(e.login.data.engine,l[0]).sql,values:l[1]}]},t.next=10,r.requestData("/view",o);case 10:if(!(u=t.sent).error){t.next=13;break}return t.abrupt("return",r.resultError(u));case 13:if(null!==u.next[0].id){t.next=21;break}if("delivery"!==n||"transfer"===a){t.next=18;break}return t.abrupt("return");case 18:M({ntype:"trans",ttype:n,id:null},"LOAD_EDITOR");case 19:t.next=22;break;case 21:M({ntype:"trans",ttype:n,id:u.next[0].id},"LOAD_EDITOR");case 22:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Y=function(){var t=(0,n.Z)(c().mark((function t(){var n,a,s,l,o,u,d,m;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==e.edit.current.shipping_place_id){t.next=2;break}return t.abrupt("return",r.showToast({type:"error",title:r.getText("msg_warning"),message:r.getText("msg_required")+" "+r.getText("inventory_warehouse")}));case 2:if(!(e.edit.dataset.shiptemp.length>0)){t.next=42;break}return n=p()(i({tablename:"trans",dataset:e.edit.dataset,current:e.edit.current}),{$merge:{transtype:e.edit.dataset.groups.filter((function(e){return"transtype"===e.groupname&&"delivery"===e.groupvalue}))[0].id,direction:e.edit.dataset[e.edit.current.type][0].direction,transdate:(0,v.Z)((0,g.Z)(e.edit.current.item.shippingdate),{representation:"date"}),duedate:null,curr:null,paidtype:null}}),"undefined"!==typeof(a=e.edit.dataset.delivery_pattern.filter((function(e){return 1===e.defpattern}))[0])&&(n=p()(n,{$merge:{fnote:a.notes}})),s={method:"POST",data:{key:"nextNumber",values:{numberkey:"delivery_"+e.edit.current.direction,step:!0}}},t.next=9,r.requestData("/function",s);case 9:if(!(l=t.sent).error){t.next=13;break}return r.resultError(l),t.abrupt("return",null);case 13:return n=p()(n,{$merge:{transnumber:l}}),t.next=16,r.requestData("/trans",{method:"POST",data:[n]});case 16:if(!(l=t.sent).error){t.next=20;break}return r.resultError(l),t.abrupt("return",null);case 20:return n.id=l[0],t.next=23,r.createHistory("save");case 23:return o=[],e.edit.dataset.shiptemp.forEach((function(t){var r=p()(i({tablename:"movement",dataset:e.edit.dataset,current:e.edit.current}),{$merge:{trans_id:n.id,shippingdate:(0,v.Z)((0,g.Z)(e.edit.current.shippingdate)),product_id:t.product_id,place_id:e.edit.current.shipping_place_id,notes:t.batch_no,qty:"out"===e.edit.current.direction?-t.qty:t.qty}});o.push(r)})),t.next=27,r.requestData("/movement",{method:"POST",data:o});case 27:if(!(l=t.sent).error){t.next=31;break}return r.resultError(l),t.abrupt("return",null);case 31:return u=[],d=e.edit.dataset.groups.filter((function(e){return"nervatype"===e.groupname&&"movement"===e.groupvalue}))[0].id,m=e.edit.dataset.groups.filter((function(e){return"nervatype"===e.groupname&&"item"===e.groupvalue}))[0].id,l.forEach((function(t,r){var n=p()(i({tablename:"link",dataset:e.edit.dataset,current:e.edit.current}),{$merge:{nervatype_1:d,ref_id_1:t,nervatype_2:m,ref_id_2:e.edit.dataset.shiptemp[r].item_id}});u.push(n)})),t.next=37,r.requestData("/link",{method:"POST",data:u});case 37:if(!(l=t.sent).error){t.next=41;break}return r.resultError(l),t.abrupt("return",null);case 41:D({ntype:e.edit.current.type,ttype:e.edit.current.transtype,id:e.edit.current.item.id,shipping:!0});case 42:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),J=function(){var e=(0,n.Z)(c().mark((function e(t,n){var a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"POST",data:{key:"getPriceValue",values:{vendorprice:n.vendorprice,product_id:n.product_id,posdate:t.transdate,curr:t.curr,qty:n.qty,customer_id:t.customer_id}}},e.abrupt("return",r.requestData("/function",a));case 2:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),ee=function(t,r){var n=e.edit.dataset.tax.filter((function(e){return e.id===parseInt(r.tax_id,10)}))[0];n="undefined"!==typeof n?n.rate:0;var a=e.edit.dataset.currency.filter((function(t){return t.curr===e.edit.current.item.curr}))[0];a="undefined"!==typeof a?a.digit:2;var i=0,s=0,l=0,o=0;switch(t){case"fxprice":o=parseFloat(r.fxprice),i=d(o*(1-parseFloat(r.discount)/100)*parseFloat(r.qty),parseInt(a,10)),s=d(o*(1-parseFloat(r.discount)/100)*parseFloat(r.qty)*parseFloat(n),parseInt(a,10)),l=d(i+s,parseInt(a,10));break;case"netamount":i=parseFloat(r.netamount),0!==parseFloat(r.qty)&&(o=d(i/(1-parseFloat(r.discount)/100)/parseFloat(r.qty),parseInt(a,10)),s=d(i*parseFloat(n),parseInt(a,10))),l=d(i+s,parseInt(a,10));break;case"amount":l=parseFloat(r.amount),0!==parseFloat(r.qty)&&(i=d(l/(1+parseFloat(n)),parseInt(a,10)),s=d(l-i,parseInt(a,10)),o=d(i/(1-parseFloat(r.discount)/100)/parseFloat(r.qty),parseInt(a,10)))}return p()(r,{$merge:{fxprice:o,netamount:i,vatamount:s,amount:l}})},te=function(){var e=(0,n.Z)(c().mark((function e(n,i){var s,l,o,u,d,m,f;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=p()({},{$set:i}),"fieldvalue_value"!==n.name&&"fieldvalue_notes"!==n.name&&"fieldvalue_deleted"!==n.name){e.next=6;break}(l=s.current.fieldvalue.findIndex((function(e){return e.id===n.id})))>-1&&("all"===s.audit||"update"===s.audit)&&(s=p()(s,{$merge:{dirty:!0}}),s=p()(s,{current:{fieldvalue:(0,a.Z)({},l,{$merge:(0,a.Z)({},n.name.split("_")[1],"fieldvalue_deleted"===n.name?1:n.value.toString())})}})),e.next=97;break;case 6:if(!s.current.form){e.next=53;break}"undefined"!==typeof(s=p()(s,{$merge:{form_dirty:!0}})).current.form[n.name]&&(s=p()(s,{current:{form:{$merge:(0,a.Z)({},n.name,n.value)}}})),e.t0=s.current.form_type,e.next="item"===e.t0?12:"price"===e.t0||"discount"===e.t0?44:"invoice_link"===e.t0?46:"payment_link"===e.t0?48:50;break;case 12:if("product_id"!==n.name||"undefined"===typeof n.item){e.next=24;break}return 0===(s=p()(s,{current:{form:{$merge:{description:n.item.description,unit:n.item.unit,tax_id:parseInt(n.item.tax_id,10)}}}})).current.form.qty&&(s=p()(s,{current:{form:{$merge:{qty:1}}}})),e.next=17,J(s.current.item,s.current.form);case 17:if(!(o=e.sent).error){e.next=20;break}return e.abrupt("return",r.resultError(o));case 20:s=p()(s,{current:{form:{$merge:{fxprice:isNaN(parseFloat(o.price))?0:parseFloat(o.price),discount:isNaN(parseFloat(o.discount))?0:parseFloat(o.discount)}}}}),"blur"===n.event_type&&(s=p()(s,{current:{$merge:{form:ee("fxprice",s.current.form)}}})),e.next=43;break;case 24:e.t1=n.name,e.next="qty"===e.t1?27:"fxprice"===e.t1||"tax_id"===e.t1||"discount"===e.t1?36:"amount"===e.t1?38:"netamount"===e.t1?40:42;break;case 27:if(0!==parseFloat(s.current.form.fxprice)){e.next=34;break}return e.next=30,J(s.current.item,s.current.form);case 30:if(!(u=e.sent).error){e.next=33;break}return e.abrupt("return",r.resultError(u));case 33:s=p()(s,{current:{form:{$merge:{fxprice:isNaN(parseFloat(u.price))?0:parseFloat(u.price),discount:isNaN(parseFloat(u.discount))?0:parseFloat(u.discount)}}}});case 34:case 36:return"blur"===n.event_type&&(s=p()(s,{current:{$merge:{form:ee("fxprice",s.current.form)}}})),e.abrupt("break",43);case 38:return"blur"===n.event_type&&(s=p()(s,{current:{$merge:{form:ee("amount",s.current.form)}}})),e.abrupt("break",43);case 40:return"blur"===n.event_type&&(s=p()(s,{current:{$merge:{form:ee("netamount",s.current.form)}}})),e.abrupt("break",43);case 42:return e.abrupt("break",43);case 43:return e.abrupt("break",51);case 44:return"customer_id"===n.name&&(s=p()(s,{current:{$merge:{price_customer_id:n.value}}})),e.abrupt("break",51);case 46:return"ref_id_1"===n.name&&"undefined"!==typeof n.item?s=p()(s,{current:{invoice_link:{0:{$merge:{curr:n.item.curr}}}}}):"link_qty"!==n.name&&"link_rate"!==n.name||(s=p()(s,{current:{$merge:{invoice_link_fieldvalue:S(s.current.invoice_link_fieldvalue,n.name,s.current.form.id,null,n.value)}}})),e.abrupt("break",51);case 48:return"ref_id_2"===n.name&&"undefined"!==typeof n.item?s=p()(s,{current:{payment_link:{0:{$merge:{curr:n.item.curr}}}}}):"link_qty"!==n.name&&"link_rate"!==n.name||(s=p()(s,{current:{$merge:{payment_link_fieldvalue:S(s.current.payment_link_fieldvalue,n.name,s.current.form.id,null,n.value)}}})),e.abrupt("break",51);case 50:return e.abrupt("break",51);case 51:e.next=97;break;case 53:"undefined"!==typeof s.current.item[n.name]&&!1===n.extend?(s=p()(s,{current:{item:{$merge:(0,a.Z)({},n.name,n.value)}}}),n.label_field&&(s=p()(s,{current:{item:{$merge:(0,a.Z)({},n.label_field,n.refnumber||null)}}}))):"undefined"!==typeof s.template.options.extend&&!0===n.extend&&(s=p()(s,{current:{extend:{$merge:(0,a.Z)({},n.name,n.value)}}})),"all"!==s.audit&&"update"!==s.audit||(s=p()(s,{$merge:{dirty:!0}})),e.t2=s.current.type,e.next="report"===e.t2?58:"printqueue"===e.t2?61:"trans"===e.t2?64:96;break;case 58:return s=p()(s,{$merge:{dirty:!1}}),"selected"===n.name?(d=s.current.fieldvalue.findIndex((function(e){return e.id===n.id})))>-1&&(s=p()(s,{current:{fieldvalue:(0,a.Z)({},d,{$merge:{selected:n.value}})}})):(m=s.current.fieldvalue.findIndex((function(e){return e.name===n.name})))>-1&&(s=p()(s,{current:{fieldvalue:(0,a.Z)({},m,{$merge:{value:n.value}})}})),e.abrupt("break",97);case 61:return s=p()(s,{$merge:{dirty:!1}}),s=p()(s,{printqueue:{$merge:(0,a.Z)({},n.name,n.value)}}),e.abrupt("break",97);case 64:e.t3=n.name,e.next="closed"===e.t3?67:"paiddate"===e.t3?69:"direction"===e.t3?71:"seltype"===e.t3?73:"ref_id"===e.t3?75:"trans_wsdistance"===e.t3||"trans_wsrepair"===e.t3||"trans_wstotal"===e.t3||"trans_reholiday"===e.t3||"trans_rebadtool"===e.t3||"trans_reother"===e.t3||"trans_wsnote"===e.t3||"trans_rentnote"===e.t3?87:"shippingdate"===e.t3||"shipping_place_id"===e.t3?89:"fnote"===e.t3?92:94;break;case 67:return 1===n.value&&t("current",{modalForm:(0,R.jsx)(N.default,{title:r.getText("msg_warning"),message:r.getText("msg_close_text"),infoText:r.getText("msg_delete_info"),labelOK:r.getText("msg_ok"),labelCancel:r.getText("msg_cancel"),onCancel:function(){t("current",{modalForm:null},(function(){s=p()(s,{current:{item:{$merge:(0,a.Z)({},n.name,0)}}}),t("edit",s)}))},onOK:function(e){t("current",{modalForm:null},(function(){s=p()(s,{current:{$merge:{closed:1}}}),t("edit",s)}))}})}),e.abrupt("break",95);case 69:return s=p()(s,{current:{item:{$merge:{transdate:n.value}}}}),e.abrupt("break",95);case 71:return"cash"===s.current.transtype&&(f=s.dataset.groups.filter((function(e){return e.id===n.value}))[0].groupvalue,s=p()(s,{template:{options:{$merge:{opposite:"out"===f}}}})),e.abrupt("break",95);case 73:return s=p()(s,{current:{extend:{$merge:{seltype:n.value,ref_id:null,refnumber:""}},item:{$merge:{customer_id:null,employee_id:null,ref_transnumber:null}}}}),e.abrupt("break",95);case 75:s=p()(s,{current:{extend:{$merge:{refnumber:n.refnumber,ntype:"transitem"===s.current.extend.seltype?"trans":s.current.extend.seltype,transtype:n.item&&n.item.transtype?n.item.transtype.split("-")[0]:""}}}}),e.t4=s.current.extend.seltype,e.next="customer"===e.t4?79:"employee"===e.t4?81:"transitem"===e.t4?83:85;break;case 79:return s=p()(s,{current:{item:{$merge:{customer_id:n.value}}}}),e.abrupt("break",86);case 81:return s=p()(s,{current:{item:{$merge:{employee_id:n.value}}}}),e.abrupt("break",86);case 83:return s=p()(s,{current:{item:{$merge:{ref_transnumber:n.refnumber}}}}),e.abrupt("break",86);case 85:return e.abrupt("break",86);case 86:return e.abrupt("break",95);case 87:return s=p()(s,{current:{$merge:{fieldvalue:S(s.current.fieldvalue,n.name,s.current.item.id,null,n.value)}}}),e.abrupt("break",95);case 89:return s=p()(s,{$merge:{dirty:!1}}),s=p()(s,{current:{$merge:(0,a.Z)({},n.name,n.value)}}),e.abrupt("break",95);case 92:return s=p()(s,{current:{item:{$merge:{fnote:n.value}}}}),e.abrupt("break",95);case 94:return e.abrupt("break",95);case 95:case 96:return e.abrupt("break",97);case 97:t("edit",s);case 98:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();return{round:d,createReport:q,exportQueueAll:function(){var a=e.edit.current.item;if(e.edit.dataset.items.length>0){if("print"===a.mode)return r.showToast({type:"error",title:r.getText("msg_warning"),message:r.getText("ms_export_invalid")+" "+r.getText("printqueue_mode_print")});t("current",{modalForm:(0,R.jsx)(N.default,{title:r.getText("msg_warning"),message:r.getText("label_export_all_selected"),infoText:r.getText("msg_delete_info")+" "+r.getText("ms_continue_warning"),defaultOK:!0,labelOK:r.getText("msg_ok"),labelCancel:r.getText("msg_cancel"),onCancel:function(){t("current",{modalForm:null})},onOK:function(i){t("current",{modalForm:null},(0,n.Z)(c().mark((function t(){var n,i,s;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=0;case 1:if(!(n<e.edit.dataset.items.length)){t.next=15;break}return i=e.edit.dataset.items[n],t.next=5,E({type:a.mode,template:i.reportkey,title:i.refnumber,orient:a.orientation,size:a.size,copy:i.copies,nervatype:i.typename,id:i.ref_id});case 5:if(!(s=t.sent)){t.next=12;break}return t.next=9,r.requestData("/ui_printqueue",{method:"DELETE",query:{id:i.id}});case 9:if(!(s=t.sent)||!s.error){t.next=12;break}return t.abrupt("return",r.resultError(s));case 12:n++,t.next=1;break;case 15:$();case 16:case"end":return t.stop()}}),t)}))))}})})}},searchQueue:$,reportOutput:E,reportSettings:function(){var n="trans"===e.edit.current.type?e.edit.dataset.groups.filter((function(t){return t.id===e.edit.current.item.direction}))[0].groupvalue:"out",a="trans"===e.edit.current.type?e.edit.dataset.settings.filter((function(t){return t.fieldname==="default_trans_"+e.edit.current.transtype+"_"+n+"_report"}))[0]:e.edit.dataset.settings.filter((function(t){return t.fieldname==="default_"+e.edit.current.type+"_report"}))[0],i=[];e.edit.dataset.report.forEach((function(t){var r=e.login.data.audit.filter((function(e){return"report"===e.nervatypeName&&e.subtype===t.id}))[0];"disabled"!==(r=r?r.inputfilterName:"all")&&("trans"===e.edit.current.type?e.edit.current.item.direction===t.direction&&i.push({value:t.reportkey,text:t.repname}):i.push({value:t.reportkey,text:t.repname}))})),a="undefined"!==typeof a?a.value:i.length>0?i[0].value:"",t("current",{modalForm:(0,R.jsx)(je,{title:e.edit.current.item[e.edit.template.options.title_field],template:a,templates:i,orient:(0,T.$8)("page_orient"),size:(0,T.$8)("page_size"),copy:1,getText:r.getText,onClose:function(){return t("current",{modalForm:null})},onOutput:function(e){t("current",{modalForm:null},(function(){E(e)}))}}),side:"hide"})},checkEditor:M,checkTranstype:U,loadEditor:D,setEditor:I,setFormActions:H,deleteEditorItem:O,deleteEditor:function(){var a=function(){t("edit",{dataset:{},current:{},dirty:!1,form_dirty:!1}),t("current",{module:"search"})},i=function(){var t=(0,n.Z)(c().mark((function t(){var n;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.requestData("/"+e.edit.current.type,{method:"DELETE",query:{id:e.edit.current.item.id}});case 2:if(!(n=t.sent)||!n.error){t.next=5;break}return t.abrupt("return",r.resultError(n));case 5:return t.next=7,r.createHistory("delete");case 7:a();case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t("current",{modalForm:(0,R.jsx)(N.default,{title:r.getText("msg_warning"),message:r.getText("msg_delete_text"),infoText:r.getText("msg_delete_info"),labelOK:r.getText("msg_ok"),labelCancel:r.getText("msg_cancel"),onCancel:function(){t("current",{modalForm:null})},onOK:function(s){t("current",{modalForm:null},(0,n.Z)(c().mark((function t(){var n,s,l;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==e.edit.current.item.id){t.next=4;break}a(),t.next=16;break;case 4:if("undefined"===typeof u[e.edit.current.type].delete_state){t.next=15;break}return n=(0,f.aT)(e.login.data.engine,u[e.edit.current.type].delete_state()),s={method:"POST",data:[{key:"state",text:n.sql,values:Array(n.prmCount).fill(e.edit.current.item.id)}]},t.next=9,r.requestData("/view",s);case 9:if(!(l=t.sent).error){t.next=12;break}return t.abrupt("return",r.resultError(l));case 12:l.state[0].sco>0?r.showToast({type:"error",title:r.getText("msg_warning"),message:r.getText("msg_integrity_err")}):i(),t.next=16;break;case 15:i();case 16:case"end":return t.stop()}}),t)}))))}}),side:"hide"})},prevTransNumber:Q,nextTransNumber:X,setFieldvalue:S,saveEditorForm:P,saveEditor:L,createShipping:Y,exportEvent:function(){var t=e.edit.current.item,r="BEGIN:VCALENDAR\nPRODID:-//nervatura.com/NONSGML Nervatura Calendar//EN\nVERSION:2.0\nBEGIN:VEVENT\nUID:".concat(null!==t.uid?t.uid:(0,f.M8)());if(null!==t.fromdate&&(r+="\nDTSTART:".concat((0,y.Z)((0,g.Z)(t.fromdate),"yyyyMMdd'T'HHmmss"))),null!==t.todate&&(r+="\nDTEND:".concat((0,y.Z)((0,g.Z)(t.todate),"yyyyMMdd'T'HHmmss"))),null!==t.subject&&(r+="\nSUMMARY:".concat(t.subject)),null!==t.place&&(r+="\nLOCATION:".concat(t.place)),null!==t.description&&(r+="\nDESCRIPTION:".concat(t.description)),null!==t.eventgroup){var n=e.edit.dataset.eventgroup.filter((function(e){return e.id===t.eventgroup}))[0];"undefined"!==typeof n&&(r+="\nCATEGORY:".concat(n.groupvalue))}r+="\nEND:VEVENT\nEND:VCALENDAR";var a=t.calnumber.replace(/\//g,"_")+".ics",i=URL.createObjectURL(new Blob([r],{type:"text/ics;charset=utf-8;"}));(0,f.GX)(i,a)},editItem:te,setPattern:function(e,s){var l=e.key,o=function(){var e=(0,n.Z)(c().mark((function e(t){var n,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",data:t},e.next=3,r.requestData("/pattern",n);case 3:if(!(a=e.sent).error){e.next=6;break}return e.abrupt("return",r.resultError(a));case 6:M({ntype:s.current.type,ttype:s.current.transtype,id:s.current.item.id,form:"fnote"},"LOAD_EDITOR");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u={default:{title:r.getText("msg_warning"),message:r.getText("msg_pattern_default"),infoText:void 0,value:"",showValue:!1,defaultOK:!0,ok:function(e){var t=p()(s.dataset.pattern,{});t.forEach((function(e,r){t=p()(t,(0,a.Z)({},r,{$merge:{defpattern:e.id===parseInt(s.current.template,10)?1:0}}))})),o(t)}},save:{title:r.getText("msg_warning"),message:r.getText("msg_pattern_save"),infoText:void 0,value:"",showValue:!1,defaultOK:!0,ok:function(e){var t=s.dataset.pattern.filter((function(e){return e.id===parseInt(s.current.template,10)}))[0];t&&(t=p()(t,{$merge:{notes:s.current.item.fnote}}),o([t]))}},new:{title:r.getText("msg_pattern_new"),message:r.getText("msg_pattern_name"),infoText:void 0,value:"",showValue:!0,defaultOK:!1,ok:function(){var e=(0,n.Z)(c().mark((function e(t){var n,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===t){e.next=10;break}return e.next=3,r.requestData("/pattern",{query:{filter:"description;==;"+t}});case 3:if(!(n=e.sent).error){e.next=6;break}return e.abrupt("return",r.resultError(n));case 6:if(!(n.length>0)){e.next=8;break}return e.abrupt("return",r.showToast({type:"error",title:r.getText("msg_warning"),message:r.getText("msg_value_exists")}));case 8:a=p()(i({tablename:"pattern",current:s.current}),{$merge:{description:t,defpattern:0===s.dataset.pattern.length?1:0}}),o([a]);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},delete:{title:r.getText("msg_warning"),message:r.getText("msg_delete_text"),infoText:r.getText("msg_delete_info"),value:"",showValue:!1,defaultOK:!1,ok:function(e){var t=s.dataset.pattern.filter((function(e){return e.id===parseInt(s.current.template,10)}))[0];t&&(t=p()(t,{$merge:{deleted:1,defpattern:0}}),o([t]))}}};if("new"!==l&&(!s.current.template||""===s.current.template))return r.showToast({type:"error",title:r.getText("msg_warning"),message:r.getText("msg_pattern_missing")});if("load"===l){var d=s.dataset.pattern.filter((function(e){return e.id===parseInt(s.current.template,10)}))[0];if(d){var m=p()(s,{current:{item:{$merge:{fnote:d.notes}}}});m=p()(m,{$merge:{dirty:!0,lastUpdate:(new Date).getTime()}}),t("edit",m)}}else t("current",{modalForm:(0,R.jsx)(N.default,{title:u[l].title,message:u[l].message,infoText:u[l].infoText,value:u[l].value,showValue:u[l].showValue,defaultOK:u[l].defaultOK,labelOK:r.getText("msg_ok"),labelCancel:r.getText("msg_cancel"),onCancel:function(){t("current",{modalForm:null})},onOK:function(e){t("current",{modalForm:null},(function(){u[l].ok(e)}))}})})}}},Ze="Edit_sidebar__O3fIh",Te="Edit_selectButton__T5CP+",Ne="Edit_groupButton__5MlaL",Ee="Edit_itemButton__hd2wQ",$e="Edit_panelGroup__OZKBo",qe="Edit_panelButton__K3xnB",Ie="Edit_selected__vocq+",De="Edit_separator__LiEts",Ce="Edit_stateLabel__7cBdj",Oe=["side","newFilter","auditFilter","edit","module","forms","className","getText","onEvent"],Se=function(e){var t=e.side,r=e.newFilter,n=e.auditFilter,a=e.edit,l=e.module,o=e.forms,c=e.className,u=e.getText,d=e.onEvent,p=(0,E.Z)(e,Oe),m=l.current,f=l.form_dirty,v=l.dirty,x=l.panel,g=l.dataset,_=l.group_key,y=function(e,t,r,n,a){return(0,R.jsx)(S.Z,{id:e,className:t,disabled:a?"disabled":"",onClick:function(){return d.apply(void 0,(0,i.Z)(r))},value:n},e)},h=function(e,t,r,n){return(0,R.jsx)(S.Z,{id:e,className:t,onClick:function(){return d("changeData",["group_key",r])},value:n},e)},b=function(e){return e===_?Te:Ne};return(0,R.jsxs)("div",(0,s.Z)((0,s.Z)({},p),{},{className:"".concat(Ze," ").concat("auto"!==t?t:""," ").concat(c),children:[m.form||"transitem_shipping"===m.form_type?null:(0,R.jsxs)("div",{className:"row full section-small container",children:[(0,R.jsx)("div",{className:"cell half",children:y("state_new","full medium".concat(" ",a&&m.item?Ne:Te),["editState"],(0,R.jsx)(O.Z,{value:u("label_new"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Plus"}),iconWidth:"20px"}))}),(0,R.jsx)("div",{className:"cell half",children:y("state_edit","full medium".concat(" ",a&&m.item?Te:Ne),["editState"],(0,R.jsx)(O.Z,{value:u("label_edit"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Edit"}),iconWidth:"20px"}),!m.item)})]}),a&&m.form||a&&m.item?function(e){"undefined"===typeof e&&(e={});var t=[];if((!0===e.back||m.form)&&(t.push(y("cmd_back","medium".concat(" ",Ee," ").concat(Ie),["editorBack"],(0,R.jsx)(O.Z,{value:u("label_back"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Reply"}),iconWidth:"20px"}))),t.push((0,R.jsx)("div",{className:De},"back_sep"))),!0===e.arrow&&(t.push(y("cmd_arrow_left","full medium".concat(" ",Ee),["prevTransNumber"],(0,R.jsx)(O.Z,{value:u("label_previous"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"ArrowLeft"}),iconWidth:"20px"}))),t.push(y("cmd_arrow_right","full medium".concat(" ",Ee),["nextTransNumber"],(0,R.jsx)(O.Z,{value:u("label_next"),rightIcon:(0,R.jsx)(K.Z,{iconKey:"ArrowRight"}),iconWidth:"20px"}))),t.push((0,R.jsx)("div",{className:De},"arrow_sep"))),e.state&&"normal"!==e.state){var r="deleted"===e.state?"red":"cancellation"===e.state?"orange":"white",n=["closed","readonly"].includes(e.state)?"Lock":"ExclamationTriangle";t.push((0,R.jsx)("div",{className:"full padding-small large".concat(" ",Ce),children:(0,R.jsx)(O.Z,{value:u("label_"+e.state),style:{color:r},leftIcon:(0,R.jsx)(K.Z,{iconKey:n,color:r}),iconWidth:"25px"})},"cmd_state")),t.push((0,R.jsx)("div",{className:De},"state_sep"))}return!1!==e.save&&t.push(y("cmd_save","full medium".concat(" ",Ee," ").concat(m.form&&f||!m.form&&v?Ie:""),["saveEditor"],(0,R.jsx)(O.Z,{value:u("label_save"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Check"}),iconWidth:"20px"}))),!1!==e.delete&&"normal"===e.state&&t.push(y("cmd_delete","full medium".concat(" ",Ee),["editorDelete"],(0,R.jsx)(O.Z,{value:u("label_delete"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Times"}),iconWidth:"20px"}))),!1===e.new||"normal"!==e.state||m.form||t.push(y("cmd_new","full medium".concat(" ",Ee),["editorNew",[{}]],(0,R.jsx)(O.Z,{value:u("label_new"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Plus"}),iconWidth:"20px"}))),!0===e.trans&&(t.push((0,R.jsx)("div",{className:De},"trans_sep")),!1!==e.copy&&t.push(y("cmd_copy","full medium".concat(" ",Ee),["transCopy",["normal"]],(0,R.jsx)(O.Z,{value:u("label_copy"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Copy"}),iconWidth:"20px"}))),!1!==e.create&&t.push(y("cmd_create","full medium".concat(" ",Ee),["transCopy",["create"]],(0,R.jsx)(O.Z,{value:u("label_create"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Sitemap"}),iconWidth:"20px"}))),!0===e.corrective&&"normal"===e.state&&t.push(y("cmd_corrective","full medium".concat(" ",Ee),["transCopy",["amendment"]],(0,R.jsx)(O.Z,{value:u("label_corrective"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Share"}),iconWidth:"20px"}))),!0===e.cancellation&&"cancellation"!==e.state&&t.push(y("cmd_cancellation","full medium".concat(" ",Ee),["transCopy",["cancellation"]],(0,R.jsx)(O.Z,{value:u("label_cancellation"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Undo"}),iconWidth:"20px"}))),!0===e.formula&&t.push(y("cmd_formula","full medium".concat(" ",Ee),["checkEditor",[{},"LOAD_FORMULA",void 0]],(0,R.jsx)(O.Z,{value:u("label_formula"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Magic"}),iconWidth:"20px"})))),!0===e.link&&t.push(y("cmd_link","full medium".concat(" ",Ee),["setLink",[e.link_type,e.link_field]],(0,R.jsx)(O.Z,{value:e.link_label,leftIcon:(0,R.jsx)(K.Z,{iconKey:"Link"}),iconWidth:"20px"}))),!0===e.password&&t.push(y("cmd_password","full medium".concat(" ",Ee),["setPassword"],(0,R.jsx)(O.Z,{value:u("title_password"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Lock"}),iconWidth:"20px"}))),!0===e.shipping&&(t.push(y("cmd_shipping_all","full medium".concat(" ",Ee),["shippingAddAll"],(0,R.jsx)(O.Z,{value:u("shipping_all_label"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Plus"}),iconWidth:"20px"}))),t.push(y("cmd_shipping_create","full medium".concat(" ",Ee," ").concat(g.shiptemp.length>0?Ie:""),["createShipping"],(0,R.jsx)(O.Z,{value:u("shipping_create_label"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Check"}),iconWidth:"20px"})))),!0===e.more&&(t.push((0,R.jsx)("div",{className:De},"more_sep_1")),!1!==e.report&&t.push(y("cmd_report","full medium".concat(" ",Ee),["reportSettings",[]],(0,R.jsx)(O.Z,{value:u("label_report"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"ChartBar"}),iconWidth:"20px"}))),!0===e.search&&t.push(y("cmd_search","full medium".concat(" ",Ee),["searchQueue"],(0,R.jsx)(O.Z,{value:u("label_search"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Search"}),iconWidth:"20px"}))),!0===e.export_all&&"normal"===e.state&&t.push(y("cmd_export_all","full medium".concat(" ",Ee),["exportQueueAll"],(0,R.jsx)(O.Z,{value:u("label_export_all"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Download"}),iconWidth:"20px"}))),!0===e.print&&t.push(y("cmd_print","full medium".concat(" ",Ee),["createReport",["print"]],(0,R.jsx)(O.Z,{value:u("label_print"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Print"}),iconWidth:"20px"}))),!0===e.export_pdf&&"normal"===e.state&&t.push(y("cmd_export_pdf","full medium".concat(" ",Ee),["createReport",["pdf"]],(0,R.jsx)(O.Z,{value:u("label_export_pdf"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Download"}),iconWidth:"20px"}))),!0===e.export_xml&&"normal"===e.state&&t.push(y("cmd_export_xml","full medium".concat(" ",Ee),["createReport",["xml"]],(0,R.jsx)(O.Z,{value:u("label_export_xml"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Code"}),iconWidth:"20px"}))),!0===e.export_csv&&"normal"===e.state&&t.push(y("cmd_export_csv","full medium".concat(" ",Ee),["createReport",["csv"]],(0,R.jsx)(O.Z,{value:u("label_export_csv"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Download"}),iconWidth:"20px"}))),!0===e.export_event&&"normal"===e.state&&t.push(y("cmd_export_event","full medium".concat(" ",Ee),["exportEvent"],(0,R.jsx)(O.Z,{value:u("label_export_event"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Calendar"}),iconWidth:"20px"}))),t.push((0,R.jsx)("div",{className:De},"more_sep_2")),!1!==e.bookmark&&"normal"===e.state&&t.push(y("cmd_bookmark","full medium".concat(" ",Ee),["saveBookmark",[e.bookmark]],(0,R.jsx)(O.Z,{value:u("label_bookmark"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Star"}),iconWidth:"20px"}))),!1!==e.help&&t.push(y("cmd_help","full medium".concat(" ",Ee),["showHelp",[e.help]],(0,R.jsx)(O.Z,{value:u("label_help"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"QuestionCircle"}),iconWidth:"20px"})))),!0!==e.more&&"undefined"!==typeof e.help&&(t.push((0,R.jsx)("div",{className:De},"help_sep")),t.push(y("cmd_help","full medium".concat(" ",Ee),["showHelp",[e.help]],(0,R.jsx)(O.Z,{value:u("label_help"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"QuestionCircle"}),iconWidth:"20px"})))),t}(x):function(){var e=[];return r[0].length>0&&e.push((0,R.jsxs)("div",{className:"row full",children:[h("new_transitem_group","full medium".concat(" ",b("new_transitem")),"new_transitem",(0,R.jsx)(O.Z,{value:u("search_transitem"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"FileText"}),iconWidth:"25px"})),"new_transitem"===_?(0,R.jsx)("div",{className:"row full".concat(" ",$e),children:r[0].map((function(e){return"all"===n.trans[e][0]?y(e,"full medium primary".concat(" ",qe),["editorNew",[{ntype:"trans",ttype:e}]],(0,R.jsx)(O.Z,{value:u("title_"+e),leftIcon:(0,R.jsx)(K.Z,{iconKey:"FileText"}),iconWidth:"25px"})):null}))}):null]},"0")),r[1].length>0&&e.push((0,R.jsxs)("div",{className:"row full",children:[h("new_transpayment_group","full medium".concat(" ",b("new_transpayment")),"new_transpayment",(0,R.jsx)(O.Z,{value:u("search_transpayment"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Money"}),iconWidth:"25px"})),"new_transpayment"===_?(0,R.jsx)("div",{className:"row full".concat(" ",$e),children:r[1].map((function(e){return"all"===n.trans[e][0]?y(e,"full medium primary".concat(" ",qe),["editorNew",[{ntype:"trans",ttype:e}]],(0,R.jsx)(O.Z,{value:u("title_"+e),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Money"}),iconWidth:"25px"})):null}))}):null]},"1")),r[2].length>0&&e.push((0,R.jsxs)("div",{className:"row full",children:[h("new_transmovement_group","full medium".concat(" ",b("new_transmovement")),"new_transmovement",(0,R.jsx)(O.Z,{value:u("search_transmovement"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Truck"}),iconWidth:"25px"})),"new_transmovement"===_?(0,R.jsx)("div",{className:"row full".concat(" ",$e),children:r[2].map((function(e){return"all"===n.trans[e][0]?"delivery"===e?[y("shipping","full medium primary".concat(" ",qe),["editorNew",[{ntype:"trans",ttype:"shipping"}]],(0,R.jsx)(O.Z,{value:u("title_"+e),leftIcon:(0,R.jsx)(K.Z,{iconKey:o[e]().options.icon}),iconWidth:"25px"})),y(e,"full medium primary".concat(" ",qe),["editorNew",[{ntype:"trans",ttype:e}]],(0,R.jsx)(O.Z,{value:u("title_transfer"),leftIcon:(0,R.jsx)(K.Z,{iconKey:o[e]().options.icon}),iconWidth:"25px"}))]:y(e,"full medium primary".concat(" ",qe),["editorNew",[{ntype:"trans",ttype:e}]],(0,R.jsx)(O.Z,{value:u("title_"+e),leftIcon:(0,R.jsx)(K.Z,{iconKey:o[e]().options.icon}),iconWidth:"25px"})):null}))}):null]},"2")),r[3].length>0&&e.push((0,R.jsxs)("div",{className:"row full",children:[h("new_resources_group","full medium".concat(" ",b("new_resources")),"new_resources",(0,R.jsx)(O.Z,{value:u("title_resources"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Wrench"}),iconWidth:"25px"})),"new_resources"===_?(0,R.jsx)("div",{className:"row full".concat(" ",$e),children:r[3].map((function(e){return"all"===n[e][0]?y(e,"full medium primary".concat(" ",qe),["editorNew",[{ntype:e,ttype:null}]],(0,R.jsx)(O.Z,{value:u("title_"+e),leftIcon:(0,R.jsx)(K.Z,{iconKey:o[e]().options.icon}),iconWidth:"25px"})):null}))}):null]},"3")),e}()]}))};Se.defaultProps={side:"auto",edit:!0,module:{current:{},form_dirty:!1,dirty:!1,panel:{},dataset:{},group_key:""},newFilter:[],auditFilter:{},forms:{},className:"",onEvent:void 0,getText:void 0};var Fe=Se,Pe="Main_formPanel__OieND",Ke=r(8025),Re=["current","template","dataset","audit","className","getText","onEvent"],Le=function(e){var t=e.current,r=e.template,n=e.dataset,a=e.audit,i=e.className,l=e.getText,o=e.onEvent,c=(0,E.Z)(e,Re),u=function(e){return o("editItem",[e])},d=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o("onSelector",[].concat(t))};return(0,R.jsxs)("div",(0,s.Z)((0,s.Z)({},c),{},{className:"".concat(Pe," ","border"," ").concat(i),children:[r.rows.map((function(e,i){return(0,R.jsx)(Ke.Z,{row:e,values:t.item,options:r.options,data:{audit:a,current:t,dataset:n},getText:l,onEdit:u,onEvent:o,onSelector:d},i)})),"report"===t.type&&t.fieldvalue.length>0?(0,R.jsx)("div",{className:"row full",children:t.fieldvalue.map((function(e,i){return(0,R.jsx)(Ke.Z,{row:e,values:e,options:r.options,data:{audit:a,current:t,dataset:n},getText:l,onEdit:u,onEvent:o,onSelector:d},i)}))}):null]}))};Le.defaultProps={current:{},template:{},dataset:{},audit:"",className:"",onEvent:void 0,getText:void 0};var Ae=Le,We=r(5110),Me="Meta_formPanel__gRu7M",Ue="Meta_addButton__w+8Te",ze="Meta_paginatorCell__XYjR-",Ve=r(3443),He=["current","dataset","audit","className","paginationPage","getText","onEvent"],Be=function(e){var t=e.current,r=e.dataset,n=e.audit,a=e.className,l=e.paginationPage,o=e.getText,c=e.onEvent,d=(0,E.Z)(e,He),m=function(e){return c("editItem",[e])},f=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return c("onSelector",[].concat(t))},v=(0,u.useMemo)((function(){return[{accessor:"list"}]}),[]),x=(0,u.useMemo)((function(){var e=[];return t.fieldvalue.forEach((function(t){var n=r.deffield.filter((function(e){return e.fieldname===t.fieldname}))[0];if(1===n.visible&&0===t.deleted){var a=r.groups.filter((function(e){return e.id===n.fieldtype}))[0].groupvalue,i=t.value,s=a;if(["customer","tool","trans","transitem","transmovement","transpayment","product","project","employee","place"].includes(a)){var l=r.deffield_prop.filter((function(e){return e.ftype===a&&e.id===parseInt(t.value,10)}))[0];l&&(i=l.description),s="selector"}"urlink"===a&&(s="text"),"valuelist"===a&&(i=n.valuelist.split("|")),e=p()(e,{$push:[{rowtype:"fieldvalue",id:t.id,name:"fieldvalue_value",fieldname:t.fieldname,value:t.value,notes:t.notes||"",label:n.description,description:i,disabled:!!n.readonly,fieldtype:a,datatype:s}]})}})),e}),[t.fieldvalue,r.deffield,r.deffield_prop,r.groups]),g=(0,We.useTable)({columns:v,data:x,initialState:{pageIndex:t.page,pageSize:l}},We.usePagination),_=g.prepareRow,y=g.page,h=g.canPreviousPage,b=g.canNextPage,k=g.pageCount,j=g.gotoPage,w=g.nextPage,Z=g.previousPage,T=g.setPageSize,N=g.state,$=N.pageIndex,q=N.pageSize;return(0,R.jsxs)("div",(0,s.Z)((0,s.Z)({},d),{},{className:"".concat(Me," ","border"," ").concat(a),children:["readonly"!==n||k>1?(0,R.jsxs)("div",{className:"row full container-small section-small border-bottom",children:["readonly"!==n?(0,R.jsxs)("div",{className:"cell mobile",children:[(0,R.jsx)("div",{className:"cell padding-small",children:(0,R.jsx)(P.Z,{id:"sel_deffield",value:t.deffield||"",onChange:function(e){return c("changeCurrentData",["deffield",e])},placeholder:"",options:function(){var e=r.groups.filter((function(e){return"nervatype"===e.groupname&&e.groupvalue===t.type}))[0].id;return"trans"===t.type?r.deffield.filter((function(t){return t.nervatype===e&&1===t.visible})).filter((function(e){return e.subtype===t.item.transtype||null===e.subtype})).map((function(e){return{value:e.fieldname,text:e.description}})):r.deffield.filter((function(t){return t.nervatype===e&&1===t.visible})).map((function(e){return{value:e.fieldname,text:e.description}}))}()})}),t.deffield&&""!==t.deffield?(0,R.jsx)("div",{className:"cell",children:(0,R.jsx)(S.Z,{id:"btn_new",className:"border-button".concat(" ",Ue),onClick:function(){return c("checkEditor",[{fieldname:t.deffield},"NEW_FIELDVALUE",void 0])},value:(0,R.jsx)(O.Z,{value:o("label_new"),leftIcon:(0,R.jsx)(K.Z,{iconKey:"Plus"}),iconWidth:"20px"})})}):null]}):null,k>1?(0,R.jsx)("div",{className:" ".concat(ze," ","cell right mobile"),children:(0,R.jsx)(Ve.Z,{pageIndex:$,pageSize:q,pageCount:k,canPreviousPage:h,canNextPage:b,onEvent:function(e,t){var r={gotoPage:j,nextPage:w,previousPage:Z,setPageSize:T};r[e].apply(r,(0,i.Z)(t)),"setPageSize"!==e&&c("changeCurrentData",["page",t[0]])}})}):null]}):null,y.map((function(e,a){return _(e),(0,R.jsx)(Ke.Z,{row:e.original,values:e.original,options:{},data:{audit:n,current:t,dataset:r},getText:o,onEdit:m,onEvent:c,onSelector:f},e.original.id)}))]}))};Be.defaultProps={current:{},dataset:{},audit:"",className:"",paginationPage:(0,T.$8)("selectorPage"),onEvent:void 0,getText:void 0};var Qe=Be,Ge=r(9572),Xe="Note_rtfEditor__89BG0",Ye="Note_barButton__OJnaq",Je="Note_activeStyle__hes4i",et="Note_actionbar__9jvPF",tt="Note_formPanel__JzYEL",rt=["value","patternId","patterns","readOnly","lastUpdate","className","getText","onEvent"],nt=null,at=function(e){var t=e.value,r=e.patternId,n=e.patterns,a=e.readOnly,i=e.lastUpdate,l=e.className,o=e.getText,c=e.onEvent,d=(0,E.Z)(e,rt),p=(0,u.useCallback)((function(e){if(e&&!nt){var r=(0,Ge.init)({element:e,onChange:function(e){c("editItem",[{name:"fnote",value:e}])},actions:["bold","italic"],classes:{actionbar:"border-bottom ".concat(et),button:"border-button ".concat(Ye),content:"pell-content",selected:Je}});r.content.innerHTML=t,nt=r}}),[]);return(0,u.useEffect)((function(){nt&&nt.content.innerHTML!==t&&(nt.content.innerHTML=t)}),[i]),(0,u.useEffect)((function(){return function(){nt=null}})),(0,R.jsxs)("div",(0,s.Z)((0,s.Z)({},d),{},{className:"".concat(tt," ","border"," ").concat(l),children:[a?null:(0,R.jsx)("div",{children:(0,R.jsx)("div",{className:"row full",children:(0,R.jsxs)("div",{className:"cell padding-small",children:[(0,R.jsxs)("div",{className:"cell padding-tiny",children:[(0,R.jsx)(S.Z,{id:"btn_pattern_default",className:"border-button".concat(" ",Ye),title:o("pattern_default"),onClick:function(){return c("setPattern",[{key:"default"}])},value:(0,R.jsx)(K.Z,{iconKey:"Home"})}),(0,R.jsx)(S.Z,{id:"btn_pattern_load",className:"border-button".concat(" ",Ye),title:o("pattern_load"),onClick:function(){return c("setPattern",[{key:"load"}])},value:(0,R.jsx)(K.Z,{iconKey:"Download"})}),(0,R.jsx)(S.Z,{id:"btn_pattern_save",className:"border-button".concat(" ",Ye),title:o("pattern_save"),onClick:function(){return c("setPattern",[{key:"save"}])},value:(0,R.jsx)(K.Z,{iconKey:"Upload"})})]}),(0,R.jsxs)("div",{className:"cell padding-tiny",children:[(0,R.jsx)(S.Z,{id:"btn_pattern_new",className:"border-button".concat(" ",Ye),title:o("pattern_new"),onClick:function(){return c("setPattern",[{key:"new"}])},value:(0,R.jsx)(K.Z,{iconKey:"Plus"})}),(0,R.jsx)(S.Z,{id:"btn_pattern_delete",className:"border-button".concat(" ",Ye),title:o("pattern_delete"),onClick:function(){return c("setPattern",[{key:"delete"}])},value:(0,R.jsx)(K.Z,{iconKey:"Times"})})]}),(0,R.jsx)("div",{className:"cell padding-tiny mobile",children:(0,R.jsx)(P.Z,{id:"sel_pattern",value:r?String(r):"",placeholder:"",onChange:function(e){return c("changeCurrentData",["template",e])},options:n.map((function(e){return{value:String(e.id),text:e.description+(1===e.defpattern?"*":"")}}))})})]})})}),(0,R.jsx)("div",{className:"".concat(Xe," ","rtf"),children:a?(0,R.jsx)("div",{className:"pell-content",dangerouslySetInnerHTML:{__html:t}}):(0,R.jsx)("div",{id:"editor",className:"pell",ref:p})})]}))};at.defaultProps={value:"",patternId:void 0,patterns:[],className:"",readOnly:!1,lastUpdate:void 0,onEvent:void 0,getText:void 0};var it=at,st="Item_formPanel__tKRq+",lt="Item_itemTitle__RSC4t",ot="Item_itemTitlePre__8+EYQ",ct=["current","dataset","audit","className","getText","onEvent"],ut=function(e){var t=e.current,r=e.dataset,n=e.audit,a=e.className,i=e.getText,l=e.onEvent,o=(0,E.Z)(e,ct),c=function(e){return l("editItem",[e])},u=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return l("onSelector",[].concat(t))};return(0,R.jsxs)("div",(0,s.Z)((0,s.Z)({},o),{},{className:"".concat(a),children:[(0,R.jsx)("div",{className:"row full",children:(0,R.jsxs)("div",{className:"cell padding-normal border secondary-title".concat(" ",lt),children:[(0,R.jsx)(O.Z,{className:" ".concat(ot),value:null===t.form.id?i("label_new"):String(t.form.id)}),(0,R.jsx)(O.Z,{value:t.form_template.options.title})]})}),(0,R.jsx)("div",{className:"".concat(st," ","border"),children:t.form_template.rows.map((function(e,a){return(0,R.jsx)(Ke.Z,{row:e,values:t.form,options:t.form_template.options,data:{audit:n,current:t,dataset:r},getText:i,onEdit:c,onEvent:l,onSelector:u},a)}))})]}))};ut.defaultProps={current:{},dataset:{},audit:"",className:"",onEvent:void 0,getText:void 0};var dt=ut,pt="View_viewPanel__thcfJ",mt="View_editCol__Xrvia",ft="View_deleteCol__Ta7wv",vt="View_totalLabel__xClc7",xt="View_totalValue__VWSG7",gt=r(4867),_t=["viewName","current","template","dataset","audit","className","paginationPage","dateFormat","timeFormat","getText","onEvent"],yt=function(e){var t=e.viewName,r=e.current,n=e.template,a=e.dataset,i=e.audit,l=e.className,o=e.paginationPage,c=e.dateFormat,d=e.timeFormat,m=e.getText,f=e.onEvent,v=(0,E.Z)(e,_t),x=n.view[t],g=a[x.data]||[],_="undefined"===typeof x.edited||x.edited,y=x.actions;"undefined"===typeof y&&(y={new:{action:"newEditorItem",fkey:t},edit:{action:"editEditorItem",fkey:t},delete:{action:"deleteEditorItem",fkey:t}}),"all"!==i&&(y=p()(y,{$merge:{new:null,delete:null}}));var h="undefined"!==typeof x.edit_icon?[x.edit_icon,void 0,void 0]:["Edit",24,21.3],b="undefined"!==typeof x.delete_icon?[x.delete_icon,void 0,void 0]:["Times",19,27.6],k="undefined"!==typeof x.new_icon?x.new_icon:"Plus",j="undefined"!==typeof x.new_label?x.new_label:m("label_new"),w={};return"table"===x.type&&(_&&(y.edit||y.delete)&&(w=p()(w,{$merge:{edit:{columnDef:{id:"edit",Header:"",headerStyle:{},Cell:function(e){var t=e.row,r=(e.value,null!==y.edit?(0,R.jsx)("div",{className:"cell".concat(" ",mt),children:(0,R.jsx)(K.Z,{id:"edit_"+t.original.id,iconKey:h[0],width:h[1],height:h[2],onClick:function(){return f("setFormActions",[{params:y.edit,row:t.original}])},className:mt})}):null),n=null!==y.delete?(0,R.jsx)("div",{className:"cell".concat(" ",ft),children:(0,R.jsx)(K.Z,{id:"delete_"+t.original.id,iconKey:b[0],width:b[1],height:b[2],onClick:function(){return f("setFormActions",[{params:y.delete,row:t.original}])},className:ft})}):null;return(0,R.jsxs)(u.Fragment,{children:[r,n]})},cellStyle:{width:30,padding:"7px 3px 3px 8px"}}}}})),w=p()(w,{$merge:(0,s.Z)({},x.fields)})),(0,R.jsxs)("div",(0,s.Z)((0,s.Z)({},v),{},{className:"".concat(pt," ").concat(l),children:[x.total?(0,R.jsxs)("div",{className:"row full border",children:[(0,R.jsxs)("div",{className:"cell l4 m4 s12 padding-normal align-right",children:[(0,R.jsx)("span",{className:"".concat(vt),children:x.total[Object.keys(x.total)[0]]+":"}),(0,R.jsx)("span",{className:"".concat(xt," ","border"," "),children:(0,T.uf)(a[r.type][0][Object.keys(x.total)[0]],a[r.type][0].digit)})]}),(0,R.jsxs)("div",{className:"cell l4 m4 s12 padding-normal align-right",children:[(0,R.jsx)("span",{className:"".concat(vt),children:x.total[Object.keys(x.total)[1]]+":"}),(0,R.jsx)("span",{className:"".concat(xt," ","border"),children:(0,T.uf)(a[r.type][0][Object.keys(x.total)[1]],a[r.type][0].digit)})]}),(0,R.jsxs)("div",{className:"cell l4 m4 s12 padding-normal align-right",children:[(0,R.jsx)("span",{className:"".concat(vt),children:x.total[Object.keys(x.total)[2]]+":"}),(0,R.jsx)("span",{className:"".concat(xt," ","border"),children:(0,T.uf)(a[r.type][0][Object.keys(x.total)[2]],a[r.type][0].digit)})]})]}):null,(0,R.jsx)("div",{className:"row full",children:"table"===x.type?(0,R.jsx)(re.Z,{rowKey:"id",onAddItem:_&&y.new?function(){return f("setFormActions",[{params:y.new}])}:void 0,fields:w,rows:g,tableFilter:!0,filterPlaceholder:m("placeholder_filter"),labelYes:m("label_yes"),labelNo:m("label_no"),labelAdd:j,addIcon:(0,R.jsx)(K.Z,{iconKey:k}),dateFormat:c,timeFormat:d,paginationPage:o,paginationTop:!0}):(0,R.jsx)(gt.Z,{rows:g,labelAdd:j,addIcon:(0,R.jsx)(K.Z,{iconKey:k}),editIcon:(0,R.jsx)(K.Z,{iconKey:h[0],width:h[1],height:h[2]}),deleteIcon:(0,R.jsx)(K.Z,{iconKey:b[0],width:b[1],height:b[2]}),listFilter:!0,filterPlaceholder:m("placeholder_filter"),paginationPage:o,paginationTop:!0,onEdit:_&&y.edit?function(e){return f("setFormActions",[{params:y.edit,row:e}])}:void 0,onAddItem:_&&y.new?function(){return f("setFormActions",[{params:y.new}])}:void 0,onDelete:_&&y.delete?function(e){return f("setFormActions",[{params:y.delete,row:e}])}:void 0})})]}))};yt.defaultProps={viewName:"",current:{},template:{},dataset:{},audit:"",paginationPage:(0,T.$8)("paginationPage"),dateFormat:(0,T.$8)("dateFormat"),timeFormat:(0,T.$8)("timeFormat"),className:"",onEvent:void 0,getText:void 0};var ht=yt,bt="Editor_panel__WgAZq",kt="Editor_panelTitle__WWjgP",jt="Editor_tabButton__zRXD8",wt="Editor_badge__amB1+",Zt="Editor_width800__KdnJA",Tt=["caption","current","template","dataset","audit","lastUpdate","className","getText","onEvent"],Nt=function(e){var t=e.caption,r=e.current,n=e.template,a=e.dataset,i=e.audit,l=e.lastUpdate,o=e.className,c=e.getText,d=e.onEvent,p=(0,E.Z)(e,Tt),m=function(e,t,n,a){return(0,R.jsx)("div",{className:"row full",children:(0,R.jsx)("div",{className:"cell",children:(0,R.jsx)(S.Z,{id:"btn_"+e,className:" ".concat(jt," ","full secondary-title"),onClick:function(){return d("changeCurrentData",["view",r.view===e?"":e])},value:(0,R.jsxs)("div",{className:"row full",children:[(0,R.jsx)("div",{className:"cell",children:(0,R.jsx)(O.Z,{value:c(t),leftIcon:(0,R.jsx)(K.Z,{iconKey:n}),iconWidth:"20px"})}),"undefined"!==typeof a?(0,R.jsx)("div",{className:"cell align-right",children:(0,R.jsx)("span",{className:"".concat(wt),children:a})}):null]})},e)})})};return(0,R.jsx)("div",(0,s.Z)((0,s.Z)({},p),{},{className:"".concat(Zt," ").concat(o),children:(0,R.jsxs)("div",{className:"".concat(bt),children:[(0,R.jsx)("div",{className:"".concat(kt," ","primary"),children:(0,R.jsx)(O.Z,{value:t,leftIcon:(0,R.jsx)(K.Z,{iconKey:n.options.icon}),iconWidth:"20px"})}),r.form?(0,R.jsx)("div",{className:"section container",children:(0,R.jsx)(dt,{current:r,dataset:a,audit:i,onEvent:d,getText:c})}):(0,R.jsxs)("div",{className:"section container",children:[(0,R.jsxs)(u.Fragment,{children:[m("form",function(){var e=r.item[n.options.title_field];return"printqueue"===r.type?e=n.options.title_field:null===r.item.id&&(e=c("label_new")+" "+n.options.title),e}(),n.options.icon),"form"===r.view?(0,R.jsx)(Ae,{current:r,template:n,dataset:a,audit:i,onEvent:d,getText:c}):null]}),null===r.item.id&&!n.options.search_form||"undefined"===typeof a.fieldvalue||null===r.item||!0!==n.options.fieldvalue?null:(0,R.jsxs)(u.Fragment,{children:[m("fieldvalue","fields_view",n.options.icon,r.fieldvalue.filter((function(e){return 1===a.deffield.filter((function(t){return t.fieldname===e.fieldname}))[0].visible&&0===e.deleted})).length),"fieldvalue"===r.view?(0,R.jsx)(Qe,{current:r,dataset:a,audit:i,onEvent:d,getText:c}):null]}),null!==r.item.id&&"undefined"!==typeof r.item.fnote&&!0===n.options.pattern?(0,R.jsxs)(u.Fragment,{children:[m("fnote","fnote_view","Comment"),"fnote"===r.view?(0,R.jsx)(it,{value:r.item.fnote,lastUpdate:l,patternId:r.template,patterns:a.pattern,readOnly:"readonly"===i,onEvent:d,getText:c}):null]}):null,Object.keys(n.view).filter((function(e){return"disabled"!==n.view[e].view_audit})).map((function(e){return(0,R.jsxs)(u.Fragment,{children:[m(e,n.view[e].title,n.view[e].icon,a[n.view[e].data].length),r.view===e?(0,R.jsx)(ht,{viewName:e,current:r,template:n,dataset:a,audit:i,onEvent:d,getText:c}):null]},e)}))]})]})}))};Nt.defaultProps={caption:"",current:{},template:{},dataset:{},audit:"",lastUpdate:void 0,className:"",onEvent:void 0,getText:void 0};var Et=Nt,$t=function(e){var t=e.data,r=e.current,n=e.login,a=e.forms,i=e.onEvent,s=e.getText;return(0,R.jsxs)(u.Fragment,{children:[(0,R.jsx)(Fe,{side:r.side,edit:r.edit,module:t,forms:a,newFilter:n.edit_new,auditFilter:n.audit_filter,onEvent:i,getText:s}),t.current.item?(0,R.jsx)("div",{className:"page padding-normal".concat(" ",r.theme),children:(0,R.jsx)(Et,{caption:t.caption,current:t.current,template:t.template,dataset:t.dataset,audit:t.audit,lastUpdate:t.lastUpdate,onEvent:i,getText:s})}):null]})};$t.defaultProps={data:{caption:Et.defaultProps.caption,current:Et.defaultProps.current,template:Et.defaultProps.template,dataset:Et.defaultProps.dataset,audit:Et.defaultProps.audit},current:{},login:{},forms:{},onEvent:void 0,getText:void 0};var qt=(0,u.memo)($t,(function(e,t){return e.data===t.data&&e.current.side===t.current.side&&e.current.edit===t.current.edit})),It=function(e){var t=(0,u.useContext)(m.ZP),r=t.data,o=t.setData,d=(0,f.xZ)(r,o),v=we(r,o),x=(0,u.useState)(p()(e,{$merge:{login:r.login.data,forms:(0,w.E)({getText:d.getText})}})),g=(0,l.Z)(x,1)[0];return g.data=p()(g.data,{$merge:(0,s.Z)({},r[g.key])}),g.current=p()(g.current,{$merge:(0,s.Z)({},r.current)}),(0,u.useEffect)((function(){if(g.current&&g.current.content){var e=g.current.content;o("current",{content:null},(function(){v.checkEditor(e,e.nextKey||"LOAD_EDITOR")}))}}),[o,v,g]),g.getText=function(e,t){return d.getText(e,t)},g.onEvent=function(e,t){return t=t||[],g[e]?g[e].apply(g,(0,i.Z)(t)):v[e]?v[e].apply(v,(0,i.Z)(t).concat([g.data])):d[e]?d[e].apply(d,(0,i.Z)(t)):void 0},g.changeData=function(e,t){o(g.key,(0,a.Z)({},e,t))},g.changeCurrentData=function(e,t){var r=p()(g.data.current,{$merge:(0,a.Z)({},e,t)});o(g.key,{current:r})},g.editState=function(){o("current",{edit:!g.current.edit})},g.onSelector=function(e,t,r){d.onSelector(e,t,r)},g.editorBack=function(){if(r.edit.current.form)v.checkEditor({ntype:r.edit.current.type,ttype:r.edit.current.transtype,id:r.edit.current.item.id,form:r.edit.current.form_type},"LOAD_EDITOR");else if("transitem_shipping"===r.edit.current.form_type)v.checkEditor({ntype:r.edit.current.type,ttype:r.edit.current.transtype,id:r.edit.current.item.id,form:r.edit.current.form_type},"LOAD_EDITOR");else{var e=g.login.groups.filter((function(e){return e.id===r.edit.current.item.nervatype}))[0].groupvalue;v.checkEditor({ntype:e,ttype:null,id:r.edit.current.item.ref_id,form:r.edit.current.type},"LOAD_EDITOR")}},g.saveEditor=(0,n.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null,!r.edit.current.form){e.next=7;break}return e.next=4,v.saveEditorForm();case 4:t=e.sent,e.next=10;break;case 7:return e.next=9,v.saveEditor();case 9:t=e.sent;case 10:t&&v.loadEditor({ntype:t.current.type,ttype:t.current.transtype,id:t.current.item.id,form:t.current.view});case 11:case"end":return e.stop()}}),e)}))),g.editorDelete=function(){r.edit.current.form?v.deleteEditorItem({fkey:r.edit.current.form_type,table:r.edit.current.form_datatype,id:r.edit.current.form.id}):v.deleteEditor()},g.editorNew=function(e){"shipping"===e.ttype?d.onSelector("transitem_delivery","",(function(e,t){var r=e.id.split("/");v.checkEditor({ntype:r[0],ttype:r[1],id:parseInt(r[2],10),shipping:!0},"LOAD_EDITOR")})):v.checkEditor({ntype:e.ntype||r.edit.current.type,ttype:e.ttype||r.edit.current.transtype,id:null},"LOAD_EDITOR")},g.transCopy=function(e){"create"===e?v.checkEditor({},"CREATE_TRANS_OPTIONS"):o("current",{modalForm:(0,R.jsx)(N.default,{title:d.getText("msg_warning"),message:d.getText("msg_copy_text"),infoText:d.getText("msg_delete_info"),defaultOK:!0,labelOK:d.getText("msg_ok"),labelCancel:d.getText("msg_cancel"),onCancel:function(){o("current",{modalForm:null})},onOK:function(t){o("current",{modalForm:null},(function(){v.checkEditor({cmdtype:"copy",transcast:e},"CREATE_TRANS")}))}}),side:"hide"})},g.setLink=function(e,t){o("current",{side:"hide"},(function(){var n="cash"===r.edit.current.transtype?r.edit.current.extend.id:r.edit.current.form.id;v.checkEditor({fkey:e,id:null,link_field:t,link_id:n},"SET_EDITOR_ITEM")}))},g.setPassword=function(e){!e&&r.edit.current&&(e=r.edit.dataset[r.edit.current.type][0].username),o("current",{module:"setting",content:{username:e,nextKey:"PASSWORD_FORM"},side:"hide"})},g.shippingAddAll=function(){var e=p()({},{$set:r.edit});e.dataset.shipping_items_.forEach((function(t){0!==t.diff&&!0!==t.edited&&(e=p()(e,{dataset:{shiptemp:{$push:[{id:t.item_id+"-"+t.product_id,item_id:t.item_id,product_id:t.product_id,product:t.product,partnumber:t.partnumber,partname:t.partname,unit:t.unit,batch_no:"",qty:t.diff,diff:0,oqty:t.qty,tqty:t.tqty}]}}}))})),v.setEditor({shipping:!0,form:"shiptemp_items"},e.template,e)},(0,R.jsx)(qt,(0,s.Z)({},g))};It.defaultProps=(0,s.Z)((0,s.Z)({key:"edit"},$t.defaultProps),{},{changeCurrentData:void 0,onPaginationSelect:void 0,onSelector:void 0});var Dt=It},9572:function(e,t){!function(e){"use strict";var t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r="defaultParagraphSeparator",n="formatBlock",a=function(e,t,r){return e.addEventListener(t,r)},i=function(e,t){return e.appendChild(t)},s=function(e){return document.createElement(e)},l=function(e){return document.queryCommandState(e)},o=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return document.execCommand(e,!1,t)},c={bold:{icon:"<b>B</b>",title:"Bold",state:function(){return l("bold")},result:function(){return o("bold")}},italic:{icon:"<i>I</i>",title:"Italic",state:function(){return l("italic")},result:function(){return o("italic")}},underline:{icon:"<u>U</u>",title:"Underline",state:function(){return l("underline")},result:function(){return o("underline")}},strikethrough:{icon:"<strike>S</strike>",title:"Strike-through",state:function(){return l("strikeThrough")},result:function(){return o("strikeThrough")}},heading1:{icon:"<b>H<sub>1</sub></b>",title:"Heading 1",result:function(){return o(n,"<h1>")}},heading2:{icon:"<b>H<sub>2</sub></b>",title:"Heading 2",result:function(){return o(n,"<h2>")}},paragraph:{icon:"&#182;",title:"Paragraph",result:function(){return o(n,"<p>")}},quote:{icon:"&#8220; &#8221;",title:"Quote",result:function(){return o(n,"<blockquote>")}},olist:{icon:"&#35;",title:"Ordered List",result:function(){return o("insertOrderedList")}},ulist:{icon:"&#8226;",title:"Unordered List",result:function(){return o("insertUnorderedList")}},code:{icon:"&lt;/&gt;",title:"Code",result:function(){return o(n,"<pre>")}},line:{icon:"&#8213;",title:"Horizontal Line",result:function(){return o("insertHorizontalRule")}},link:{icon:"&#128279;",title:"Link",result:function(){var e=window.prompt("Enter the link URL");e&&o("createLink",e)}},image:{icon:"&#128247;",title:"Image",result:function(){var e=window.prompt("Enter the image URL");e&&o("insertImage",e)}}},u={actionbar:"pell-actionbar",button:"pell-button",content:"pell-content",selected:"pell-button-selected"},d=function(e){var l=e.actions?e.actions.map((function(e){return"string"==typeof e?c[e]:c[e.name]?t({},c[e.name],e):e})):Object.keys(c).map((function(e){return c[e]})),d=t({},u,e.classes),p=e[r]||"div",m=s("div");m.className=d.actionbar,i(e.element,m);var f=e.element.content=s("div");return f.contentEditable=!0,f.className=d.content,f.oninput=function(t){var r=t.target.firstChild;r&&3===r.nodeType?o(n,"<"+p+">"):"<br>"===f.innerHTML&&(f.innerHTML=""),e.onChange(f.innerHTML)},f.onkeydown=function(e){var t;"Enter"===e.key&&"blockquote"===(t=n,document.queryCommandValue(t))&&setTimeout((function(){return o(n,"<"+p+">")}),0)},i(e.element,f),l.forEach((function(e){var t=s("button");if(t.className=d.button,t.innerHTML=e.icon,t.title=e.title,t.setAttribute("type","button"),t.onclick=function(){return e.result()&&f.focus()},e.state){var r=function(){return t.classList[e.state()?"add":"remove"](d.selected)};a(f,"keyup",r),a(f,"mouseup",r),a(t,"click",r)}i(m,t)})),e.styleWithCSS&&o("styleWithCSS"),o(r,p),e.element},p={exec:o,init:d};e.exec=o,e.init=d,e.default=p,Object.defineProperty(e,"__esModule",{value:!0})}(t)}}]);