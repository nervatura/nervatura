"use strict";(self.webpackChunknervatura_client=self.webpackChunknervatura_client||[]).push([[153],{2161:function(e,t,a){a.r(t),a.d(t,{default:function(){return ve}});var l=a(2982),r=a(1413),n=a(885),o=a(7313),i=a(4754),s=a.n(i),c=a(7559),d=a(2361),m=a(4165),u=a(5861),p=a(4942),f=a(6431),g=a.n(f),_=a(241),h=a(5468),x=a(4925),v=(a(2580),"Template_modal__i8KgG"),b="Template_dialog__+4EEt",y="Template_panel__Pzv3l",w="Template_panelTitle__2GF63",j="Template_closeIcon__ph9iV",T="Template_textareaStyle__YuL+J",Z=a(8907),N=a(4721),k=a(6360),C=a(3331),L=a(5750),A=a(6417),E=["type","name","columns","className","getText","onClose","onData"],I={TEXT:"string",LIST:"list",TABLE:"table"},S=function(e){var t=e.type,a=e.name,l=e.columns,i=e.className,s=e.getText,c=e.onClose,d=e.onData,m=(0,x.Z)(e,E),u=(0,o.useState)({type:t,name:a,columns:l}),p=(0,n.Z)(u,2),f=p[0],g=p[1];return(0,A.jsx)("div",{className:"modal".concat(" ",v),children:(0,A.jsx)("div",(0,r.Z)((0,r.Z)({className:"dialog".concat(" ",b)},m),{},{children:(0,A.jsxs)("div",{className:"".concat(y," ").concat(i),children:[(0,A.jsx)("div",{className:"".concat(w," ","primary"),children:(0,A.jsxs)("div",{className:"row full",children:[(0,A.jsx)("div",{className:"cell",children:(0,A.jsx)(Z.Z,{value:s("template_label_new_data"),leftIcon:(0,A.jsx)(L.Z,{iconKey:"Plus"}),iconWidth:"20px"})}),(0,A.jsx)("div",{className:"cell align-right".concat(" ",j),children:(0,A.jsx)(L.Z,{id:"closeIcon",iconKey:"Times",onClick:c})})]})}),(0,A.jsxs)("div",{className:"section-small",children:[(0,A.jsxs)("div",{className:"row full container-small",children:[(0,A.jsxs)("div",{className:"cell padding-small half",children:[(0,A.jsx)("div",{className:"row full",children:(0,A.jsx)(Z.Z,{className:"bold",value:s("template_data_type")})}),(0,A.jsx)(C.Z,{id:"type",className:"full",value:f.type,autoFocus:!0,onChange:function(e){return g((0,r.Z)((0,r.Z)({},f),{},{type:e}))},options:Object.keys(I).map((function(e){return{value:I[e],text:e}}))})]}),(0,A.jsxs)("div",{className:"cell padding-small half",children:[(0,A.jsx)("div",{className:"row full",children:(0,A.jsx)(Z.Z,{className:"bold",value:s("template_data_name")})}),(0,A.jsx)(k.Z,{id:"name",className:"full",value:f.name,onChange:function(e){return g((0,r.Z)((0,r.Z)({},f),{},{name:e}))}})]})]}),f.type===I.TABLE?(0,A.jsx)("div",{className:"row full container-small",children:(0,A.jsx)("div",{className:"row full",children:(0,A.jsxs)("div",{className:"cell padding-small",children:[(0,A.jsx)("div",{children:(0,A.jsx)(Z.Z,{className:"bold",value:s("template_data_columns")})}),(0,A.jsx)("textarea",{id:"columns",className:"full".concat(" ",T),value:f.columns,rows:3,onChange:function(e){return g((0,r.Z)((0,r.Z)({},f),{},{columns:e.target.value}))}})]})})}):null]}),(0,A.jsx)("div",{className:"row full section container-small secondary-title",children:(0,A.jsxs)("div",{className:"row full",children:[(0,A.jsx)("div",{className:"cell padding-small half",children:(0,A.jsx)(N.Z,{id:"btn_cancel",className:"full".concat(" ",j," "),onClick:function(){return c()},value:(0,A.jsx)(Z.Z,{center:!0,value:s("msg_cancel"),leftIcon:(0,A.jsx)(L.Z,{iconKey:"Times"}),iconWidth:"20px"})})}),(0,A.jsx)("div",{className:"cell padding-small half",children:(0,A.jsx)(N.Z,{id:"btn_ok",className:"full primary",disabled:""===f.name?"disabled":"",onClick:function(){return d({name:f.name,type:f.type,columns:f.columns})},value:(0,A.jsx)(Z.Z,{center:!0,value:s("msg_ok"),leftIcon:(0,A.jsx)(L.Z,{iconKey:"Check"}),iconWidth:"20px"})})})]})})]})}))})};S.defaultProps={type:I.TEXT,name:"",columns:"",className:"",getText:void 0,onClose:void 0,onData:void 0};var D=S,O=a(4848),R="Template_sidebar__Uvfii",$="Template_itemButton__JskK1",F="Template_selected__ShhKO",K="Template_separator__mY3PJ",P=["side","templateKey","dirty","className","getText","onEvent"],B=function(e){var t=e.side,a=e.templateKey,n=e.dirty,i=e.className,s=e.getText,c=e.onEvent,d=(0,x.Z)(e,P),m=function(e,t,a,r){return(0,A.jsx)(N.Z,{id:e,className:t,onClick:function(){return c.apply(void 0,(0,l.Z)(a))},value:r},e)};return(0,A.jsxs)("div",(0,r.Z)((0,r.Z)({},d),{},{className:"".concat(R," ").concat("auto"!==t?t:""," ").concat(i),children:[m("cmd_back","medium".concat(" ",$," ").concat(F),["checkTemplate",["LOAD_SETTING"]],(0,A.jsx)(Z.Z,{value:s("label_back"),leftIcon:(0,A.jsx)(L.Z,{iconKey:"Reply"}),iconWidth:"25px"})),(0,A.jsx)("div",{className:K},"tmp_sep_1"),["_blank","_sample"].includes(a)?null:(0,A.jsxs)(o.Fragment,{children:[(0,A.jsx)("div",{className:K},"tmp_sep_2"),m("cmd_save","full medium".concat(" ",$," ").concat(n?F:""),["saveTemplate",[!0]],(0,A.jsx)(Z.Z,{value:s("template_save"),leftIcon:(0,A.jsx)(L.Z,{iconKey:"Check"}),iconWidth:"25px"})),m("cmd_create","full medium".concat(" ",$),["createTemplate",[]],(0,A.jsx)(Z.Z,{value:s("template_create_from"),leftIcon:(0,A.jsx)(L.Z,{iconKey:"Sitemap"}),iconWidth:"25px"})),m("cmd_delete","full medium".concat(" ",$),["deleteTemplate",[]],(0,A.jsx)(Z.Z,{value:s("label_delete"),leftIcon:(0,A.jsx)(L.Z,{iconKey:"Times"}),iconWidth:"20px"}))]}),(0,A.jsx)("div",{className:K},"tmp_sep_3"),m("cmd_blank","full medium".concat(" ",$),["checkTemplate",["NEW_BLANK"]],(0,A.jsx)(Z.Z,{value:s("template_new_blank"),leftIcon:(0,A.jsx)(L.Z,{iconKey:"Plus"}),iconWidth:"25px"})),m("cmd_sample","full medium".concat(" ",$),["checkTemplate",["NEW_SAMPLE"]],(0,A.jsx)(Z.Z,{value:s("template_new_sample"),leftIcon:(0,A.jsx)(L.Z,{iconKey:"Plus"}),iconWidth:"25px"})),(0,A.jsx)("div",{className:K},"tmp_sep_4"),m("cmd_print","full medium".concat(" ",$),["showPreview",[]],(0,A.jsx)(Z.Z,{value:s("label_print"),leftIcon:(0,A.jsx)(L.Z,{iconKey:"Print"}),iconWidth:"25px"})),m("cmd_json","full medium".concat(" ",$),["exportTemplate",[]],(0,A.jsx)(Z.Z,{value:s("template_export_json"),leftIcon:(0,A.jsx)(L.Z,{iconKey:"Code"}),iconWidth:"25px"})),(0,A.jsx)("div",{className:K},"tmp_sep_5"),m("cmd_help","full medium".concat(" ",$),["showHelp",["program/editor"]],(0,A.jsx)(Z.Z,{value:s("label_help"),leftIcon:(0,A.jsx)(L.Z,{iconKey:"QuestionCircle"}),iconWidth:"20px"}))]}))};B.defaultProps={side:"auto",templateKey:"",dirty:!1,className:"",onEvent:void 0,getText:void 0};var U=B,W=a(1012),J=a(4867),G=a(8025),q="TemplateEditor_panel__lWNrR",M="TemplateEditor_panelTitle__ZBVTI",V="TemplateEditor_settingPanel__g4jqT",z="TemplateEditor_viewPanel__CIIUJ",H="TemplateEditor_width800__w2PJL",Q="TemplateEditor_deleteCol__ZGMCf",X="TemplateEditor_selected__S3FXO",Y="TemplateEditor_tabButton__pfPtu",ee="TemplateEditor_green__MKvMR",te="TemplateEditor_title__WQeoc",ae="TemplateEditor_templateRow__p2Q6u",le="TemplateEditor_mapButton__eA7IH",re="TemplateEditor_badgeBlack__Kga4k",ne="TemplateEditor_badgeOrange__U7LRz",oe="TemplateEditor_separator__9lvow",ie="TemplateEditor_mapBox__1q1f5",se="TemplateEditor_reportMap__E9jla",ce="TemplateEditor_closeIcon__Jlcpn",de="TemplateEditor_textareaStyle__CNbam",me=["data","paginationPage","className","getText","onEvent"],ue=function(e){var t=e.data,a=e.paginationPage,n=e.className,i=e.getText,c=e.onEvent,d=(0,x.Z)(e,me),m=t.title,u=t.tabView,p=t.template,f=t.current,g=t.current_data,_=t.dataset,h=(0,o.useCallback)((function(e){e&&c("createMap",[e])}),[c]),v=function(e,t){return{map_edit:{data:!1,report:!1,header:!1,footer:!1,details:!1},map_insert:{header:!0,footer:!0,details:!0,row:!0,datagrid:!0}}[t][e]},b=function(e){return Object.getOwnPropertyNames(e)[0]},y=function(e,t){return"undefined"!==typeof t?t:"object"===typeof e&&Array.isArray(e)&&e.length>0?e.length:0},w=function(e,t){if(f.item===e)return{selected:!0,icon:"Tag",color:"green",badge:y(e,t)};if(f.parent===e||p[f.section]===e)return{selected:!0,icon:"Check",color:"",badge:y(e,t)};var a="InfoCircle";return Array.isArray(e)&&e.length>0&&(a="Plus"),{selected:!1,icon:a,color:"",badge:0}},j=function(e,t,a,l,r,n){return(0,A.jsx)(N.Z,{id:"btn_".concat(e),onClick:function(){return c("setCurrent",[{tmp_id:t}])},className:"".concat(le," ","full border-button"," ").concat(""!==a.color?ee:""),value:(0,A.jsxs)("div",{className:"row full",children:[(0,A.jsx)("div",{className:"cell",children:(0,A.jsx)(Z.Z,{value:l,leftIcon:(0,A.jsx)(L.Z,{iconKey:a.icon}),iconWidth:"20px"})}),r>0?(0,A.jsx)("div",{className:"cell align-right",children:(0,A.jsx)("span",{className:n,children:r})}):null]})})},T=function(e,t){return(0,A.jsx)(N.Z,{id:"btn_".concat(e),className:"full".concat(" ",Y," ").concat(u===e?X:""," ").concat(u===e?"primary":""),onClick:function(){return c("changeTemplateData",[{key:"tabView",value:e}])},value:(0,A.jsx)(Z.Z,{value:i("template_label_".concat(e)),leftIcon:(0,A.jsx)(L.Z,{iconKey:t}),iconWidth:"25px"})})},k=function(e,t){return(0,A.jsx)(L.Z,{id:"btn_".concat(e),iconKey:"Times",onClick:function(){return c(t,[null])}})},E=function(e,t,a,n,o,s){var d={value:i(a),iconWidth:"20px"};return s?d.leftIcon=(0,A.jsx)(L.Z,{iconKey:n}):d.rightIcon=(0,A.jsx)(L.Z,{iconKey:n}),(0,A.jsx)(N.Z,{id:"btn_".concat(e),onClick:function(){return c.apply(void 0,(0,l.Z)(t))},className:"".concat(le," ","border-button"," ").concat(o),value:(0,A.jsx)(Z.Z,(0,r.Z)({},d))})},I=function(e,t,a,l){return(0,A.jsx)("textarea",{id:"".concat(e,"_value"),className:"full".concat(" ",de," "),value:t,rows:a,onChange:function(e){return c("editDataItem",[s()({value:e.target.value},{$merge:(0,r.Z)({},l)})])}})};return(0,A.jsx)("div",(0,r.Z)((0,r.Z)({},d),{},{className:"".concat(H," ").concat(n),children:(0,A.jsxs)("div",{className:"".concat(q),children:[(0,A.jsx)("div",{className:"".concat(M," ","primary"),children:(0,A.jsx)(Z.Z,{value:m,leftIcon:(0,A.jsx)(L.Z,{iconKey:"TextHeight"}),iconWidth:"20px"})}),(0,A.jsx)("div",{className:"section".concat(" ",V),children:(0,A.jsx)("div",{className:"row full container section-small-bottom",children:(0,A.jsxs)("div",{className:"".concat(z),children:[(0,A.jsxs)("div",{className:"row full",children:[(0,A.jsx)("div",{className:"cell third",children:T("template","Tags")}),(0,A.jsx)("div",{className:"cell third",children:T("data","Database")}),(0,A.jsx)("div",{className:"cell third",children:T("meta","InfoCircle")})]}),"template"===u?(0,A.jsxs)(o.Fragment,{children:[(0,A.jsxs)("div",{className:"row full border section container-small",children:[(0,A.jsxs)("div",{className:"cell padding-small third",children:[E("previous",["goPrevious",[]],"label_previous","ArrowLeft","full",!0),(0,A.jsx)("div",{className:"secondary-title border".concat(" ",ie),children:(0,A.jsx)("canvas",{ref:h,className:"".concat(se)})},"map_box"),E("next",["goNext",[]],"label_next","ArrowRight","full",!1)]}),(0,A.jsx)("div",{className:"cell padding-small third",children:function(){var e=[];return["report","header","details","footer"].forEach((function(t){var a=w(p[t]);a.selected&&"report"!==t&&e.push((0,A.jsx)("div",{className:oe},"sep_"+t+"_0")),e.push((0,A.jsx)("div",{children:j("tmp_"+t,"tmp_"+t,a,t.toUpperCase(),a.badge,"warning".concat(" ",ne))},t)),a.selected&&(e.push((0,A.jsx)("div",{className:oe},"sep_"+t+"_1")),"report"!==t&&(!function(e){for(var t=0;t<p[f.section].length;t++){var a=b(p[f.section][t]),l=p[f.section][t][a],r="tmp_"+f.section+"_"+t.toString()+"_"+a;if(["row","datagrid"].includes(a)&&(l=l.columns),null===f.parent){var n=w(l);e.push((0,A.jsx)("div",{children:j(r,r,n,a.toUpperCase(),t+1,"primary".concat(" ",re))},r))}else if(f.item===l||f.parent===l){var o=w(l,t+1);if(e.push((0,A.jsx)("div",{children:j(r,r,o,a.toUpperCase(),o.badge,"primary".concat(" ",re))},r)),["row","datagrid"].includes(f.type)||["row","datagrid"].includes(f.parent_type))for(var i=0;i<l.length;i++){var s=b(l[i]),c=l[i][s],d="tmp_"+f.section+"_"+t.toString()+"_"+a+"_"+i.toString()+"_"+s,m=w(c);e.push((0,A.jsx)("div",{children:j(d,d,m,s.toUpperCase(),m.badge,"primary".concat(" ",re))},d))}}}}(e),e.push((0,A.jsx)("div",{className:oe},"sep_"+t+"_2"))))})),e}()}),(0,A.jsxs)("div",{className:"cell padding-small third",children:[!1!==v(f.type,"map_edit")?(0,A.jsxs)("div",{children:[E("move_up",["moveUp",[]],"label_move_up","ArrowUp","full",!0),E("move_down",["moveDown",[]],"label_move_down","ArrowDown","full",!0),E("delete_item",["deleteItem",[]],"label_delete","Times","full",!0),(0,A.jsx)("div",{className:oe})]}):null,v(f.type,"map_insert")?(0,A.jsxs)("div",{children:[E("add_item",["addItem",[f.add_item||""]],"label_add_item","Plus","",!0),(0,A.jsx)(C.Z,{id:"sel_add_item",value:f.add_item||"",placeholder:"",onChange:function(e){return c("changeCurrentData",[{key:"add_item",value:e}])},options:{header:["row","vgap","hline"],details:["row","vgap","hline","html","datagrid"],footer:["row","vgap","hline"],row:["cell","image","barcode","separator"],datagrid:["column"]}[f.type].map((function(e){return{value:e,text:e.toUpperCase()}}))})]}):null]})]}),(0,A.jsx)("div",{className:"".concat(te," ","padding-small"),children:(0,A.jsx)(Z.Z,{value:f.type.toUpperCase(),leftIcon:(0,A.jsx)(L.Z,{iconKey:"Tag"}),iconWidth:"20px"})}),f.form.rows.map((function(e,t){return(0,A.jsx)("div",{className:"row full border".concat(" ",ae),children:(0,A.jsx)(G.Z,{row:e,values:["row","datagrid"].includes(f.type)?f.item_base:f.item,options:f.form.options,data:{audit:"all",current:f,dataset:p.data},getText:i,onEdit:function(e){return c("editItem",[e])}})},t)}))]}):null,"data"===u?(0,A.jsxs)("div",{className:"row full border padding-normal",children:[g&&"string"===g.type?(0,A.jsxs)("div",{className:"row full section-small",children:[(0,A.jsx)("div",{className:"".concat(M," ","primary"),children:(0,A.jsxs)("div",{className:"row full",children:[(0,A.jsx)("div",{className:"cell",children:(0,A.jsx)(Z.Z,{value:g.name})}),(0,A.jsx)("div",{className:"cell align-right".concat(" ",ce),children:k("data_string","setCurrentData")})]})}),I(g.name,p.data[g.name],15,{})]}):null,g&&"list"===g.type&&g.item?(0,A.jsxs)("div",{className:"row full section-small",children:[(0,A.jsx)("div",{className:"".concat(M," ","primary"),children:(0,A.jsxs)("div",{className:"row full",children:[(0,A.jsx)("div",{className:"cell",children:(0,A.jsx)(Z.Z,{value:g.item})}),(0,A.jsx)("div",{className:"cell align-right".concat(" ",ce),children:k("data_list_item","setCurrentDataItem")})]})}),I(g.item,p.data[g.name][g.item],10,{})]}):null,g&&"table"===g.type&&g.item?(0,A.jsxs)("div",{className:"row full section-small",children:[(0,A.jsx)("div",{className:"".concat(M," ","primary"),children:(0,A.jsxs)("div",{className:"row full",children:[(0,A.jsx)("div",{className:"cell",children:(0,A.jsx)(Z.Z,{value:g.name+" - "+String(g.item._index+1)})}),(0,A.jsx)("div",{className:"cell align-right".concat(" ",ce),children:k("data_table_item","setCurrentDataItem")})]})}),Object.keys(g.fields).map((function(e,t){return(0,A.jsxs)("div",{className:"row full",children:[(0,A.jsx)("div",{className:"padding-small",children:(0,A.jsx)(Z.Z,{className:"bold",value:e})}),I(e,g.item[e],2,{field:e,_index:g.item._index})]},t)}))]}):null,g&&"list"===g.type&&!g.item?(0,A.jsxs)("div",{className:"section-small",children:[(0,A.jsx)("div",{className:"".concat(M," ","primary"),children:(0,A.jsxs)("div",{className:"row full",children:[(0,A.jsx)("div",{className:"cell",children:(0,A.jsx)(Z.Z,{value:g.name})}),(0,A.jsx)("div",{className:"cell align-right".concat(" ",ce),children:k("data_list","setCurrentData")})]})}),(0,A.jsx)(J.Z,{rows:g.items,listFilter:!0,filterPlaceholder:i("placeholder_filter"),onAddItem:function(){return c("setCurrentDataItem",[void 0])},labelAdd:i("label_new"),paginationPage:a,paginationTop:!0,onEdit:function(e){return c("setCurrentDataItem",[e.lslabel])},onDelete:function(e){return c("deleteDataItem",[{key:e.lslabel}])}})]}):null,g&&"table"===g.type&&!g.item?(0,A.jsxs)("div",{className:"section-small",children:[(0,A.jsx)("div",{className:"".concat(M," ","primary"),children:(0,A.jsxs)("div",{className:"row full",children:[(0,A.jsx)("div",{className:"cell",children:(0,A.jsx)(Z.Z,{value:g.name})}),(0,A.jsx)("div",{className:"cell align-right".concat(" ",ce),children:k("data_table","setCurrentData")})]})}),(0,A.jsx)(W.Z,{rowKey:"_index",fields:s()(g.fields,{$merge:{delete:{columnDef:{id:"delete",Header:"",headerStyle:{},Cell:function(e){var t=e.row;return e.value,(0,A.jsx)("div",{className:"cell".concat(" ",Q),children:(0,A.jsx)(L.Z,{id:"delete_"+t.original._index,iconKey:"Times",width:19,height:27.6,onClick:function(e){e.stopPropagation(),c("deleteDataItem",[{_index:t.original._index}])},className:Q})})},cellStyle:{width:40,padding:"7px 8px 3px 8px"}}}}}),rows:g.items,tableFilter:!0,filterPlaceholder:i("placeholder_filter"),onAddItem:function(){return c("setCurrentDataItem",[void 0])},onRowSelected:function(e){return c("setCurrentDataItem",[e])},labelAdd:i("label_new"),paginationPage:a,paginationTop:!0})]}):null,g?null:(0,A.jsx)("div",{className:"section-small",children:(0,A.jsx)(J.Z,{rows:_,listFilter:!0,filterPlaceholder:i("placeholder_filter"),onAddItem:function(){return c("addTemplateData",[])},labelAdd:i("label_new"),paginationPage:a,paginationTop:!0,onEdit:function(e){return c("setCurrentData",[{name:e.lslabel,type:e.lsvalue}])},onDelete:function(e){return c("deleteData",[e.lslabel])}})})]}):null,"meta"===u?(0,A.jsx)("div",{className:"row full border padding-normal",children:(0,A.jsxs)("div",{className:"cell section-small",children:[(0,A.jsx)("div",{className:"row centered border-top border-bottom mobile",children:Object.keys(p.meta).map((function(e){return(0,A.jsxs)("div",{className:"cell padding-small mobile top",children:[(0,A.jsx)("div",{className:"small bold",children:e}),(0,A.jsx)("div",{className:"small",children:p.meta[e]})]},e)}))}),(0,A.jsx)("div",{className:"section-small-top",children:(0,A.jsx)(Z.Z,{className:"bold",value:i("template_data_sources")})}),Object.keys(p.sources).map((function(e){return(0,A.jsx)("div",{className:"row section-small full",children:(0,A.jsxs)("div",{className:"cell padding-small",children:[(0,A.jsx)("div",{className:"border-top border-bottom padding-small",children:(0,A.jsx)(Z.Z,{className:"bold italic",value:e})}),Object.keys(p.sources[e]).map((function(t){return(0,A.jsxs)("div",{className:"row",children:[(0,A.jsxs)("div",{className:"cell padding-small top tiny bold",children:[t,":"]}),(0,A.jsx)("div",{className:"cell padding-small tiny",children:p.sources[e][t]})]},t)}))]})},e)}))]})}):null]})})})]})}))};ue.defaultProps={data:{title:"",tabView:"template",template:{meta:{},report:{},header:[],details:[],footer:[],sources:{},data:{}},current:{},current_data:null,dataset:[]},paginationPage:(0,O.$8)("paginationPage"),className:"",onEvent:void 0,getText:void 0};var pe=ue,fe=function(e){var t=e.data,a=e.current,l=e.onEvent,r=e.getText;return(0,A.jsxs)(o.Fragment,{children:[(0,A.jsx)(U,{side:a.side,templateKey:t.key,dirty:t.dirty,onEvent:l,getText:r}),(0,A.jsx)("div",{className:"page padding-normal".concat(" ",a.theme),children:(0,A.jsx)(pe,{data:t,onEvent:l,getText:r})})]})};fe.defaultProps={data:{},current:{},onPage:void 0,getText:void 0};var ge=(0,o.memo)(fe,(function(e,t){return e.data===t.data&&e.current.side===t.current.side})),_e=function(e){var t=e.getText;return{report:{options:{title:"REPORT"},rows:[{rowtype:"flip",name:"title",datatype:"string",default:"Nervatura Report"},{rowtype:"flip",name:"author",datatype:"string"},{rowtype:"flip",name:"creator",datatype:"string"},{rowtype:"flip",name:"subject",datatype:"string"},{rowtype:"flip",name:"keywords",datatype:"string"},{rowtype:"groupline"},{rowtype:"flip",name:"font-style",datatype:"select",default:"",options:[["",""],["bold","bold"],["italic","italic"],["bolditalic","bolditalic"]],info:t("info_font-style")},{rowtype:"flip",name:"font-size",datatype:"integer",default:12},{rowtype:"flip",name:"color",datatype:"color",info:t("info_color")},{rowtype:"flip",name:"border-color",datatype:"integer",default:0,max:255,min:0,info:t("info_border-color")},{rowtype:"flip",name:"background-color",datatype:"integer",default:0,max:255,min:0,info:t("info_background-color")},{rowtype:"groupline"},{rowtype:"flip",name:"left-margin",datatype:"integer",default:12},{rowtype:"flip",name:"right-margin",datatype:"integer",default:12},{rowtype:"flip",name:"top-margin",datatype:"integer",default:12}]},row:{options:{title:"ROW"},rows:[{rowtype:"flip",name:"height",datatype:"float",default:0},{rowtype:"flip",name:"hgap",datatype:"integer",default:0,info:t("info_hgap")},{rowtype:"flip",name:"visible",datatype:"string",info:t("info_visible")}]},cell:{options:{title:"CELL"},rows:[{rowtype:"flip",name:"name",datatype:"string",default:"head",info:t("info_name")},{rowtype:"flip",name:"value",datatype:"string",info:t("info_value")},{rowtype:"flip",name:"width",datatype:"percent",info:t("info_width")},{rowtype:"flip",name:"align",datatype:"select",default:"left",options:[["left","left"],["right","right"],["center","center"]],info:t("info_align")},{rowtype:"flip",name:"multiline",datatype:"select",default:"false",options:[["false","false"],["true","true"]],info:t("info_multiline")},{rowtype:"groupline"},{rowtype:"flip",name:"font-style",datatype:"select",default:"",options:[["",""],["bold","bold"],["italic","italic"],["bolditalic","bolditalic"]],info:t("info_font-style")},{rowtype:"flip",name:"font-size",datatype:"integer",default:12},{rowtype:"flip",name:"color",datatype:"color",info:t("info_color")},{rowtype:"flip",name:"border-color",datatype:"integer",default:0,max:255,min:0,info:t("info_border-color")},{rowtype:"flip",name:"background-color",datatype:"integer",default:0,max:255,min:0,info:t("info_background-color")},{rowtype:"flip",name:"border",datatype:"checklist",values:["1|All","L|Left","T|Top","R|Right","B|Bottom"]}]},image:{options:{title:"IMAGE"},rows:[{rowtype:"flip",name:"src",datatype:"image",info:t("info_src")},{rowtype:"flip",name:"height",datatype:"float",default:0,info:t("info_height_image")}]},barcode:{options:{title:"BARCODE"},rows:[{rowtype:"flip",name:"code-type",datatype:"select",default:"ITF",options:[["ITF","ITF"],["CODE_39","CODE_39"],["CODE_128","CODE_128"],["EAN","EAN"],["QR","QR"]],info:t("info_code-type")},{rowtype:"flip",name:"value",datatype:"string",default:"",info:t("info_barcode_value")},{rowtype:"flip",name:"visible-value",datatype:"select",default:"0",options:[["0","0"],["1","1"]],info:t("info_visible-value")},{rowtype:"flip",name:"wide",datatype:"float",default:0,info:t("info_optional")},{rowtype:"flip",name:"narrow",datatype:"float",default:0,info:t("info_optional")}]},separator:{options:{title:"SEPARATOR"},rows:[{rowtype:"flip",name:"hgap",datatype:"integer",default:0,info:t("info_hgap")}]},vgap:{options:{title:"VGAP"},rows:[{rowtype:"flip",name:"height",datatype:"float",default:0,info:t("info_height")}]},hline:{options:{title:"HLINE"},rows:[{rowtype:"flip",name:"width",datatype:"percent",info:t("info_width")},{rowtype:"flip",name:"gap",datatype:"integer",default:0,info:t("info_gap")},{rowtype:"flip",name:"border-color",datatype:"integer",default:0,max:255,min:0,info:t("info_border-color")}]},html:{options:{title:"HTML"},rows:[{rowtype:"flip",name:"html",datatype:"text",default:"",info:t("info_html")}]},datagrid:{options:{title:"DATAGRID"},rows:[{rowtype:"flip",name:"name",datatype:"string",default:"items",info:t("info_datagrid_name")},{rowtype:"flip",name:"databind",datatype:"string",default:"",info:t("info_databind")},{rowtype:"flip",name:"width",datatype:"percent",info:t("info_width")},{rowtype:"flip",name:"merge",datatype:"select",default:"0",options:[["0","0"],["1","1"]],info:t("info_merge")},{rowtype:"flip",name:"font-size",datatype:"integer",default:12},{rowtype:"flip",name:"border",datatype:"checklist",values:["1|All","L|Left","T|Top","R|Right","B|Bottom"]},{rowtype:"flip",name:"color",datatype:"color",info:t("info_color")},{rowtype:"flip",name:"border-color",datatype:"integer",default:0,max:255,min:0,info:t("info_border-color")},{rowtype:"flip",name:"background-color",datatype:"integer",default:0,max:255,min:0,info:t("info_background-color")},{rowtype:"flip",name:"header-background",datatype:"integer",default:0,max:255,min:0,info:t("info_background-color")},{rowtype:"flip",name:"footer-background",datatype:"integer",default:0,max:255,min:0,info:t("info_background-color")}]},column:{options:{title:"COLUMN"},rows:[{rowtype:"flip",name:"fieldname",datatype:"string",default:"",info:t("info_fieldname")},{rowtype:"flip",name:"label",datatype:"string",default:"",info:t("info_label")},{rowtype:"flip",name:"width",datatype:"percent",info:t("info_width")},{rowtype:"flip",name:"align",datatype:"select",default:"left",options:[["left","left"],["right","right"],["center","center"]],info:t("info_align")},{rowtype:"flip",name:"header-align",datatype:"select",default:"left",options:[["left","left"],["right","right"],["center","center"]],info:t("info_align")},{rowtype:"flip",name:"footer-align",datatype:"select",default:"left",options:[["left","left"],["right","right"],["center","center"]],info:t("info_align")},{rowtype:"flip",name:"thousands",datatype:"string",default:"",info:t("info_thousands")},{rowtype:"flip",name:"digit",datatype:"integer",default:0,info:t("info_digit")},{rowtype:"flip",name:"footer",datatype:"string",default:"",info:t("info_footer")}]},header:{options:{title:"HEADER"},rows:[]},details:{options:{title:"DETAILS"},rows:[]},footer:{options:{title:"FOOTER"},rows:[]}}},he=a(7112),xe=function(e){var t=(0,o.useContext)(c.ZP),i=t.data,f=t.setData,x=(0,d.xZ)(i,f),v=function(e,t){var l=(0,d.xZ)(e,t),n=function(e){return Object.getOwnPropertyNames(e).length>0?Object.getOwnPropertyNames(e)[0]:null},o=function(e){var t=[];return Object.keys(e).forEach((function(a){"string"===typeof e[a]?t.push({lslabel:a,lsvalue:"string"}):Array.isArray(e[a])?t.push({lslabel:a,lsvalue:"table"}):t.push({lslabel:a,lsvalue:"list"})})),t},i=function(a,r){var n=a.tmp_id.split("_"),o=s()(r||e.template,{$merge:{current:{id:a.tmp_id,section:n[1]}}});2===n.length&&(o=s()(o,{current:{$merge:{type:n[1],item:o.template[o.current.section],index:null,parent:null,parent_type:null,parent_index:null}}})),4===n.length&&(o=s()(o,{current:{$merge:{type:n[3],index:parseInt(n[2],10),parent:o.template[o.current.section],parent_type:o.current.section,parent_index:null}}}),o=["row","datagrid"].includes(o.current.type)?s()(o,{current:{$merge:{item:o.template[o.current.section][parseInt(n[2],10)][n[3]].columns,item_base:o.template[o.current.section][parseInt(n[2],10)][n[3]]}}}):s()(o,{current:{$merge:{item:o.template[o.current.section][parseInt(n[2],10)][n[3]]}}})),6===n.length&&(o=s()(o,{current:{$merge:{type:n[5],item:o.template[o.current.section][parseInt(n[2],10)][n[3]].columns[parseInt(n[4],10)][n[5]],index:parseInt(n[4],10),parent:o.template[o.current.section][parseInt(n[2],10)][n[3]].columns,parent_type:n[3],parent_index:parseInt(n[2],10)}}})),o=s()(o,{current:{$merge:{form:_e({getText:l.getText})[o.current.type]}}}),a.set_dirty&&!["_blank","_sample"].includes(o.key)&&(o=s()(o,{$merge:{dirty:!0}})),t("template",o)},c=function(e){var n={id:void 0,key:e.type,title:"Nervatura Report",template:{meta:{reportkey:e.type,nervatype:"",transtype:"",direction:"",repname:"Nervatura Report",description:"",filetype:"pdf"},report:{},header:[],details:[],footer:[],sources:{},data:{}},current:{},current_data:null,dataset:[],docnumber:"",tabView:"template",dirty:!1};if("_sample"===e.type){var c=a(5170);n=s()(n,{template:{$merge:(0,r.Z)({},c)},dataset:{$set:o(c.data)}})}if("template"===e.type){var d={};try{d=JSON.parse(e.dataset.template[0].report)}catch(m){return t("current",{module:"setting"}),l.resultError({error:{message:m.message}})}n=s()(n,{$merge:{id:e.dataset.template[0].id,key:e.dataset.template[0].reportkey,title:e.dataset.template[0].repname,template:d,dbtemp:e.dataset.template[0]}}),n=s()(n,{$merge:{dataset:o(n.template.data)}})}i({tmp_id:"tmp_report"},n),t("current",{module:"template",side:"hide"})},f=function(){var a=(0,u.Z)((0,m.Z)().mark((function a(r){var n;return(0,m.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=function(){var t=(0,u.Z)((0,m.Z)().mark((function t(){var a,r,n;return(0,m.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=s()(e.template,{}),r={id:a.id,report:JSON.stringify(a.template)},t.next=4,l.requestData("/ui_report",{method:"POST",data:[r]});case 4:if(!(n=t.sent).error){t.next=8;break}return l.resultError(n),t.abrupt("return",null);case 8:return a=s()(a,{$merge:{dirty:!1}}),t.abrupt("return",a);case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),!r){a.next=5;break}t("current",{modalForm:(0,A.jsx)(h.default,{title:l.getText("template_label_template"),message:l.getText("msg_dirty_info"),infoText:l.getText("msg_delete_info"),labelOK:l.getText("msg_ok"),labelCancel:l.getText("msg_cancel"),defaultOK:!0,onCancel:function(){t("current",{modalForm:null})},onOK:function(e){t("current",{modalForm:null},(0,u.Z)((0,m.Z)().mark((function e(){var a;return(0,m.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n();case 2:(a=e.sent)&&t("template",a);case 4:case"end":return e.stop()}}),e)}))))}}),side:"hide"}),a.next=8;break;case 5:return a.next=7,n();case 7:return a.abrupt("return",a.sent);case 8:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),x=function(){var a=(0,u.Z)((0,m.Z)().mark((function a(){return(0,m.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t("current",{modalForm:(0,A.jsx)(h.default,{title:l.getText("msg_warning"),message:l.getText("msg_delete_text"),infoText:l.getText("msg_delete_info"),labelOK:l.getText("msg_ok"),labelCancel:l.getText("msg_cancel"),onCancel:function(){t("current",{modalForm:null})},onOK:function(a){t("current",{modalForm:null},(0,u.Z)((0,m.Z)().mark((function a(){var r;return(0,m.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,l.requestData("/ui_report",{method:"DELETE",query:{id:e.template.id}});case 2:if(!(r=a.sent)||!r.error){a.next=5;break}return a.abrupt("return",l.resultError(r));case 5:t("current",{module:"setting",content:{type:"template"}});case 6:case"end":return a.stop()}}),a)}))))}}),side:"hide"});case 1:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}(),v=function(e){var t=[];return Object.keys(e).forEach((function(a){t.push({lslabel:a,lsvalue:e[a]})})),t},b=function(e){var t={fields:{},items:[]};if(e.length>0){Object.keys(e[0]).forEach((function(e){t.fields[e]={fieldtype:"string",label:e}}));for(var a=0;a<e.length;a++){var l=s()(e[a],{$merge:{_index:a}});t.items.push(l)}}return t},y=function(a){var r=s()(e.template,{}),n=function(e){["_blank","_sample"].includes(r.key)||(r=s()(r,{$merge:{dirty:!0}})),r=s()(r,{$merge:{current_data:e}}),t("template",r)};if(a)switch(a.type){case"new":if(Object.keys(r.template.data).includes(a.values.name)||""===a.values.name)l.showToast({type:"error",title:l.getText("msg_warning"),message:l.getText("msg_value_exists")});else if("table"===a.values.type&&""===a.values.columns)l.showToast({type:"error",title:l.getText("msg_warning"),message:l.getText("template_missing_columns")});else{var i=s()({},{$set:{name:a.values.name,type:a.values.type}});switch(i.type){case"list":r=s()(r,{template:{data:{$merge:(0,p.Z)({},i.name,{})}}}),i.items=v({});break;case"table":r=s()(r,{template:{data:{$merge:(0,p.Z)({},i.name,[])}}});for(var c=a.values.columns.split(","),d={},m=0;m<c.length;m++)d[String(c[m]).trim()]="";r=s()(r,{template:{data:(0,p.Z)({},i.name,{$push:[d]})}});var u=b([d]);i.items=u.items,i.fields=u.fields;break;default:r=s()(r,{template:{data:{$merge:(0,p.Z)({},i.name,"")}}})}r=s()(r,{$merge:{dataset:o(r.template.data)}}),n(i)}break;case"list":a.items=v(r.template.data[a.name]),n(a);break;case"table":var f=b(r.template.data[a.name]);a.items=f.items,a.fields=f.fields,n(a);break;default:n(a)}else n(a)};return{addItem:function(t){var a=e.template.current;if(""!==t){var l=t.toString().toLowerCase(),r={};r[l]={};var n=a.id+"_"+a.item.length.toString()+"_"+l;"datagrid"!==l&&"row"!==l||(r[l].columns=[]),a.item.push(r),i({tmp_id:n,set_dirty:!0})}},addTemplateData:function(){t("current",{modalForm:(0,A.jsx)(D,{name:"",type:"string",columns:"",getText:l.getText,onClose:function(){t("current",{modalForm:null})},onData:function(e){t("current",{modalForm:null},(0,u.Z)((0,m.Z)().mark((function t(){return(0,m.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:y({name:"new",type:"new",values:(0,r.Z)({},e)});case 1:case"end":return t.stop()}}),t)}))))}})})},changeCurrentData:function(a){var l=a.key,r=a.value,n=s()(e.template,{current:{$merge:(0,p.Z)({},l,r)}});t("template",n)},changeTemplateData:function(a){var l=a.key,r=a.value,n=s()(e.template,{$merge:(0,p.Z)({},l,r)});t("template",n)},checkTemplate:function(a){var r={NEW_BLANK:function(){return c({type:"_blank"})},NEW_SAMPLE:function(){return c({type:"_sample"})},LOAD_SETTING:function(){return t("current",{module:"setting",content:{type:"template"},side:"hide"})}};return!0===e.template.dirty?t("current",{modalForm:(0,A.jsx)(h.default,{title:l.getText("msg_warning"),message:l.getText("msg_dirty_text"),infoText:l.getText("msg_dirty_info"),labelOK:l.getText("msg_save"),labelCancel:l.getText("msg_cancel"),onCancel:function(){t("current",{modalForm:null},(function(){t(e.current.module,{dirty:!1},(function(){return r[a]()}))}))},onOK:function(){t("current",{modalForm:null},(0,u.Z)((0,m.Z)().mark((function e(){var l;return(0,m.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:if(!(l=e.sent)){e.next=5;break}return e.abrupt("return",t("template",l,(function(){return r[a]()})));case 5:case"end":return e.stop()}}),e)}))))}})}):r[a]()},createMap:function(t){var a=e.template,l=a.template,r=a.current,o=t.getContext("2d"),i="#CCCCCC",s="#FFFF00",c="#00EE00",d=[];t.height=3;for(var m=["header","details","footer"],u=0;u<m.length;u++)for(var p=0;p<l[m[u]].length;p++){var f={};f.type=n(l[m[u]][p]);var g=l[m[u]][p][f.type];if("row"===f.type||"datagrid"===f.type){if(f.cols=l[m[u]][p][f.type].columns.length,f.selected=g.columns===r.item||g.columns===r.parent,f.selcol=-1,f.selected)for(var _=0;_<f.cols;_++){var h=n(l[m[u]][p][f.type].columns[_]);l[m[u]][p][f.type].columns[_][h]===r.item&&(f.selcol=_)}9*f.cols+6>t.width&&(t.width=9*f.cols+6)}else f.selected=g===r.item,f.cols=1;switch(f.type){case"vgap":l[m[u]][p][f.type].height>2?f.height=l[m[u]][p][f.type].height:f.height=2,t.height+=f.height;break;case"hline":t.height+=2;break;case"datagrid":t.height+=20;break;default:t.height+=9}l[m[u]]!==r.item&&l.report!==r.item||(f.selected=!0),d.push(f)}t.height+=3,t.height<165&&(t.height=165);for(var x=3,v=3,b=0,y=0;y<d.length;y++){if("row"===d[y].type){b=(t.width-(9*d[y].cols+6))/d[y].cols;for(var w=0;w<d[y].cols;w++)d[y].selected?d[y].selcol===w||-1===d[y].selcol?o.fillStyle=c:o.fillStyle=s:o.fillStyle=i,o.fillRect(x,v,8+b,8),x+=8+b+1;v+=9}if("datagrid"===d[y].type){d[y].selected?o.fillStyle=c:o.fillStyle=i,o.fillRect(x,v,t.width-6-1,4),b=(t.width-(9*d[y].cols+6))/d[y].cols;for(var j=0;j<d[y].cols;j++)d[y].selected?d[y].selcol===j||-1===d[y].selcol?o.fillStyle=c:o.fillStyle=s:o.fillStyle=i,o.fillRect(x,v+4+1,8+b,4),o.fillRect(x,v+8+2,8+b,4),o.fillRect(x,v+12+3,8+b,4),x+=8+b+1;v+=20}"vgap"===d[y].type&&(d[y].selected&&(o.fillStyle=c,o.fillRect(x,v-1,t.width-6-1,d[y].height)),v+=d[y].height),"vgap"===d[y].type&&(d[y].selected?o.strokeStyle=c:o.strokeStyle=i,o.beginPath(),o.moveTo(x,v),o.lineTo(t.width-3-1,v),o.stroke(),v+=2),"html"===d[y].type&&(d[y].selected?o.fillStyle=c:o.fillStyle=i,o.fillRect(x,v,t.width-6-1,8),v+=9),x=3}},createTemplate:function(){var a=function(a,l){var r={},n=(0,he.o)(e,t)({tablename:a,dataset:e.setting.dataset,current:e.setting.current});for(var o in l)n.hasOwnProperty(o)&&(r[o]=l[o]);return r},r=e.template.template.meta.nervatype;"trans"===r&&(r=e.template.template.meta.transtype+"_"+e.template.template.meta.direction),r+="_"+(0,_.Z)(new Date,"yyyyMMddHHmm"),t("current",{modalForm:(0,A.jsx)(h.default,{title:l.getText("template_label_new"),message:r,value:e.template.repname,showValue:!0,labelOK:l.getText("msg_ok"),labelCancel:l.getText("msg_cancel"),onCancel:function(){t("current",{modalForm:null})},onOK:function(n){t("current",{modalForm:null},(0,u.Z)((0,m.Z)().mark((function o(){var i,c,d;return(0,m.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return i=s()(e.template.template,{meta:{$merge:{reportkey:r,repname:n}}}),c=s()(a("report",e.template.dbtemp),{$merge:{id:null,reportkey:r,repname:n,report:JSON.stringify(i)}}),c=s()(c,{$unset:["orientation","size"]}),o.next=5,l.requestData("/ui_report",{method:"POST",data:[c]});case 5:if(!(d=o.sent).error){o.next=8;break}return o.abrupt("return",l.resultError(d));case 8:t("current",{module:"setting",content:{type:"template",id:d[0]},side:"hide"});case 9:case"end":return o.stop()}}),o)}))))}}),side:"hide"})},deleteData:function(a){t("current",{modalForm:(0,A.jsx)(h.default,{title:l.getText("msg_warning"),message:l.getText("msg_delete_text"),infoText:l.getText("msg_delete_info"),labelOK:l.getText("msg_ok"),labelCancel:l.getText("msg_cancel"),onCancel:function(){t("current",{modalForm:null})},onOK:function(l){t("current",{modalForm:null},(0,u.Z)((0,m.Z)().mark((function l(){var r;return(0,m.Z)().wrap((function(l){for(;;)switch(l.prev=l.next){case 0:r=s()(e.template,{template:{data:{$unset:[a]}}}),["_blank","_sample"].includes(r.key)||(r=s()(r,{$merge:{dirty:!0}})),r=s()(r,{$merge:{dataset:o(r.template.data)}}),t("template",r);case 4:case"end":return l.stop()}}),l)}))))}})})},deleteDataItem:function(a){t("current",{modalForm:(0,A.jsx)(h.default,{title:l.getText("msg_warning"),message:l.getText("msg_delete_text"),infoText:l.getText("msg_delete_info"),labelOK:l.getText("msg_ok"),labelCancel:l.getText("msg_cancel"),onCancel:function(){t("current",{modalForm:null})},onOK:function(l){t("current",{modalForm:null},(0,u.Z)((0,m.Z)().mark((function l(){var r;return(0,m.Z)().wrap((function(l){for(;;)switch(l.prev=l.next){case 0:r=s()(e.template,{}),l.t0=r.current_data.type,l.next="list"===l.t0?4:(l.t0,7);break;case 4:return r=s()(r,{template:{data:(0,p.Z)({},r.current_data.name,{$unset:[a.key]})}}),r=s()(r,{current_data:{$merge:{items:v(r.template.data[r.current_data.name])}}}),l.abrupt("break",9);case 7:return 1===r.template.data[r.current_data.name].length?(r=s()(r,{template:{data:{$unset:[r.current_data.name]}}}),r=s()(r,{$merge:{current_data:null,dataset:o(r.template.data)}})):(r=s()(r,{template:{data:(0,p.Z)({},r.current_data.name,{$splice:[[a._index,1]]})}}),r=s()(r,{current_data:{$merge:{items:b(r.template.data[r.current_data.name]).items}}})),l.abrupt("break",9);case 9:r=s()(r,{$merge:{dataset:o(r.template.data)}}),["_blank","_sample"].includes(r.key)||(r=s()(r,{$merge:{dirty:!0}})),t("template",r);case 12:case"end":return l.stop()}}),l)}))))}})})},deleteItem:function(){var t=e.template.current;if(null!==t.parent&&null!==t.index){t.parent.splice(t.index,1);var a="tmp_"+t.section;null!==t.parent_index&&(a+="_"+t.parent_index.toString()+"_"+t.parent_type),i({tmp_id:a,set_dirty:!0})}},deleteTemplate:x,editDataItem:function(a){var l=s()(e.template,{});switch(["_blank","_sample"].includes(l.key)||(l=s()(l,{$merge:{dirty:!0}})),l.current_data.type){case"string":l=s()(l,{template:{data:{$merge:(0,p.Z)({},l.current_data.name,a.value)}}});break;case"list":l=s()(l,{template:{data:(0,p.Z)({},l.current_data.name,{$merge:(0,p.Z)({},l.current_data.item,a.value)})}}),l=s()(l,{current_data:{$merge:{items:v(l.template.data[l.current_data.name])}}});break;default:l=s()(l,{current_data:{item:{$merge:(0,p.Z)({},a.field,a.value)}}}),l=s()(l,{template:{data:(0,p.Z)({},l.current_data.name,(0,p.Z)({},a._index,{$merge:(0,p.Z)({},a.field,a.value)}))}}),l=s()(l,{current_data:{$merge:{items:b(l.template.data[l.current_data.name]).items}}})}t("template",l)},editItem:function(t){var a=s()(e.template,{}),l=a.current.id,r=l.split("_"),n=function(e,t){a=null===t?s()(a,{current:{item_base:{$unset:[e]}}}):s()(a,{current:{item_base:{$merge:(0,p.Z)({},e,t)}}}),a=s()(a,{template:(0,p.Z)({},a.current.section,(0,p.Z)({},parseInt(r[2],10),(0,p.Z)({},r[3],{$set:a.current.item_base})))})},o=function(e,t){switch(a=null===t?s()(a,{current:{item:{$unset:[e]}}}):s()(a,{current:{item:{$merge:(0,p.Z)({},e,t)}}}),r.length){case 2:a=s()(a,{template:(0,p.Z)({},a.current.section,{$set:a.current.item})});break;case 4:a=s()(a,{template:(0,p.Z)({},a.current.section,(0,p.Z)({},parseInt(r[2],10),(0,p.Z)({},r[3],{$set:a.current.item})))});break;default:a=s()(a,{template:(0,p.Z)({},a.current.section,(0,p.Z)({},parseInt(r[2],10),(0,p.Z)({},r[3],{columns:(0,p.Z)({},parseInt(r[4],10),(0,p.Z)({},r[5],{$set:a.current.item}))})))})}};if(["_blank","_sample"].includes(a.key)||(a=s()(a,{$merge:{dirty:!0}})),t.selected){var c="";if(t.value){if(t.defvalue)c=t.defvalue;else switch(t.datatype){case"float":case"integer":c=0;break;default:c=""}a.current.item_base?n(t.name,c):o(t.name,c)}else a.current.item_base?n(t.name,null):o(t.name,null)}else if(t.file){if(t.value.length>0){var d=t.value[0],m=new FileReader;m.onload=function(e){o(t.name,e.target.result),i({tmp_id:l},a)},m.readAsDataURL(d)}}else if(t.checklist){var u=(a.current.item_base?a.current.item_base[t.name]:a.current.item[t.name])||"",f=t.value;t.checked?"1"!==f&&"1"!==u&&(f=u+f):(a.current.item_base,f=u.replace(f,"")),a.current.item_base?n(t.name,f):o(t.name,f)}else a.current.item_base?n(t.name,t.value):o(t.name,t.value);t.file||i({tmp_id:l},a)},exportTemplate:function(){t("current",{side:"hide"},(function(){var t=JSON.stringify(e.template.template),a=URL.createObjectURL(new Blob([t],{type:"text/json;charset=utf-8;"}));(0,d.GX)(a,e.template.key+".json")}))},getDataList:v,getDataTable:b,getElementType:n,getDataset:o,goNext:function(){i(function(){var t,a,l=e.template,r=l.current,o=l.template,i=r.section,s=r.parent_index,c=r.index;null===r.parent_index&&(s=r.index,c=null);var d=["report","header","details","footer"];if(null!==c&&(t=n(o[i][s]),c<o[i][s][t].columns.length-1))return a=n(o[i][s][t].columns[c+1]),{tmp_id:"tmp_"+i+"_"+s.toString()+"_"+t+"_"+(c+1).toString()+"_"+a};if(null!==s){if(null===c&&("row"===(t=n(o[i][s]))||"datagrid"===t)&&o[i][s][t].columns.length>0)return a=n(o[i][s][t].columns[0]),{tmp_id:"tmp_"+i+"_"+s.toString()+"_"+t+"_0_"+a};if(s<o[i].length-1)return t=n(o[i][s+1]),{tmp_id:"tmp_"+i+"_"+(s+1).toString()+"_"+t};if("footer"===i)return null!==c?(a=n(o[i][s][t].columns[c]),{tmp_id:"tmp_"+i+"_"+s.toString()+"_"+t+"_"+c.toString()+"_"+a}):{tmp_id:"tmp_"+i+"_"+s.toString()+"_"+t};i=d[d.indexOf(i)+1]}return o[i].length>0?{tmp_id:"tmp_"+i+"_0_"+(t=n(o[i][0]))}:("footer"!==i&&(i=d[d.indexOf(i)+1]),{tmp_id:"tmp_"+i})}())},goPrevious:function(){i(function(){var t,a,l=e.template,r=l.current,o=l.template,i=r.section,s=r.parent_index,c=r.index;if(null===r.parent_index&&(s=r.index,c=null),"report"===i)return{tmp_id:"tmp_report"};if(null!==c)return t=n(o[i][s]),c>0?(a=n(o[i][s][t].columns[c-1]),{tmp_id:"tmp_"+i+"_"+s.toString()+"_"+t+"_"+(c-1).toString()+"_"+a}):{tmp_id:"tmp_"+i+"_"+s.toString()+"_"+t};if(null!==s)return s>0?("row"===(t=n(o[i][s-1]))||"datagrid"===t)&&(c=o[i][s-1][t].columns.length)>0?(a=n(o[i][s-1][t].columns[c-1]),{tmp_id:"tmp_"+i+"_"+(s-1).toString()+"_"+t+"_"+(c-1).toString()+"_"+a}):{tmp_id:"tmp_"+i+"_"+(s-1).toString()+"_"+t}:{tmp_id:"tmp_"+i};var d=["report","header","details","footer"];return"report"===(i=d[d.indexOf(i)-1])?{tmp_id:"tmp_report"}:(s=o[i].length)>0?("row"===(t=n(o[i][s-1]))||"datagrid"===t)&&(c=o[i][s-1][t].columns.length)>0?(a=n(o[i][s-1][t].columns[c-1]),{tmp_id:"tmp_"+i+"_"+(s-1).toString()+"_"+t+"_"+(c-1).toString()+"_"+a}):{tmp_id:"tmp_"+i+"_"+(s-1).toString()+"_"+t}:{tmp_id:"tmp_"+i}}())},moveDown:function(){var t=e.template.current;if(null!==t.parent&&null!==t.index&&t.index<t.parent.length-1){var a=t.parent[t.index+1];t.parent[t.index+1]=t.parent[t.index],t.parent[t.index]=a;var l="tmp_"+t.section+"_";null!==t.parent_index&&(l+=t.parent_index.toString()+"_"+t.parent_type+"_"),l+=(t.index+1).toString()+"_"+t.type,i({tmp_id:l,set_dirty:!0})}},moveUp:function(){var t=e.template.current;if(null!==t.parent&&null!==t.index&&t.index>0){var a=t.parent[t.index-1];t.parent[t.index-1]=t.parent[t.index],t.parent[t.index]=a;var l="tmp_"+t.section+"_";null!==t.parent_index&&(l+=t.parent_index.toString()+"_"+t.parent_type+"_"),l+=(t.index-1).toString()+"_"+t.type,i({tmp_id:l,set_dirty:!0})}},saveTemplate:f,setCurrentDataItem:function(a){var r=s()(e.template,{}),n=function(e){["_blank","_sample"].includes(r.key)||(r=s()(r,{$merge:{dirty:!0}})),r=s()(r,{current_data:{$merge:{item:e}}}),t("template",r)};"undefined"===typeof a?("list"===r.current_data.type&&t("current",{modalForm:(0,A.jsx)(h.default,{title:l.getText("msg_input_title"),message:l.getText("msg_new_fieldname"),value:"",showValue:!0,labelOK:l.getText("msg_ok"),labelCancel:l.getText("msg_cancel"),onCancel:function(){t("current",{modalForm:null})},onOK:function(e){t("current",{modalForm:null},(0,u.Z)((0,m.Z)().mark((function t(){return(0,m.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:""!==e&&(Object.keys(r.template.data[r.current_data.name]).includes(e)?l.showToast({type:"error",title:l.getText("msg_warning"),message:l.getText("msg_value_exists")}):(r=s()(r,{template:{data:(0,p.Z)({},r.current_data.name,{$merge:(0,p.Z)({},e,"")})}}),r=s()(r,{current_data:{$merge:{items:v(r.template.data[r.current_data.name])}}}),n(e)));case 1:case"end":return t.stop()}}),t)}))))}})}),"table"===r.current_data.type&&function(){var e=s()(r.template.data[r.current_data.name][0],{$merge:{_index:r.template.data[r.current_data.name].length}});Object.keys(e).forEach((function(t){"_index"!==t&&(e[t]="")})),r=s()(r,{template:{data:(0,p.Z)({},r.current_data.name,{$push:[e]})}}),r=s()(r,{current_data:{$merge:{items:b(r.template.data[r.current_data.name]).items}}}),n(e)}()):n(a)},setCurrentData:y,setCurrent:i,setTemplate:c,showPreview:function(a){var r=function(){var e=(0,u.Z)((0,m.Z)().mark((function e(t){var a;return(0,m.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.requestData("/report",{method:"POST",data:t});case 2:if(!(a=e.sent).error){e.next=6;break}return l.resultError(a),e.abrupt("return",null);case 6:g()({printable:URL.createObjectURL(a,{type:"application/pdf"}),type:"pdf",base64:!1});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n=s()(e.template,{}),o={reportkey:n.key,orientation:a||(0,O.$8)("page_orient"),size:(0,O.$8)("page_size"),output:"auto",title:n.title,template:JSON.stringify(n.template)};["_blank","_sample"].includes(n.key)?(o.reportkey="",r(o)):(o.nervatype=n.template.meta.nervatype,t("current",{modalForm:(0,A.jsx)(h.default,{title:l.getText("template_preview_data"),message:l.getText("template_preview_input").replace("docname",o.nervatype),value:n.docnumber,showValue:!0,labelOK:l.getText("msg_ok"),labelCancel:l.getText("msg_cancel"),onCancel:function(){t("current",{modalForm:null})},onOK:function(e){t("current",{modalForm:null},(0,u.Z)((0,m.Z)().mark((function a(){var l;return(0,m.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:""!==e&&(l=s()(n,{$merge:{docnumber:e}}),t("template",l),o.refnumber=e,r(o));case 1:case"end":return a.stop()}}),a)}))))}}),side:"hide"}))}}}(i,f),b=(0,o.useState)(s()({},{$merge:(0,r.Z)({},e)})),y=(0,n.Z)(b,1)[0];return y.data=s()(y.data,{$merge:(0,r.Z)({},i[y.key])}),y.current=s()(y.current,{$merge:(0,r.Z)({},i.current)}),(0,o.useEffect)((function(){if(y.current&&y.current.content){var e=y.current.content;f("current",{content:null},(function(){v.setTemplate(e)}))}}),[f,v,y]),y.getText=function(e,t){return x.getText(e,t)},y.onEvent=function(e,t){if(x[e])return x[e].apply(x,(0,l.Z)(t));v[e].apply(v,(0,l.Z)(t))},y.data.template?(0,A.jsx)(ge,(0,r.Z)({},y)):(0,A.jsx)("div",{})};xe.defaultProps=(0,r.Z)({key:"template"},fe.defaultProps);var ve=xe},5170:function(e){e.exports=JSON.parse('{"meta":{"reportkey":"_sample","nervatype":"","transtype":"","direction":"","repname":"Nervatura Report","description":"","filetype":"pdf"},"report":{"title":"Nervatura Report","left-margin":15,"top-margin":15,"right-margin":15},"header":[{"row":{"columns":[{"image":{"src":"logo"}},{"cell":{"name":"label","value":"labels.title","font-style":"bolditalic","font-size":26,"color":"#696969"}},{"cell":{"name":"label","value":"JSON Sample","align":"right","font-style":"bold"}}],"height":10}},{"vgap":{"height":2}},{"hline":{"border-color":218}},{"vgap":{"height":2}}],"details":[{"vgap":{"height":2}},{"row":{"columns":[{"cell":{"name":"label","width":"50%","font-style":"bold","value":"labels.left_text","border":"LT","border-color":218,"background-color":245}},{"cell":{"name":"label","font-style":"bold","value":"labels.left_text","border":"LTR","border-color":218,"background-color":245}}]}},{"row":{"columns":[{"cell":{"name":"short_text","width":"50%","value":"head.short_text","border":"L","border-color":218}},{"cell":{"name":"short_text","value":"head.short_text","border":"LR","border-color":218}}]}},{"row":{"columns":[{"cell":{"name":"short_text","width":"50%","value":"head.short_text","border":"LB","border-color":218}},{"cell":{"name":"short_text","value":"head.short_text","border":"LBR","border-color":218}}]}},{"row":{"columns":[{"cell":{"name":"label","width":"40","font-style":"bold","value":"labels.left_text","border":"LB","border-color":218}},{"cell":{"name":"label","align":"center","width":"30","font-style":"bold","value":"labels.center_text","border":"LB","border-color":218}},{"cell":{"name":"label","align":"right","width":"40","font-style":"bold","value":"labels.right_text","border":"LB","border-color":218}},{"cell":{"name":"label","font-style":"bold","value":"labels.left_text","border":"LBR","border-color":218}}]}},{"row":{"columns":[{"cell":{"name":"short_text","width":"40","value":"head.short_text","border":"LB","border-color":218}},{"cell":{"name":"date","align":"center","width":"30","value":"head.date","border":"LB","border-color":218}},{"cell":{"name":"amount","align":"right","width":"40","value":"head.number","border":"LB","border-color":218}},{"cell":{"name":"short_text","value":"head.short_text","border":"LBR","border-color":218}}]}},{"row":{"columns":[{"cell":{"name":"label","font-style":"bold","value":"labels.left_text","border":"LB","border-color":218}},{"cell":{"name":"short_text","width":"50","value":"head.short_text","border":"LB","border-color":218}},{"cell":{"name":"label","font-style":"bold","value":"labels.left_text","border":"LB","border-color":218}},{"cell":{"name":"short_text","value":"head.short_text","border":"LBR","border-color":218}}]}},{"row":{"columns":[{"cell":{"name":"long_text","multiline":"true","value":"head.long_text","border":"LBR","border-color":218}}]}},{"vgap":{"height":2}},{"row":{"columns":[{"cell":{"name":"label","value":"labels.left_text","font-style":"bold","border":"1","border-color":245,"background-color":245}},{"cell":{"name":"short_text","value":"head.short_text","border":"1","border-color":218}},{"cell":{"name":"label","value":"labels.left_text","font-style":"bold","border":"1","border-color":245,"background-color":245}},{"cell":{"name":"short_text","value":"head.short_text","border":"1","border-color":218}}],"hgap":2}},{"vgap":{"height":2}},{"row":{"columns":[{"cell":{"name":"label","value":"labels.long_text","font-style":"bold","border":"1","border-color":245,"background-color":245}},{"cell":{"name":"long_text","multiline":"true","value":"head.long_text","border":"1","border-color":218}}],"hgap":2}},{"vgap":{"height":2}},{"hline":{"border-color":218}},{"vgap":{"height":2}},{"row":{"columns":[{"cell":{"name":"label","value":"Barcode (Interleaved 2of5)","font-style":"bold","font-size":10,"border":"1","border-color":245,"background-color":245}},{"barcode":{"code-type":"ITF","value":"1234567890","visible-value":1}},{"cell":{"name":"label","value":"Barcode (Code 39)","font-style":"bold","font-size":10,"border":"1","border-color":245,"background-color":245}},{"barcode":{"code-type":"CODE_39","value":"1234567890ABCDEF","visible-value":1}}],"hgap":3}},{"vgap":{"height":3}},{"row":{"columns":[{"cell":{"name":"label","value":"Datagrid Sample","align":"center","font-style":"bold","border":"1","border-color":245,"background-color":245}}]}},{"vgap":{"height":2}},{"datagrid":{"columns":[{"column":{"width":"8%","fieldname":"counter","align":"right","label":"labels.counter","footer":"labels.total"}},{"column":{"width":"20%","fieldname":"date","align":"center","label":"labels.center_text"}},{"column":{"width":"15%","fieldname":"number","align":"right","label":"labels.right_text","footer":"items_footer.items_total","footer-align":"right"}},{"column":{"fieldname":"text","label":"labels.left_text"}}],"name":"items","databind":"items","border":"1","border-color":218,"header-background":245,"footer-background":245}},{"vgap":{"height":5}},{"html":{"fieldname":"html_text","html":"<i>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</i> ={{html_text}} Nulla a pretium nunc, in cursus quam."}}],"footer":[{"vgap":{"height":2}},{"hline":{"border-color":218}},{"row":{"columns":[{"cell":{"value":"Nervatura Report Template","font-style":"bolditalic"}},{"cell":{"value":"{{page}}","align":"right","font-style":"bold"}}],"height":10}}],"sources":{},"data":{"labels":{"title":"REPORT TEMPLATE","left_text":"Short text","center_text":"Centered text","right_text":"Right text","long_text":"Long text","counter":"No.","total":"Total"},"head":{"short_text":"Lorem ipsum dolor","number":"123 456","date":"2014.01.01","long_text":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque eu mattis diam, sed dapibus justo. In eget augue nisi. Cras eget odio vel mi vulputate interdum. Curabitur consequat sapien at lacus tincidunt, at sagittis felis lobortis. Aenean porta maximus quam eu porta. Fusce sed leo ut justo commodo facilisis. Vivamus vitae tempor erat, at ultrices enim. Nulla a pretium nunc, in cursus quam."},"html_text":"<p><b>Pellentesque eu mattis diam, sed dapibus justo. In eget augue nisi. Cras eget odio vel mi vulputate interdum. Curabitur consequat sapien at lacus tincidunt, at sagittis felis lobortis. Aenean porta maximus quam eu porta. Fusce sed leo ut justo commodo facilisis. Vivamus vitae tempor erat, at ultrices enim.</b></p>","items":[{"text":"Lorem ipsum dolor1","number":"3","date":"2014.01.08"},{"text":"Lorem ipsum dolor2","number":"4","date":"2014.01.07"},{"text":"Lorem ipsum dolor3","number":"6","date":"2014.01.04"},{"text":"Lorem ipsum dolor4","number":"7","date":"2014.01.02"},{"text":"Lorem ipsum dolor5","number":"3","date":"2014.01.04"},{"text":"Lorem ipsum dolor6 Lorem ipsum dolor6 Lorem ipsum dolor6 Lorem ipsum dolor6 Lorem ipsum dolor6 Lorem ipsum dolor6","number":"4","date":"2014.01.01"},{"text":"Lorem ipsum dolor","number":"123 456","date":"2014.01.01"},{"text":"Lorem ipsum dolor","number":"123 456","date":"2014.01.01"},{"text":"Lorem ipsum dolor","number":"123 456","date":"2014.01.01"},{"text":"Lorem ipsum dolor","number":"123 456","date":"2014.01.01"},{"text":"Lorem ipsum dolor","number":"123 456","date":"2014.01.01"},{"text":"Lorem ipsum dolor","number":"123 456","date":"2014.01.01"},{"text":"Lorem ipsum dolor","number":"123 456","date":"2014.01.01"},{"text":"Lorem ipsum dolor","number":"123 456","date":"2014.01.01"},{"text":"Lorem ipsum dolor","number":"123 456","date":"2014.01.01"},{"text":"Lorem ipsum dolor","number":"123 456","date":"2014.01.01"},{"text":"Lorem ipsum dolor","number":"123 456","date":"2014.01.01"},{"text":"Lorem ipsum dolor","number":"123 456","date":"2014.01.01"},{"text":"Lorem ipsum dolor","number":"123 456","date":"2014.01.01"},{"text":"Lorem ipsum dolor","number":"123 456","date":"2014.01.01"},{"text":"Lorem ipsum dolor","number":"123 456","date":"2014.01.01"},{"text":"Lorem ipsum dolor","number":"123 456","date":"2014.01.01"},{"text":"Lorem ipsum dolor","number":"123 456","date":"2014.01.01"},{"text":"Lorem ipsum dolor","number":"123 456","date":"2014.01.01"},{"text":"Lorem ipsum dolor","number":"123 456","date":"2014.01.01"},{"text":"Lorem ipsum dolor","number":"123 456","date":"2014.01.01"},{"text":"Lorem ipsum dolor","number":"123 456","date":"2014.01.01"},{"text":"Lorem ipsum dolor","number":"123 456","date":"2014.01.01"},{"text":"Lorem ipsum dolor","number":"123 456","date":"2014.01.01"},{"text":"Lorem ipsum dolor","number":"123 456","date":"2014.01.01"}],"items_footer":{"items_total":"3 703 680"},"logo":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAYAAACpSkzOAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAFxGAABcRgEUlENBAAAAB3RJTUUH4AcCFiIAfaA8WwAAAeBJREFUSMftlj9IVlEUwH/nfR/+G3QwaPlAg3D5pKkPDIoIghYVm4yCFKlPcGoQdGppa4mm4IJbQdFYRKDgoFR0o5ZwcL5LLoKCoPW+43JfvO/6ns9P0ckDj8c5l3t+55x73rkPzqUFqdRrTe/Tho0CRGeQ2FWA8ilmcgH4CUyeGFSp13DGpvUOoB+YSwDALwBp0VF6jwAKXAbGgIfAYOBi1Rl7oxDknXf56IaBKtDhnzagvcBHzRn7IxOUZFGp12aAaeDKMSv7D+gBdpyxzSBfmnZgGbh2wn5Yc8ZWEyXKOI+lY0C2RGQ9sD1OK/9BvlyjwPUWIZsi8lFVB1K2DWfsl/REKAdle94i5LuIbKnq/cC+mAR/ICMvvUcliMgroFNVb2csT4WGcoGeJbsisqCq4zmBLThj90JjmNFeQbt+i0ReqOpMDiR2xj7KmtYh6E/WZhH5WoqiCWCooTp/SDC3wrPJ7Dr/9Sdn8L5UKt0T5JOqVuNG401BSaedsSt5d08ULFwENoBNVb0Zx/FbRUeA7gLIU2esCWdjU/P41h4HZv3d8Q74DTw7QmP8Baacsa8Pg6S7bBvoSw9BP0yfAJ05gM/AXSDOO5cDGeVdC972ALgDXAJ2gQ/O2Jfnf0RnJvumbKT0gnMTFgAAAABJRU5ErkJggg=="}}')}}]);