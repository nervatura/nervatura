(self.webpackChunknervatura_client=self.webpackChunknervatura_client||[]).push([[14],{5586:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return It}});var n=r(4942),a=r(2982),i=r(1413),s=r(885),l=r(7313),o=r(4754),c=r.n(o),u=r(7559),d=r(2361),p=r(4165),m=r(5861),f=r(5919),v=r(9004),_=r(3576),g=r(8502),x=r(982),y=r(6431),h=r.n(y),b=r(9206),k=r(5578),j=r(3421),w=r(7112),Z=r(4848),T=r(5468),N=r(4925),E=(r(2580),"Formula_modal__8CEPD"),$="Formula_dialog__7fDmm",q="Formula_panel__WIEk9",I="Formula_panelTitle__hm6vu",D="Formula_closeIcon__Q7rz8",C=r(8907),O=r(4721),S=r(6360),F=r(3331),P=r(5750),K=r(6417),R=["formula","formulaValues","partnumber","description","className","getText","onClose","onFormula"],L=function(e){var t=e.formula,r=e.formulaValues,n=e.partnumber,a=e.description,o=e.className,c=e.getText,u=e.onClose,d=e.onFormula,p=(0,N.Z)(e,R),m=(0,l.useState)({formula:t}),f=(0,s.Z)(m,2),v=f[0],_=f[1];return(0,K.jsx)("div",{className:"modal".concat(" ",E),children:(0,K.jsx)("div",(0,i.Z)((0,i.Z)({className:"dialog".concat(" ",$)},p),{},{children:(0,K.jsxs)("div",{className:"".concat(q," ").concat(o),children:[(0,K.jsx)("div",{className:"".concat(I," ","primary"),children:(0,K.jsxs)("div",{className:"row full",children:[(0,K.jsx)("div",{className:"cell",children:(0,K.jsx)(C.Z,{value:c("label_formula"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Magic"}),iconWidth:"20px"})}),(0,K.jsx)("div",{className:"cell align-right".concat(" ",D),children:(0,K.jsx)(P.Z,{id:"closeIcon",iconKey:"Times",onClick:u})})]})}),(0,K.jsxs)("div",{className:"row full container-small section-small",children:[(0,K.jsx)("div",{className:"row full",children:(0,K.jsxs)("div",{className:"cell padding-small",children:[(0,K.jsx)("div",{children:(0,K.jsx)(C.Z,{className:"bold",value:c("product_partnumber")})}),(0,K.jsx)(S.Z,{className:"full",value:n,disabled:"disabled"})]})}),(0,K.jsx)("div",{className:"row full",children:(0,K.jsx)("div",{className:"cell padding-small",children:(0,K.jsx)(S.Z,{className:"full",value:a,disabled:"disabled"})})}),(0,K.jsx)("div",{className:"row full",children:(0,K.jsx)("div",{className:"cell padding-small",children:(0,K.jsx)(F.Z,{id:"formula",className:"full",value:v.formula,placeholder:"",onChange:function(e){return _((0,i.Z)((0,i.Z)({},v),{},{formula:e}))},options:r})})})]}),(0,K.jsx)("div",{className:"row full section container-small secondary-title",children:(0,K.jsxs)("div",{className:"row full",children:[(0,K.jsx)("div",{className:"cell padding-small half",children:(0,K.jsx)(O.Z,{id:"btn_cancel",className:"full".concat(" ",D," "),disabled:""===v.formula?"disabled":"",onClick:function(){return u()},value:(0,K.jsx)(C.Z,{center:!0,value:c("msg_cancel"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Times"}),iconWidth:"20px"})})}),(0,K.jsx)("div",{className:"cell padding-small half",children:(0,K.jsx)(O.Z,{id:"btn_formula",className:"full primary",disabled:""===v.formula?"disabled":"",onClick:function(){return d(parseInt(v.formula,10))},value:(0,K.jsx)(C.Z,{center:!0,value:c("msg_ok"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Check"}),iconWidth:"20px"})})})]})})]})}))})};L.defaultProps={formula:"",formulaValues:[],partnumber:"",description:"",className:"",getText:void 0,onClose:void 0,onFormula:void 0};var A=L,W="Shipping_modal__TRC2h",M="Shipping_dialog__vOu01",U="Shipping_panel__uN5xj",z="Shipping_panelTitle__qxeY5",V="Shipping_closeIcon__SONGK",H=["partnumber","description","unit","batch_no","qty","className","getText","onClose","onShipping"],B=function(e){var t=e.partnumber,r=e.description,n=e.unit,a=e.batch_no,o=e.qty,c=e.className,u=e.getText,d=e.onClose,p=e.onShipping,m=(0,N.Z)(e,H),f=(0,l.useState)({batch_no:a,qty:o}),v=(0,s.Z)(f,2),_=v[0],g=v[1];return(0,K.jsx)("div",{className:"modal".concat(" ",W),children:(0,K.jsx)("div",(0,i.Z)((0,i.Z)({className:"dialog".concat(" ",M)},m),{},{children:(0,K.jsxs)("div",{className:"".concat(U," ").concat(c),children:[(0,K.jsx)("div",{className:"".concat(z," ","primary"),children:(0,K.jsxs)("div",{className:"row full",children:[(0,K.jsx)("div",{className:"cell",children:(0,K.jsx)(C.Z,{value:u("shipping_movement_product"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Truck"}),iconWidth:"20px"})}),(0,K.jsx)("div",{className:"cell align-right".concat(" ",V),children:(0,K.jsx)(P.Z,{id:"closeIcon",iconKey:"Times",onClick:d})})]})}),(0,K.jsxs)("div",{className:"row full container-small section-small",children:[(0,K.jsx)("div",{className:"row full",children:(0,K.jsxs)("div",{className:"cell padding-small",children:[(0,K.jsx)("div",{children:(0,K.jsx)(C.Z,{className:"bold",value:u("product_partnumber")})}),(0,K.jsx)(S.Z,{className:"full",value:t,disabled:"disabled"})]})}),(0,K.jsx)("div",{className:"row full",children:(0,K.jsxs)("div",{className:"cell padding-small",children:[(0,K.jsx)("div",{children:(0,K.jsx)(C.Z,{className:"bold",value:u("product_description")})}),(0,K.jsx)(S.Z,{className:"full",value:r,disabled:"disabled"})]})}),(0,K.jsx)("div",{className:"row full",children:(0,K.jsxs)("div",{className:"cell padding-small",children:[(0,K.jsx)("div",{children:(0,K.jsx)(C.Z,{className:"bold",value:u("product_unit")})}),(0,K.jsx)(S.Z,{className:"full",value:n,disabled:"disabled"})]})}),(0,K.jsx)("div",{className:"row full",children:(0,K.jsxs)("div",{className:"cell padding-small",children:[(0,K.jsx)("div",{children:(0,K.jsx)(C.Z,{className:"bold",value:u("movement_batchnumber")})}),(0,K.jsx)(S.Z,{id:"batch_no",className:"full",value:_.batch_no,autoFocus:!0,onChange:function(e){return g((0,i.Z)((0,i.Z)({},_),{},{batch_no:e}))}})]})}),(0,K.jsx)("div",{className:"row full",children:(0,K.jsxs)("div",{className:"cell padding-small",children:[(0,K.jsx)("div",{children:(0,K.jsx)(C.Z,{className:"bold",value:u("movement_qty")})}),(0,K.jsx)(S.Z,{id:"qty",className:"full align-right",value:_.qty,type:"number",onChange:function(e){return g((0,i.Z)((0,i.Z)({},_),{},{qty:e}))}})]})})]}),(0,K.jsx)("div",{className:"row full section container-small secondary-title",children:(0,K.jsxs)("div",{className:"row full",children:[(0,K.jsx)("div",{className:"cell padding-small half",children:(0,K.jsx)(O.Z,{id:"btn_cancel",className:"full".concat(" ",V," "),onClick:function(){return d()},value:(0,K.jsx)(C.Z,{center:!0,value:u("msg_cancel"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Times"}),iconWidth:"20px"})})}),(0,K.jsx)("div",{className:"cell padding-small half",children:(0,K.jsx)(O.Z,{id:"btn_ok",className:"full primary",onClick:function(){return p(_.batch_no,parseFloat(_.qty))},value:(0,K.jsx)(C.Z,{center:!0,value:u("msg_ok"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Check"}),iconWidth:"20px"})})})]})})]})}))})};B.defaultProps={partnumber:"",description:"",unit:"",batch_no:"",qty:0,className:"",getText:void 0,onClose:void 0,onShipping:void 0};var Q=B,G="Stock_modal__UXfV+",X="Stock_dialog__1-OdF",Y="Stock_panel__hE8yK",J="Stock_panelTitle__CDq7X",ee="Stock_closeIcon__VWhpa",te=r(1012),re=["partnumber","partname","rows","selectorPage","className","onClose","getText"],ne=function(e){var t=e.partnumber,r=e.partname,n=e.rows,a=e.selectorPage,s=e.className,l=e.onClose,o=e.getText,c=(0,N.Z)(e,re),u={warehouse:{fieldtype:"string",label:o("delivery_place")},batch_no:{fieldtype:"string",label:o("movement_batchnumber")},description:{fieldtype:"string",label:o("product_description")},sqty:{fieldtype:"number",label:o("shipping_stock")}};return(0,K.jsx)("div",{className:"modal".concat(" ",G),children:(0,K.jsx)("div",(0,i.Z)((0,i.Z)({className:"dialog".concat(" ",X)},c),{},{children:(0,K.jsxs)("div",{className:"".concat(Y," ").concat(s),children:[(0,K.jsx)("div",{className:"".concat(J," ","primary"),children:(0,K.jsxs)("div",{className:"row full",children:[(0,K.jsx)("div",{className:"cell",children:(0,K.jsx)(C.Z,{value:o("shipping_stocks"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Book"}),iconWidth:"20px"})}),(0,K.jsx)("div",{className:"cell align-right".concat(" ",ee),children:(0,K.jsx)(P.Z,{id:"closeIcon",iconKey:"Times",onClick:l})})]})}),(0,K.jsxs)("div",{className:"row full container-small section-small",children:[(0,K.jsx)("div",{className:"row full",children:(0,K.jsxs)("div",{className:"cell padding-small",children:[(0,K.jsx)("div",{children:(0,K.jsx)(C.Z,{className:"bold",value:t})}),(0,K.jsx)("div",{children:(0,K.jsx)(C.Z,{value:r})})]})}),(0,K.jsx)("div",{className:"row full",children:(0,K.jsx)(te.Z,{rowKey:"id",fields:u,rows:n,tableFilter:!0,filterPlaceholder:o("placeholder_filter"),paginationPage:a,paginationTop:!0,hidePaginatonSize:!0})})]}),(0,K.jsx)("div",{className:"row full section container-small secondary-title",children:(0,K.jsx)("div",{className:"row full",children:(0,K.jsx)("div",{className:"cell padding-small",children:(0,K.jsx)(O.Z,{id:"btn_ok",className:"full primary",onClick:l,value:(0,K.jsx)(C.Z,{center:!0,value:o("msg_ok"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Check"}),iconWidth:"20px"})})})})})]})}))})};ne.defaultProps={partnumber:"",partname:"",rows:[],selectorPage:(0,Z.$8)("selectorPage"),className:"",getText:void 0,onClose:void 0};var ae=ne,ie="Trans_modal__D2W4t",se="Trans_dialog__g0ar9",le="Trans_panel__DfIoU",oe="Trans_panelTitle__azpBO",ce="Trans_closeIcon__LO6gj",ue="Trans_editCol__NnVKG",de=["baseTranstype","transtype","direction","doctypes","directions","refno","nettoDiv","netto","fromDiv","from","elementCount","className","getText","onClose","onCreate"],pe=function(e){var t=e.baseTranstype,r=e.transtype,n=e.direction,a=e.doctypes,o=e.directions,c=e.refno,u=e.nettoDiv,d=e.netto,p=e.fromDiv,m=e.from,f=e.elementCount,v=e.className,_=e.getText,g=e.onClose,x=e.onCreate,y=(0,N.Z)(e,de),h=(0,l.useState)({transtype:r,direction:n,refno:c,netto:d,from:m,nettoDiv:u,fromDiv:p}),b=(0,s.Z)(h,2),k=b[0],j=b[1],w=a.map((function(e){return{value:e,text:e}})),Z=o.map((function(e){return{value:e,text:e}}));return(0,K.jsx)("div",{className:"modal".concat(" ",ie),children:(0,K.jsx)("div",(0,i.Z)((0,i.Z)({className:"dialog".concat(" ",se)},y),{},{children:(0,K.jsxs)("div",{className:"".concat(le," ").concat(v),children:[(0,K.jsx)("div",{className:"".concat(oe," ","primary"),children:(0,K.jsxs)("div",{className:"row full",children:[(0,K.jsx)("div",{className:"cell",children:(0,K.jsx)(C.Z,{value:_("msg_create_title"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"FileText"}),iconWidth:"20px"})}),(0,K.jsx)("div",{className:"cell align-right".concat(" ",ce),children:(0,K.jsx)(P.Z,{id:"closeIcon",iconKey:"Times",onClick:g})})]})}),(0,K.jsxs)("div",{className:"row full container-small section-small",children:[(0,K.jsx)("div",{className:"row full",children:(0,K.jsx)("div",{className:"cell padding-small",children:(0,K.jsx)("div",{children:(0,K.jsx)(C.Z,{className:"bold",value:_("msg_create_new")})})})}),(0,K.jsxs)("div",{className:"row full",children:[(0,K.jsx)("div",{className:"cell half padding-small",children:(0,K.jsx)(F.Z,{id:"transtype",className:"full",value:k.transtype,onChange:function(e){return function(e){var r=k.nettoDiv,n=k.fromDiv;["invoice","receipt"].includes(e)&&["order","rent","worksheet"].includes(t)?(r=!0,0===f&&(n=!0)):(r=!1,n=!1),j((0,i.Z)((0,i.Z)({},k),{},{transtype:e,nettoDiv:r,fromDiv:n}))}(e)},options:w})}),(0,K.jsx)("div",{className:"cell half padding-small",children:(0,K.jsx)(F.Z,{id:"direction",className:"full",value:k.direction,onChange:function(e){return j((0,i.Z)((0,i.Z)({},k),{},{direction:e}))},options:Z})})]}),(0,K.jsx)("div",{className:"row full",children:(0,K.jsx)("div",{className:"cell padding-small",children:(0,K.jsx)("div",{id:"refno",className:"padding-small".concat(" ",ue),onClick:function(){return j((0,i.Z)((0,i.Z)({},k),{},{refno:!k.refno}))},children:(0,K.jsx)(C.Z,{className:"bold",value:_("msg_create_setref"),leftIcon:(0,K.jsx)(P.Z,{iconKey:k.refno?"CheckSquare":"SquareEmpty"})})})})}),k.nettoDiv?(0,K.jsx)("div",{className:"row full",children:(0,K.jsx)("div",{className:"cell padding-small",children:(0,K.jsx)("div",{id:"netto",className:"padding-small".concat(" ",ue),onClick:function(){return j((0,i.Z)((0,i.Z)({},k),{},{netto:!k.netto}))},children:(0,K.jsx)(C.Z,{className:"bold",value:_("msg_create_deduction"),leftIcon:(0,K.jsx)(P.Z,{iconKey:k.netto?"CheckSquare":"SquareEmpty"})})})})}):null,k.fromDiv?(0,K.jsx)("div",{className:"row full",children:(0,K.jsx)("div",{className:"cell padding-small",children:(0,K.jsx)("div",{id:"from",className:"padding-small".concat(" ",ue),onClick:function(){return j((0,i.Z)((0,i.Z)({},k),{},{from:!k.from}))},children:(0,K.jsx)(C.Z,{className:"bold",value:_("msg_create_delivery"),leftIcon:(0,K.jsx)(P.Z,{iconKey:k.from?"CheckSquare":"SquareEmpty"})})})})}):null]}),(0,K.jsx)("div",{className:"row full section container-small secondary-title",children:(0,K.jsxs)("div",{className:"row full",children:[(0,K.jsx)("div",{className:"cell padding-small half",children:(0,K.jsx)(O.Z,{id:"btn_cancel",className:"full".concat(" ",ce," "),onClick:function(){return g()},value:(0,K.jsx)(C.Z,{center:!0,value:_("msg_cancel"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Times"}),iconWidth:"20px"})})}),(0,K.jsx)("div",{className:"cell padding-small half",children:(0,K.jsx)(O.Z,{id:"btn_create",className:"full primary",onClick:function(){return x({newTranstype:k.transtype,newDirection:k.direction,refno:k.refno,fromInventory:k.from&&k.fromDiv,nettoQty:k.netto&&k.nettoDiv})},value:(0,K.jsx)(C.Z,{center:!0,value:_("msg_ok"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Check"}),iconWidth:"20px"})})})]})})]})}))})};pe.defaultProps={baseTranstype:"",transtype:"",direction:"",doctypes:[],directions:[],refno:!0,nettoDiv:!1,netto:!0,fromDiv:!1,from:!1,elementCount:0,className:"",getText:void 0,onClose:void 0,onCreate:void 0};var me=pe,fe="Report_modal__6GcDQ",ve="Report_dialog__MxkX+",_e="Report_panel__iq5sB",ge="Report_panelTitle__jiznV",xe="Report_closeIcon__Mk-HR",ye="Report_copyInput__w9Inc",he=["title","template","templates","orient","size","copy","className","getText","onClose","onOutput"],be=function(e){var t=e.title,r=e.template,n=e.templates,a=e.orient,o=e.size,c=e.copy,u=e.className,d=e.getText,p=e.onClose,m=e.onOutput,f=(0,N.Z)(e,he),v=(0,l.useState)({template:r,orient:a,size:o,copy:c}),_=(0,s.Z)(v,2),g=_[0],x=_[1],y=function(e){m({type:e,template:g.template,title:t,orient:g.orient,size:g.size,copy:g.copy})},h=Z.h.ui.report_orientation.map((function(e){return{value:e[0],text:d(e[1])}})),b=Z.h.ui.report_size.map((function(e){return{value:e[0],text:e[1]}}));return(0,K.jsx)("div",{className:"modal".concat(" ",fe),children:(0,K.jsx)("div",(0,i.Z)((0,i.Z)({className:"dialog".concat(" ",ve)},f),{},{children:(0,K.jsxs)("div",{className:"".concat(_e," ").concat(u),children:[(0,K.jsx)("div",{className:"".concat(ge," ","primary"),children:(0,K.jsxs)("div",{className:"row full",children:[(0,K.jsx)("div",{className:"cell",children:(0,K.jsx)(C.Z,{value:t,leftIcon:(0,K.jsx)(P.Z,{iconKey:"ChartBar"}),iconWidth:"20px"})}),(0,K.jsx)("div",{className:"cell align-right".concat(" ",xe),children:(0,K.jsx)(P.Z,{id:"closeIcon",iconKey:"Times",onClick:p})})]})}),(0,K.jsxs)("div",{className:"row full container-small section-small",children:[(0,K.jsx)("div",{className:"row full",children:(0,K.jsxs)("div",{className:"cell padding-small",children:[(0,K.jsx)("div",{children:(0,K.jsx)(C.Z,{className:"bold",text:"msg_template"})}),(0,K.jsx)(F.Z,{id:"template",className:"full",value:g.template,onChange:function(e){return x((0,i.Z)((0,i.Z)({},g),{},{template:e}))},options:n})]})}),(0,K.jsx)("div",{className:"row full",children:(0,K.jsxs)("div",{className:"cell padding-small",children:[(0,K.jsx)("div",{children:(0,K.jsx)(C.Z,{className:"bold",text:"msg_report_prop"})}),(0,K.jsx)(F.Z,{id:"orient",value:g.orient,onChange:function(e){return x((0,i.Z)((0,i.Z)({},g),{},{orient:e}))},options:h}),(0,K.jsx)(F.Z,{id:"size",value:g.size,onChange:function(e){return x((0,i.Z)((0,i.Z)({},g),{},{size:e}))},options:b}),(0,K.jsx)(S.Z,{id:"copy",className:"".concat(ye),type:"integer",value:g.copy,onChange:function(e){return x((0,i.Z)((0,i.Z)({},g),{},{copy:e}))}})]})})]}),(0,K.jsxs)("div",{className:"row full section container-small secondary-title",children:[(0,K.jsxs)("div",{className:"row full",children:[(0,K.jsx)("div",{className:"cell padding-small half",children:(0,K.jsx)(O.Z,{id:"btn_print",className:"full primary",disabled:""===r?"disabled":"",onClick:function(){return y("print")},label:d("msg_print")})}),(0,K.jsx)("div",{className:"cell padding-small half",children:(0,K.jsx)(O.Z,{id:"btn_pdf",className:"full primary",disabled:""===r?"disabled":"",onClick:function(){return y("pdf")},label:d("msg_export_pdf")})})]}),(0,K.jsxs)("div",{className:"row full",children:[(0,K.jsx)("div",{className:"cell padding-small half",children:(0,K.jsx)(O.Z,{id:"btn_xml",className:"full primary",disabled:""===r?"disabled":"",onClick:function(){return y("xml")},label:d("msg_export_xml")})}),(0,K.jsx)("div",{className:"cell padding-small half",children:(0,K.jsx)(O.Z,{id:"btn_printqueue",className:"full primary",disabled:""===r?"disabled":"",onClick:function(){return y("printqueue")},label:d("msg_printqueue")})})]})]})]})}))})};be.defaultProps={title:"",template:"",templates:[],orient:"portrait",size:"a4",copy:1,className:"",getText:void 0,onClose:void 0,onOutput:void 0};var ke=be,je="Edit_sidebar__O3fIh",we="Edit_selectButton__T5CP+",Ze="Edit_groupButton__5MlaL",Te="Edit_itemButton__hd2wQ",Ne="Edit_panelGroup__OZKBo",Ee="Edit_panelButton__K3xnB",$e="Edit_selected__vocq+",qe="Edit_separator__LiEts",Ie="Edit_stateLabel__7cBdj",De=["side","newFilter","auditFilter","view","module","forms","className","getText","onEvent"],Ce="edit",Oe=function(e){var t=e.side,r=e.newFilter,n=e.auditFilter,s=e.view,l=e.module,o=e.forms,c=e.className,u=e.getText,d=e.onEvent,p=(0,N.Z)(e,De),m=l.current,f=l.form_dirty,v=l.dirty,_=l.panel,g=l.dataset,x=l.group_key,y=function(e,t,r,n,i){return(0,K.jsx)(O.Z,{id:e,className:t,disabled:i?"disabled":"",onClick:function(){return d.apply(void 0,(0,a.Z)(r))},value:n},e)},h=function(e,t,r,n){return(0,K.jsx)(O.Z,{id:e,className:t,onClick:function(){return d("changeData",["group_key",r])},value:n},e)},b=function(e){return e===x?we:Ze};return(0,K.jsxs)("div",(0,i.Z)((0,i.Z)({},p),{},{className:"".concat(je," ").concat("auto"!==t?t:""," ").concat(c),children:[m.form||"transitem_shipping"===m.form_type?null:(0,K.jsxs)("div",{className:"row full section-small container",children:[(0,K.jsx)("div",{className:"cell half",children:y("state_new","full medium".concat(" ",s===Ce&&m.item?Ze:we),["changeData",["side_view","new"]],(0,K.jsx)(C.Z,{value:u("label_new"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Plus"}),iconWidth:"20px"}))}),(0,K.jsx)("div",{className:"cell half",children:y("state_edit","full medium".concat(" ",s===Ce&&m.item?we:Ze),["changeData",["side_view","edit"]],(0,K.jsx)(C.Z,{value:u("label_edit"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Edit"}),iconWidth:"20px"}),!m.item)})]}),s===Ce&&m.form||s===Ce&&m.item?function(e){"undefined"===typeof e&&(e={});var t=[];if((!0===e.back||m.form)&&(t.push(y("cmd_back","medium".concat(" ",Te," ").concat($e),["editorBack"],(0,K.jsx)(C.Z,{value:u("label_back"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Reply"}),iconWidth:"20px"}))),t.push((0,K.jsx)("div",{className:qe},"back_sep"))),!0===e.arrow&&(t.push(y("cmd_arrow_left","full medium".concat(" ",Te),["prevTransNumber"],(0,K.jsx)(C.Z,{value:u("label_previous"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"ArrowLeft"}),iconWidth:"20px"}))),t.push(y("cmd_arrow_right","full medium".concat(" ",Te),["nextTransNumber"],(0,K.jsx)(C.Z,{value:u("label_next"),rightIcon:(0,K.jsx)(P.Z,{iconKey:"ArrowRight"}),iconWidth:"20px"}))),t.push((0,K.jsx)("div",{className:qe},"arrow_sep"))),e.state&&"normal"!==e.state){var r="deleted"===e.state?"red":"cancellation"===e.state?"orange":"white",n=["closed","readonly"].includes(e.state)?"Lock":"ExclamationTriangle";t.push((0,K.jsx)("div",{className:"full padding-small large".concat(" ",Ie),children:(0,K.jsx)(C.Z,{value:u("label_"+e.state),style:{color:r},leftIcon:(0,K.jsx)(P.Z,{iconKey:n,color:r}),iconWidth:"25px"})},"cmd_state")),t.push((0,K.jsx)("div",{className:qe},"state_sep"))}return!1!==e.save&&t.push(y("cmd_save","full medium".concat(" ",Te," ").concat(m.form&&f||!m.form&&v?$e:""),["editorSave"],(0,K.jsx)(C.Z,{value:u("label_save"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Check"}),iconWidth:"20px"}))),!1!==e.delete&&"normal"===e.state&&t.push(y("cmd_delete","full medium".concat(" ",Te),["editorDelete"],(0,K.jsx)(C.Z,{value:u("label_delete"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Times"}),iconWidth:"20px"}))),!1===e.new||"normal"!==e.state||m.form||t.push(y("cmd_new","full medium".concat(" ",Te),["editorNew",[{}]],(0,K.jsx)(C.Z,{value:u("label_new"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Plus"}),iconWidth:"20px"}))),!0===e.trans&&(t.push((0,K.jsx)("div",{className:qe},"trans_sep")),!1!==e.copy&&t.push(y("cmd_copy","full medium".concat(" ",Te),["transCopy",["normal"]],(0,K.jsx)(C.Z,{value:u("label_copy"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Copy"}),iconWidth:"20px"}))),!1!==e.create&&t.push(y("cmd_create","full medium".concat(" ",Te),["transCopy",["create"]],(0,K.jsx)(C.Z,{value:u("label_create"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Sitemap"}),iconWidth:"20px"}))),!0===e.corrective&&"normal"===e.state&&t.push(y("cmd_corrective","full medium".concat(" ",Te),["transCopy",["amendment"]],(0,K.jsx)(C.Z,{value:u("label_corrective"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Share"}),iconWidth:"20px"}))),!0===e.cancellation&&"cancellation"!==e.state&&t.push(y("cmd_cancellation","full medium".concat(" ",Te),["transCopy",["cancellation"]],(0,K.jsx)(C.Z,{value:u("label_cancellation"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Undo"}),iconWidth:"20px"}))),!0===e.formula&&t.push(y("cmd_formula","full medium".concat(" ",Te),["checkEditor",[{},"LOAD_FORMULA"]],(0,K.jsx)(C.Z,{value:u("label_formula"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Magic"}),iconWidth:"20px"})))),!0===e.link&&t.push(y("cmd_link","full medium".concat(" ",Te),["setLink",[e.link_type,e.link_field]],(0,K.jsx)(C.Z,{value:e.link_label,leftIcon:(0,K.jsx)(P.Z,{iconKey:"Link"}),iconWidth:"20px"}))),!0===e.password&&t.push(y("cmd_password","full medium".concat(" ",Te),["setPassword"],(0,K.jsx)(C.Z,{value:u("title_password"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Lock"}),iconWidth:"20px"}))),!0===e.shipping&&(t.push(y("cmd_shipping_all","full medium".concat(" ",Te),["shippingAddAll"],(0,K.jsx)(C.Z,{value:u("shipping_all_label"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Plus"}),iconWidth:"20px"}))),t.push(y("cmd_shipping_create","full medium".concat(" ",Te," ").concat(g.shiptemp.length>0?$e:""),["createShipping"],(0,K.jsx)(C.Z,{value:u("shipping_create_label"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Check"}),iconWidth:"20px"})))),!0===e.more&&(t.push((0,K.jsx)("div",{className:qe},"more_sep_1")),!1!==e.report&&t.push(y("cmd_report","full medium".concat(" ",Te),["reportSettings",[]],(0,K.jsx)(C.Z,{value:u("label_report"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"ChartBar"}),iconWidth:"20px"}))),!0===e.search&&t.push(y("cmd_search","full medium".concat(" ",Te),["searchQueue"],(0,K.jsx)(C.Z,{value:u("label_search"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Search"}),iconWidth:"20px"}))),!0===e.export_all&&"normal"===e.state&&t.push(y("cmd_export_all","full medium".concat(" ",Te),["exportQueueAll"],(0,K.jsx)(C.Z,{value:u("label_export_all"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Download"}),iconWidth:"20px"}))),!0===e.print&&t.push(y("cmd_print","full medium".concat(" ",Te),["createReport",["print"]],(0,K.jsx)(C.Z,{value:u("label_print"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Print"}),iconWidth:"20px"}))),!0===e.export_pdf&&"normal"===e.state&&t.push(y("cmd_export_pdf","full medium".concat(" ",Te),["createReport",["pdf"]],(0,K.jsx)(C.Z,{value:u("label_export_pdf"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Download"}),iconWidth:"20px"}))),!0===e.export_xml&&"normal"===e.state&&t.push(y("cmd_export_xml","full medium".concat(" ",Te),["createReport",["xml"]],(0,K.jsx)(C.Z,{value:u("label_export_xml"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Code"}),iconWidth:"20px"}))),!0===e.export_csv&&"normal"===e.state&&t.push(y("cmd_export_csv","full medium".concat(" ",Te),["createReport",["csv"]],(0,K.jsx)(C.Z,{value:u("label_export_csv"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Download"}),iconWidth:"20px"}))),!0===e.export_event&&"normal"===e.state&&t.push(y("cmd_export_event","full medium".concat(" ",Te),["exportEvent"],(0,K.jsx)(C.Z,{value:u("label_export_event"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Calendar"}),iconWidth:"20px"}))),t.push((0,K.jsx)("div",{className:qe},"more_sep_2")),!1!==e.bookmark&&"normal"===e.state&&t.push(y("cmd_bookmark","full medium".concat(" ",Te),["saveBookmark",[e.bookmark]],(0,K.jsx)(C.Z,{value:u("label_bookmark"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Star"}),iconWidth:"20px"}))),!1!==e.help&&t.push(y("cmd_help","full medium".concat(" ",Te),["showHelp",[e.help]],(0,K.jsx)(C.Z,{value:u("label_help"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"QuestionCircle"}),iconWidth:"20px"})))),!0!==e.more&&"undefined"!==typeof e.help&&(t.push((0,K.jsx)("div",{className:qe},"help_sep")),t.push(y("cmd_help","full medium".concat(" ",Te),["showHelp",[e.help]],(0,K.jsx)(C.Z,{value:u("label_help"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"QuestionCircle"}),iconWidth:"20px"})))),t}(_):function(){var e=[];return r[0].length>0&&e.push((0,K.jsxs)("div",{className:"row full",children:[h("new_transitem_group","full medium".concat(" ",b("new_transitem")),"new_transitem",(0,K.jsx)(C.Z,{value:u("search_transitem"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"FileText"}),iconWidth:"25px"})),"new_transitem"===x?(0,K.jsx)("div",{className:"row full".concat(" ",Ne),children:r[0].map((function(e){return"all"===n.trans[e][0]?y(e,"full medium primary".concat(" ",Ee),["editorNew",[{ntype:"trans",ttype:e}]],(0,K.jsx)(C.Z,{value:u("title_"+e),leftIcon:(0,K.jsx)(P.Z,{iconKey:"FileText"}),iconWidth:"25px"})):null}))}):null]},"0")),r[1].length>0&&e.push((0,K.jsxs)("div",{className:"row full",children:[h("new_transpayment_group","full medium".concat(" ",b("new_transpayment")),"new_transpayment",(0,K.jsx)(C.Z,{value:u("search_transpayment"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Money"}),iconWidth:"25px"})),"new_transpayment"===x?(0,K.jsx)("div",{className:"row full".concat(" ",Ne),children:r[1].map((function(e){return"all"===n.trans[e][0]?y(e,"full medium primary".concat(" ",Ee),["editorNew",[{ntype:"trans",ttype:e}]],(0,K.jsx)(C.Z,{value:u("title_"+e),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Money"}),iconWidth:"25px"})):null}))}):null]},"1")),r[2].length>0&&e.push((0,K.jsxs)("div",{className:"row full",children:[h("new_transmovement_group","full medium".concat(" ",b("new_transmovement")),"new_transmovement",(0,K.jsx)(C.Z,{value:u("search_transmovement"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Truck"}),iconWidth:"25px"})),"new_transmovement"===x?(0,K.jsx)("div",{className:"row full".concat(" ",Ne),children:r[2].map((function(e){return"all"===n.trans[e][0]?"delivery"===e?[y("shipping","full medium primary".concat(" ",Ee),["editorNew",[{ntype:"trans",ttype:"shipping"}]],(0,K.jsx)(C.Z,{value:u("title_"+e),leftIcon:(0,K.jsx)(P.Z,{iconKey:o[e]().options.icon}),iconWidth:"25px"})),y(e,"full medium primary".concat(" ",Ee),["editorNew",[{ntype:"trans",ttype:e}]],(0,K.jsx)(C.Z,{value:u("title_transfer"),leftIcon:(0,K.jsx)(P.Z,{iconKey:o[e]().options.icon}),iconWidth:"25px"}))]:y(e,"full medium primary".concat(" ",Ee),["editorNew",[{ntype:"trans",ttype:e}]],(0,K.jsx)(C.Z,{value:u("title_"+e),leftIcon:(0,K.jsx)(P.Z,{iconKey:o[e]().options.icon}),iconWidth:"25px"})):null}))}):null]},"2")),r[3].length>0&&e.push((0,K.jsxs)("div",{className:"row full",children:[h("new_resources_group","full medium".concat(" ",b("new_resources")),"new_resources",(0,K.jsx)(C.Z,{value:u("title_resources"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Wrench"}),iconWidth:"25px"})),"new_resources"===x?(0,K.jsx)("div",{className:"row full".concat(" ",Ne),children:r[3].map((function(e){return"all"===n[e][0]?y(e,"full medium primary".concat(" ",Ee),["editorNew",[{ntype:e,ttype:null}]],(0,K.jsx)(C.Z,{value:u("title_"+e),leftIcon:(0,K.jsx)(P.Z,{iconKey:o[e]().options.icon}),iconWidth:"25px"})):null}))}):null]},"3")),e}()]}))};Oe.defaultProps={side:"auto",view:Ce,module:{current:{},form_dirty:!1,dirty:!1,panel:{},dataset:{},group_key:""},newFilter:[],auditFilter:{},forms:{},className:"",onEvent:void 0,getText:void 0};var Se=Oe,Fe="Main_formPanel__OieND",Pe=r(8025),Ke=["current","template","dataset","audit","className","getText","onEvent"],Re=function(e){var t=e.current,r=e.template,n=e.dataset,a=e.audit,s=e.className,l=e.getText,o=e.onEvent,c=(0,N.Z)(e,Ke),u=function(e){return o("editItem",[e])},d=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o("onSelector",[].concat(t))};return(0,K.jsxs)("div",(0,i.Z)((0,i.Z)({},c),{},{className:"".concat(Fe," ","border"," ").concat(s),children:[r.rows.map((function(e,i){return(0,K.jsx)(Pe.Z,{row:e,values:t.item,options:r.options,data:{audit:a,current:t,dataset:n},getText:l,onEdit:u,onEvent:o,onSelector:d},i)})),"report"===t.type&&t.fieldvalue.length>0?(0,K.jsx)("div",{className:"row full",children:t.fieldvalue.map((function(e,i){return(0,K.jsx)(Pe.Z,{row:e,values:e,options:r.options,data:{audit:a,current:t,dataset:n},getText:l,onEdit:u,onEvent:o,onSelector:d},i)}))}):null]}))};Re.defaultProps={current:{},template:{},dataset:{},audit:"",className:"",onEvent:void 0,getText:void 0};var Le=Re,Ae=r(5110),We="Meta_formPanel__gRu7M",Me="Meta_addButton__w+8Te",Ue="Meta_paginatorCell__XYjR-",ze=r(3443),Ve=["current","dataset","audit","className","paginationPage","getText","onEvent"],He=function(e){var t=e.current,r=e.dataset,n=e.audit,s=e.className,o=e.paginationPage,u=e.getText,d=e.onEvent,p=(0,N.Z)(e,Ve),m=function(e){return d("editItem",[e])},f=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return d("onSelector",[].concat(t))},v=(0,l.useMemo)((function(){return[{accessor:"list"}]}),[]),_=(0,l.useMemo)((function(){var e=[];return t.fieldvalue.forEach((function(t){var n=r.deffield.filter((function(e){return e.fieldname===t.fieldname}))[0];if(1===n.visible&&0===t.deleted){var a=r.groups.filter((function(e){return e.id===n.fieldtype}))[0].groupvalue,i=t.value,s=a;if(["customer","tool","trans","transitem","transmovement","transpayment","product","project","employee","place"].includes(a)){var l=r.deffield_prop.filter((function(e){return e.ftype===a&&e.id===parseInt(t.value,10)}))[0];l&&(i=l.description),s="selector"}"urlink"===a&&(s="text"),"valuelist"===a&&(i=n.valuelist.split("|")),e=c()(e,{$push:[{rowtype:"fieldvalue",id:t.id,name:"fieldvalue_value",fieldname:t.fieldname,value:t.value,notes:t.notes||"",label:n.description,description:i,disabled:!!n.readonly,fieldtype:a,datatype:s}]})}})),e}),[t.fieldvalue,r.deffield,r.deffield_prop,r.groups]),g=(0,Ae.useTable)({columns:v,data:_,initialState:{pageIndex:t.page,pageSize:o}},Ae.usePagination),x=g.prepareRow,y=g.page,h=g.canPreviousPage,b=g.canNextPage,k=g.pageCount,j=g.gotoPage,w=g.nextPage,Z=g.previousPage,T=g.setPageSize,E=g.state,$=E.pageIndex,q=E.pageSize;return(0,K.jsxs)("div",(0,i.Z)((0,i.Z)({},p),{},{className:"".concat(We," ","border"," ").concat(s),children:["readonly"!==n||k>1?(0,K.jsxs)("div",{className:"row full container-small section-small border-bottom",children:["readonly"!==n?(0,K.jsxs)("div",{className:"cell mobile",children:[(0,K.jsx)("div",{className:"cell padding-small",children:(0,K.jsx)(F.Z,{id:"sel_deffield",value:t.deffield||"",onChange:function(e){return d("changeCurrentData",["deffield",e])},placeholder:"",options:function(){var e=r.groups.filter((function(e){return"nervatype"===e.groupname&&e.groupvalue===t.type}))[0].id;return"trans"===t.type?r.deffield.filter((function(t){return t.nervatype===e&&1===t.visible})).filter((function(e){return e.subtype===t.item.transtype||null===e.subtype})).map((function(e){return{value:e.fieldname,text:e.description}})):r.deffield.filter((function(t){return t.nervatype===e&&1===t.visible})).map((function(e){return{value:e.fieldname,text:e.description}}))}()})}),t.deffield&&""!==t.deffield?(0,K.jsx)("div",{className:"cell",children:(0,K.jsx)(O.Z,{id:"btn_new",className:"border-button".concat(" ",Me),onClick:function(){return d("checkEditor",[{fieldname:t.deffield},"NEW_FIELDVALUE"])},value:(0,K.jsx)(C.Z,{value:u("label_new"),leftIcon:(0,K.jsx)(P.Z,{iconKey:"Plus"}),iconWidth:"20px"})})}):null]}):null,k>1?(0,K.jsx)("div",{className:" ".concat(Ue," ","cell right mobile"),children:(0,K.jsx)(ze.Z,{pageIndex:$,pageSize:q,pageCount:k,canPreviousPage:h,canNextPage:b,onEvent:function(e,t){var r={gotoPage:j,nextPage:w,previousPage:Z,setPageSize:T};r[e].apply(r,(0,a.Z)(t)),"setPageSize"!==e&&d("changeCurrentData",["page",t[0]])}})}):null]}):null,y.map((function(e,a){return x(e),(0,K.jsx)(Pe.Z,{row:e.original,values:e.original,options:{},data:{audit:n,current:t,dataset:r},getText:u,onEdit:m,onEvent:d,onSelector:f},e.original.id)}))]}))};He.defaultProps={current:{},dataset:{},audit:"",className:"",paginationPage:(0,Z.$8)("selectorPage"),onEvent:void 0,getText:void 0};var Be=He,Qe=r(9572),Ge="Note_rtfEditor__89BG0",Xe="Note_barButton__OJnaq",Ye="Note_activeStyle__hes4i",Je="Note_actionbar__9jvPF",et="Note_formPanel__JzYEL",tt=["value","patternId","patterns","readOnly","lastUpdate","className","getText","onEvent"],rt=null,nt=function(e){var t=e.value,r=e.patternId,n=e.patterns,a=e.readOnly,s=e.lastUpdate,o=e.className,c=e.getText,u=e.onEvent,d=(0,N.Z)(e,tt),p=(0,l.useCallback)((function(e){if(e&&!rt){var r=(0,Qe.init)({element:e,onChange:function(e){u("editItem",[{name:"fnote",value:e}])},actions:["bold","italic"],classes:{actionbar:"border-bottom ".concat(Je),button:"border-button ".concat(Xe),content:"pell-content",selected:Ye}});r.content.innerHTML=t,rt=r}}),[]);return(0,l.useEffect)((function(){rt&&rt.content.innerHTML!==t&&(rt.content.innerHTML=t)}),[s]),(0,l.useEffect)((function(){return function(){rt=null}})),(0,K.jsxs)("div",(0,i.Z)((0,i.Z)({},d),{},{className:"".concat(et," ","border"," ").concat(o),children:[a?null:(0,K.jsx)("div",{children:(0,K.jsx)("div",{className:"row full",children:(0,K.jsxs)("div",{className:"cell padding-small",children:[(0,K.jsxs)("div",{className:"cell padding-tiny",children:[(0,K.jsx)(O.Z,{id:"btn_pattern_default",className:"border-button".concat(" ",Xe),title:c("pattern_default"),onClick:function(){return u("setPattern",[{key:"default"}])},value:(0,K.jsx)(P.Z,{iconKey:"Home"})}),(0,K.jsx)(O.Z,{id:"btn_pattern_load",className:"border-button".concat(" ",Xe),title:c("pattern_load"),onClick:function(){return u("setPattern",[{key:"load"}])},value:(0,K.jsx)(P.Z,{iconKey:"Download"})}),(0,K.jsx)(O.Z,{id:"btn_pattern_save",className:"border-button".concat(" ",Xe),title:c("pattern_save"),onClick:function(){return u("setPattern",[{key:"save"}])},value:(0,K.jsx)(P.Z,{iconKey:"Upload"})})]}),(0,K.jsxs)("div",{className:"cell padding-tiny",children:[(0,K.jsx)(O.Z,{id:"btn_pattern_new",className:"border-button".concat(" ",Xe),title:c("pattern_new"),onClick:function(){return u("setPattern",[{key:"new"}])},value:(0,K.jsx)(P.Z,{iconKey:"Plus"})}),(0,K.jsx)(O.Z,{id:"btn_pattern_delete",className:"border-button".concat(" ",Xe),title:c("pattern_delete"),onClick:function(){return u("setPattern",[{key:"delete"}])},value:(0,K.jsx)(P.Z,{iconKey:"Times"})})]}),(0,K.jsx)("div",{className:"cell padding-tiny mobile",children:(0,K.jsx)(F.Z,{id:"sel_pattern",value:r?String(r):"",placeholder:"",onChange:function(e){return u("changeCurrentData",["template",e])},options:n.map((function(e){return{value:String(e.id),text:e.description+(1===e.defpattern?"*":"")}}))})})]})})}),(0,K.jsx)("div",{className:"".concat(Ge," ","rtf"),children:a?(0,K.jsx)("div",{className:"pell-content",dangerouslySetInnerHTML:{__html:t}}):(0,K.jsx)("div",{id:"editor",className:"pell",ref:p})})]}))};nt.defaultProps={value:"",patternId:void 0,patterns:[],className:"",readOnly:!1,lastUpdate:void 0,onEvent:void 0,getText:void 0};var at=nt,it="Item_formPanel__tKRq+",st="Item_itemTitle__RSC4t",lt="Item_itemTitlePre__8+EYQ",ot=["current","dataset","audit","className","getText","onEvent"],ct=function(e){var t=e.current,r=e.dataset,n=e.audit,a=e.className,s=e.getText,l=e.onEvent,o=(0,N.Z)(e,ot),c=function(e){return l("editItem",[e])},u=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return l("onSelector",[].concat(t))};return(0,K.jsxs)("div",(0,i.Z)((0,i.Z)({},o),{},{className:"".concat(a),children:[(0,K.jsx)("div",{className:"row full",children:(0,K.jsxs)("div",{className:"cell padding-normal border secondary-title".concat(" ",st),children:[(0,K.jsx)(C.Z,{className:" ".concat(lt),value:null===t.form.id?s("label_new"):String(t.form.id)}),(0,K.jsx)(C.Z,{value:t.form_template.options.title})]})}),(0,K.jsx)("div",{className:"".concat(it," ","border"),children:t.form_template.rows.map((function(e,a){return(0,K.jsx)(Pe.Z,{row:e,values:t.form,options:t.form_template.options,data:{audit:n,current:t,dataset:r},getText:s,onEdit:c,onEvent:l,onSelector:u},a)}))})]}))};ct.defaultProps={current:{},dataset:{},audit:"",className:"",onEvent:void 0,getText:void 0};var ut=ct,dt="View_viewPanel__thcfJ",pt="View_editCol__Xrvia",mt="View_deleteCol__Ta7wv",ft="View_totalLabel__xClc7",vt="View_totalValue__VWSG7",_t=r(4867),gt=["viewName","current","template","dataset","audit","className","paginationPage","dateFormat","timeFormat","getText","onEvent"],xt=function(e){var t=e.viewName,r=e.current,n=e.template,a=e.dataset,s=e.audit,o=e.className,u=e.paginationPage,d=e.dateFormat,p=e.timeFormat,m=e.getText,f=e.onEvent,v=(0,N.Z)(e,gt),_=n.view[t],g=a[_.data]||[],x="undefined"===typeof _.edited||_.edited,y=_.actions;"undefined"===typeof y&&(y={new:{action:"newEditorItem",fkey:t},edit:{action:"editEditorItem",fkey:t},delete:{action:"deleteEditorItem",fkey:t}}),"all"!==s&&(y=c()(y,{$merge:{new:null,delete:null}}));var h="undefined"!==typeof _.edit_icon?[_.edit_icon,void 0,void 0]:["Edit",24,21.3],b="undefined"!==typeof _.delete_icon?[_.delete_icon,void 0,void 0]:["Times",19,27.6],k="undefined"!==typeof _.new_icon?_.new_icon:"Plus",j="undefined"!==typeof _.new_label?_.new_label:m("label_new"),w={};return"table"===_.type&&(x&&(y.edit||y.delete)&&(w=c()(w,{$merge:{edit:{columnDef:{id:"edit",Header:"",headerStyle:{},Cell:function(e){var t=e.row,r=(e.value,null!==y.edit?(0,K.jsx)("div",{className:"cell".concat(" ",pt),children:(0,K.jsx)(P.Z,{id:"edit_"+t.original.id,iconKey:h[0],width:h[1],height:h[2],onClick:function(){return f("setFormActions",[{params:y.edit,row:t.original}])},className:pt})}):null),n=null!==y.delete?(0,K.jsx)("div",{className:"cell".concat(" ",mt),children:(0,K.jsx)(P.Z,{id:"delete_"+t.original.id,iconKey:b[0],width:b[1],height:b[2],onClick:function(){return f("setFormActions",[{params:y.delete,row:t.original}])},className:mt})}):null;return(0,K.jsxs)(l.Fragment,{children:[r,n]})},cellStyle:{width:30,padding:"7px 3px 3px 8px"}}}}})),w=c()(w,{$merge:(0,i.Z)({},_.fields)})),(0,K.jsxs)("div",(0,i.Z)((0,i.Z)({},v),{},{className:"".concat(dt," ").concat(o),children:[_.total?(0,K.jsxs)("div",{className:"row full border",children:[(0,K.jsxs)("div",{className:"cell l4 m4 s12 padding-normal align-right",children:[(0,K.jsx)("span",{className:"".concat(ft),children:_.total[Object.keys(_.total)[0]]+":"}),(0,K.jsx)("span",{className:"".concat(vt," ","border"," "),children:(0,Z.uf)(a[r.type][0][Object.keys(_.total)[0]],a[r.type][0].digit)})]}),(0,K.jsxs)("div",{className:"cell l4 m4 s12 padding-normal align-right",children:[(0,K.jsx)("span",{className:"".concat(ft),children:_.total[Object.keys(_.total)[1]]+":"}),(0,K.jsx)("span",{className:"".concat(vt," ","border"),children:(0,Z.uf)(a[r.type][0][Object.keys(_.total)[1]],a[r.type][0].digit)})]}),(0,K.jsxs)("div",{className:"cell l4 m4 s12 padding-normal align-right",children:[(0,K.jsx)("span",{className:"".concat(ft),children:_.total[Object.keys(_.total)[2]]+":"}),(0,K.jsx)("span",{className:"".concat(vt," ","border"),children:(0,Z.uf)(a[r.type][0][Object.keys(_.total)[2]],a[r.type][0].digit)})]})]}):null,(0,K.jsx)("div",{className:"row full",children:"table"===_.type?(0,K.jsx)(te.Z,{rowKey:"id",onAddItem:x&&y.new?function(){return f("setFormActions",[{params:y.new}])}:void 0,fields:w,rows:g,tableFilter:!0,filterPlaceholder:m("placeholder_filter"),labelYes:m("label_yes"),labelNo:m("label_no"),labelAdd:j,addIcon:(0,K.jsx)(P.Z,{iconKey:k}),dateFormat:d,timeFormat:p,paginationPage:u,paginationTop:!0}):(0,K.jsx)(_t.Z,{rows:g,labelAdd:j,addIcon:(0,K.jsx)(P.Z,{iconKey:k}),editIcon:(0,K.jsx)(P.Z,{iconKey:h[0],width:h[1],height:h[2]}),deleteIcon:(0,K.jsx)(P.Z,{iconKey:b[0],width:b[1],height:b[2]}),listFilter:!0,filterPlaceholder:m("placeholder_filter"),paginationPage:u,paginationTop:!0,onEdit:x&&y.edit?function(e){return f("setFormActions",[{params:y.edit,row:e}])}:void 0,onAddItem:x&&y.new?function(){return f("setFormActions",[{params:y.new}])}:void 0,onDelete:x&&y.delete?function(e){return f("setFormActions",[{params:y.delete,row:e}])}:void 0})})]}))};xt.defaultProps={viewName:"",current:{},template:{},dataset:{},audit:"",paginationPage:(0,Z.$8)("paginationPage"),dateFormat:(0,Z.$8)("dateFormat"),timeFormat:(0,Z.$8)("timeFormat"),className:"",onEvent:void 0,getText:void 0};var yt=xt,ht="Editor_panel__WgAZq",bt="Editor_panelTitle__WWjgP",kt="Editor_tabButton__zRXD8",jt="Editor_badge__amB1+",wt="Editor_width800__KdnJA",Zt=["caption","current","template","dataset","audit","lastUpdate","className","getText","onEvent"],Tt=function(e){var t=e.caption,r=e.current,n=e.template,a=e.dataset,s=e.audit,o=e.lastUpdate,c=e.className,u=e.getText,d=e.onEvent,p=(0,N.Z)(e,Zt),m=function(e,t,n,a){return(0,K.jsx)("div",{className:"row full",children:(0,K.jsx)("div",{className:"cell",children:(0,K.jsx)(O.Z,{id:"btn_"+e,className:" ".concat(kt," ","full secondary-title"),onClick:function(){return d("changeCurrentData",["view",r.view===e?"":e])},value:(0,K.jsxs)("div",{className:"row full",children:[(0,K.jsx)("div",{className:"cell",children:(0,K.jsx)(C.Z,{value:u(t),leftIcon:(0,K.jsx)(P.Z,{iconKey:n}),iconWidth:"20px"})}),"undefined"!==typeof a?(0,K.jsx)("div",{className:"cell align-right",children:(0,K.jsx)("span",{className:"".concat(jt),children:a})}):null]})},e)})})};return(0,K.jsx)("div",(0,i.Z)((0,i.Z)({},p),{},{className:"".concat(wt," ").concat(c),children:(0,K.jsxs)("div",{className:"".concat(ht),children:[(0,K.jsx)("div",{className:"".concat(bt," ","primary"),children:(0,K.jsx)(C.Z,{value:t,leftIcon:(0,K.jsx)(P.Z,{iconKey:n.options.icon}),iconWidth:"20px"})}),r.form?(0,K.jsx)("div",{className:"section container",children:(0,K.jsx)(ut,{current:r,dataset:a,audit:s,onEvent:d,getText:u})}):(0,K.jsxs)("div",{className:"section container",children:[(0,K.jsxs)(l.Fragment,{children:[m("form",function(){var e=r.item[n.options.title_field];return"printqueue"===r.type?e=n.options.title_field:null===r.item.id&&(e=u("label_new")+" "+n.options.title),e}(),n.options.icon),"form"===r.view?(0,K.jsx)(Le,{current:r,template:n,dataset:a,audit:s,onEvent:d,getText:u}):null]}),null===r.item.id&&!n.options.search_form||"undefined"===typeof a.fieldvalue||null===r.item||!0!==n.options.fieldvalue?null:(0,K.jsxs)(l.Fragment,{children:[m("fieldvalue","fields_view",n.options.icon,r.fieldvalue.filter((function(e){return 1===a.deffield.filter((function(t){return t.fieldname===e.fieldname}))[0].visible&&0===e.deleted})).length),"fieldvalue"===r.view?(0,K.jsx)(Be,{current:r,dataset:a,audit:s,onEvent:d,getText:u}):null]}),null!==r.item.id&&"undefined"!==typeof r.item.fnote&&!0===n.options.pattern?(0,K.jsxs)(l.Fragment,{children:[m("fnote","fnote_view","Comment"),"fnote"===r.view?(0,K.jsx)(at,{value:r.item.fnote,lastUpdate:o,patternId:r.template,patterns:a.pattern,readOnly:"readonly"===s,onEvent:d,getText:u}):null]}):null,Object.keys(n.view).filter((function(e){return"disabled"!==n.view[e].view_audit})).map((function(e){return(0,K.jsxs)(l.Fragment,{children:[m(e,n.view[e].title,n.view[e].icon,a[n.view[e].data].length),r.view===e?(0,K.jsx)(yt,{viewName:e,current:r,template:n,dataset:a,audit:s,onEvent:d,getText:u}):null]},e)}))]})]})}))};Tt.defaultProps={caption:"",current:{},template:{},dataset:{},audit:"",lastUpdate:void 0,className:"",onEvent:void 0,getText:void 0};var Nt=Tt,Et=function(e){var t=e.data,r=e.current,n=e.login,a=e.forms,i=e.onEvent,s=e.getText;return(0,K.jsxs)(l.Fragment,{children:[(0,K.jsx)(Se,{side:r.side,view:t.side_view,module:t,forms:a,newFilter:n.edit_new,auditFilter:n.audit_filter,onEvent:i,getText:s}),t.current.item?(0,K.jsx)("div",{className:"page padding-normal".concat(" ",r.theme),children:(0,K.jsx)(Nt,{caption:t.caption,current:t.current,template:t.template,dataset:t.dataset,audit:t.audit,lastUpdate:t.lastUpdate,onEvent:i,getText:s})}):null]})};Et.defaultProps={data:{caption:Nt.defaultProps.caption,current:Nt.defaultProps.current,template:Nt.defaultProps.template,dataset:Nt.defaultProps.dataset,audit:Nt.defaultProps.audit},current:{},login:{},forms:{},onEvent:void 0,getText:void 0};var $t=(0,l.memo)(Et,(function(e,t){return e.data===t.data&&e.current.side===t.current.side})),qt=function(e){var t=(0,l.useContext)(u.ZP),r=t.data,o=t.setData,y=(0,d.xZ)(r,o),N=function(e,t){var r=(0,d.xZ)(e,t),a=(0,w.o)(e,t),s=(0,w.c)(e,t),l=(0,j.E)({getText:r.getText}),o=(0,k.i)({getText:r.getText}),u=function(e,t){if(e=parseFloat(e),!isNaN(e)){t||(t=0);var r=Math.pow(10,t);return Math.floor(e*r+(e*r*10%10>=5?1:0))/r}return e},y=function(t){var r=new URLSearchParams;return r.append("reportkey",t.template),r.append("orientation",t.orient),r.append("size",t.size),r.append("output",t.type),t.filters?"/report?".concat(r.toString(),"&").concat(t.filters):(r.append("nervatype",t.nervatype||e.edit.current.type),"/report?".concat(r.toString(),"&filters[@id]=").concat(t.id||e.edit.current.item.id))},N=function(){var t=(0,m.Z)((0,p.Z)().mark((function t(n,a){var i,s,l,o,c;return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.edit.dataset.report.filter((function(e){return e.reportkey===n}))[0],s=e.login.data.groups.filter((function(t){return"nervatype"===t.groupname&&t.groupvalue===e.edit.current.type}))[0],l={nervatype:s.id,ref_id:e.edit.current.item.id,qty:parseInt(a),employee_id:e.login.data.employee.id,report_id:i.id},o={method:"POST",data:[l]},t.next=6,r.requestData("/ui_printqueue",o);case 6:if(!(c=t.sent).error){t.next=9;break}return t.abrupt("return",r.resultError(c));case 9:r.showToast({type:"success",autoClose:!0,title:r.getText("msg_successful"),message:r.getText("report_add_groups")});case 10:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),E=function(){var e=(0,m.Z)((0,p.Z)().mark((function e(t){var n,a,i;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("printqueue"!==t.type){e.next=2;break}return e.abrupt("return",N(t.template,t.copy));case 2:return e.next=4,r.requestData(y(t),{});case 4:if(!(n=e.sent)||!n.error){e.next=8;break}return r.resultError(n),e.abrupt("return",!1);case 8:return a=URL.createObjectURL(n,{type:"xml"===t.type?"application/xml; charset=UTF-8":"application/pdf"}),"print"===t.type?h()({printable:a,type:"pdf",base64:!1}):(i=(i=t.title+"_"+(0,f.Z)(new Date,{representation:"date"})+"."+t.type).split("/").join("_"),(0,d.GX)(a,i)),e.abrupt("return",!0);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(){var n=(0,m.Z)((0,p.Z)().mark((function n(){var a,i,s;return(0,p.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=c()(e.edit,{}),i={method:"POST",data:[{key:"items",text:(0,d.aT)(e.login.data.engine,o.printqueue.items(a.printqueue)).sql,values:[]}]},n.next=4,r.requestData("/view",i);case 4:if(!(s=n.sent).error){n.next=7;break}return n.abrupt("return",r.resultError(s));case 7:a=c()(a,{dataset:{$merge:{items:s.items}}}),t("edit",a);case 9:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),q=function(){var t=(0,m.Z)((0,p.Z)().mark((function t(n){var a,i,s,l,o,c,u;return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=[],e.edit.current.fieldvalue.forEach((function(e){e.selected&&a.push("filters[".concat(e.name,"]=").concat(e.value))})),i=e.edit.current.item,s={type:"xml"===n?"xml":"auto",ctype:"xml"===n?"application/xml; charset=UTF-8":"csv"===n?"text/csv; charset=UTF-8":"application/pdf",template:i.reportkey,title:i.reportkey,orient:i.orientation,size:i.size,filters:a.join("&")},t.next=6,r.requestData(y(s),{});case 6:if(!(l=t.sent)||!l.error){t.next=9;break}return t.abrupt("return",r.resultError(l));case 9:if("csv"===n?(c=new Blob([l],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(c),n="csv"):o=URL.createObjectURL(l,{type:s.ctype}),"print"!==n){t.next=14;break}h()({printable:o,type:"pdf",base64:!1}),t.next=17;break;case 14:return u=(u=s.title+"_"+(0,f.Z)(new Date,{representation:"date"})+"."+n).split("/").join("_"),t.abrupt("return",(0,d.GX)(o,u));case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),I=function(s,l,o){var u=c()({},{$set:o||e.edit});if("undefined"===typeof u.dataset[u.current.type]||0===u.dataset[u.current.type].length)return r.showToast({type:"error",autoClose:!1,title:r.getText("msg_warning"),message:r.getText("msg_editor_invalid")}),!1;if("disabled"===(u=c()(u,{$merge:{template:l,panel:l.options.panel,caption:l.options.title,audit:r.getAuditFilter(u.current.type,u.current.transtype)[0],side_view:"edit"}})).audit)return!1;if(null===u.dataset[u.current.type][0].id?(u=c()(u,{current:{$merge:{item:u.dataset[u.current.type][0]}}}),l.options.search_form?u=c()(u,{$merge:{title_field:l.options.title_field}}):("all"!==u.audit&&"update"!==u.audit||(u=c()(u,{$merge:{dirty:!0}})),u=c()(u,{$merge:{title_field:r.getText("label_new")+" "+l.options.title}})),"undefined"!==typeof l.options.extend&&(u=c()(u,{current:{$merge:{extend:a({tablename:l.options.extend,dataset:u.dataset,current:u.current})}}}))):(u=c()(u,{current:{$merge:{item:c()(a({tablename:u.current.type,dataset:u.dataset,current:u.current}),{$merge:u.dataset[u.current.type][0]})}}}),"undefined"!==typeof l.options.extend&&"undefined"!==typeof(u=c()(u,{current:{$merge:{extend:a({tablename:l.options.extend,dataset:u.dataset,current:u.current})}}})).dataset[l.options.extend]&&u.dataset[l.options.extend].length>0&&(u=c()(u,{current:{$merge:{extend:c()(u.current.extend,{$merge:u.dataset[l.options.extend][0]})}}}))),"trans"===(u=c()(u,{current:{$merge:{state:"normal",page:0}}})).current.type&&("undefined"!==typeof u.dataset.trans[0].transcast&&"cancellation"===u.dataset.trans[0].transcast&&(u=c()(u,{current:{$merge:{state:"cancellation"}}})),u.dataset.pattern)){var d=u.dataset.pattern.filter((function(e){return 1===e.defpattern}))[0];u=c()(u,{current:{$merge:{template:d?d.id:""}}})}if("normal"===u.current.state&&1===u.current.item.deleted?u=c()(u,{current:{$merge:{state:"deleted"}}}):1===u.current.item.closed&&(u=c()(u,{current:{$merge:{state:"closed"}}})),u=c()(u,{current:{$merge:{fieldvalue:u.dataset.fieldvalue||[]}}}),Object.keys(u.template.view).forEach((function(e){u=c()(u,{template:{view:(0,n.Z)({},e,{$merge:{view_audit:"all"}})}}),u="setting"===e?c()(u,{template:{view:(0,n.Z)({},e,{$merge:{view_audit:"disabled"}})}}):c()(u,{template:{view:(0,n.Z)({},e,{$merge:{view_audit:r.getAuditFilter(l.view[e].audit_type||e,l.view[e].audit_transtype||null)[0]}})}})})),"report"===u.current.type){var p={fields:{}};try{p=JSON.parse(u.dataset.report[0].report)}catch(m){return t("current",{module:"search"}),r.resultError({error:{message:m.message}})}Object.keys(p.fields).forEach((function(e,t){var r=p.fields[e],n=r.selected?r.selected:"in"===r.wheretype,a=c()({},{$set:{id:t+1,rowtype:"reportfield",datatype:r.fieldtype,name:e,label:r.description,selected:n,empty:"in"===r.wheretype?"false":"true",value:r.value}});switch(r.fieldtype){case"bool":a=c()(a,{$merge:{value:0}});break;case"valuelist":a=c()(a,{$merge:{description:"in"!==r.wheretype?r.valuelist.split("|").unshift(""):r.valuelist.split("|")}});break;case"date":"undefined"===typeof a.value&&(a=r.defvalue?c()(a,{$merge:{value:(0,f.Z)((0,v.Z)(new Date,parseInt(r.defvalue,10)),{representation:"date"})}}):"in"===r.wheretype?c()(a,{$merge:{value:(0,f.Z)(new Date,{representation:"date"})}}):c()(a,{$merge:{value:""}}));break;case"integer":case"float":"undefined"===typeof a.value&&(a=c()(a,{$merge:{value:r.defvalue&&""!==r.defvalue?r.defvalue:0}}));break;default:a=c()(a,{$merge:{datatype:"string"}})}"undefined"===typeof a.value&&(a=c()(a,{$merge:{value:r.defvalue?r.defvalue:""}})),u=c()(u,{current:{fieldvalue:{$push:[a]}}})}))}s.shipping&&("undefined"===typeof(u=c()(u,{current:{$merge:{form_type:"transitem_shipping",direction:u.dataset.groups.filter((function(e){return e.id===u.current.item.direction}))[0].groupvalue}}})).dataset.shiptemp&&(u=c()(u,{dataset:{$merge:{shiptemp:[]}}})),(u=c()(u,{current:{item:{$merge:{delivery_type:r.getText("delivery_"+u.current.direction)}}}})).current.shippingdate?u=c()(u,{current:{item:{$merge:{shippingdate:u.current.shippingdate}}}}):(u=c()(u,{current:{$merge:{shippingdate:(0,f.Z)(new Date,{representation:"date"})+"T00:00:00"}}}),u=c()(u,{current:{item:{$merge:{shippingdate:(0,f.Z)(new Date,{representation:"date"})+"T00:00:00"}}}})),u.current.shipping_place_id?u=c()(u,{current:{item:{$merge:{shipping_place_id:u.current.shipping_place_id}}}}):(u=c()(u,{current:{$merge:{shipping_place_id:null}}}),u=c()(u,{current:{item:{$merge:{shipping_place_id:null}}}})),(u=c()(u,{dataset:{$merge:{shipping_items_:[]}}})).dataset.shipping_items.forEach((function(e,t){var r=c()(e,{$merge:{id:t+1,qty:parseFloat(e.qty)}}),n=u.dataset.transitem_shipping.filter((function(e){return e.id===r.item_id+"-"+r.product_id}))[0];if("undefined"!==typeof n){var a="out"===u.current.direction?-parseFloat(n.sqty):parseFloat(n.sqty);r=c()(r,{$merge:{tqty:a,diff:parseFloat(r.qty)-a}})}else r=c()(r,{$merge:{qty:parseFloat(r.qty),tqty:0,diff:parseFloat(r.qty)}});var i=u.dataset.shiptemp.filter((function(e){return e.id===r.item_id+"-"+r.product_id}))[0];"undefined"!==typeof i&&(r=c()(r,{$merge:{edited:!0}})),u=c()(u,{dataset:{shipping_items_:{$push:[r]}}})}))),"printqueue"===u.current.type&&(u="undefined"===typeof u.printqueue?c()(u,{$merge:{printqueue:u.current.item}}):c()(u,{current:{item:{$merge:(0,i.Z)({},u.printqueue)}}})),"normal"!==(u=c()(u,{panel:{$merge:{form:!0,state:u.current.state}}})).panel.state&&(u=c()(u,{$merge:{audit:"readonly"}})),"readonly"===u.audit&&"deleted"!==(u=c()(u,{panel:{$merge:{save:!1,link:!1,delete:!1,new:!1,pattern:!1,password:!1,formula:!1}}})).panel.state&&(u=c()(u,{panel:{$merge:{trans:!1}}})),"all"!==u.audit&&"deleted"!==(u=c()(u,{panel:{$merge:{delete:!1,new:!1}}})).panel.state&&(u=c()(u,{panel:{$merge:{trans:!1}}})),"deleted"===u.panel.state&&(u=c()(u,{panel:{$merge:{copy:!1,create:!1}}})),u=c()(u,{current:{$merge:{view:s.form||"form"}}}),t("edit",u),t("current",{module:"edit",side:"hide"})},D=function(){var i=(0,m.Z)((0,p.Z)().mark((function i(s){var u,m,f,v,_,g,x,y;return(0,p.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return u=s.ntype,m=s.ttype,f=s.id,v=c()({},{$set:{dataset:{},current:{type:u,transtype:m},dirty:!1,form_dirty:!1}}),null===f&&(_=a({tablename:u,transtype:m,dataset:v.dataset,current:v.current})),g=[],b.Z[u](m).forEach((function(t){var r={};"table"===t.infoType?(r={select:["*"],from:t.classAlias},t.where&&(r.where=t.where),t.order&&(r.order_by=t.order)):r="undefined"!==typeof o[u][t.sqlKey]?o[u][t.sqlKey](u):"undefined"!==typeof o[u][t.infoName]?o[u][t.infoName](u):o.all[t.infoName](u);var a=(0,d.aT)(e.login.data.engine,r);null!==f||0===a.prmCount?g=c()(g,{$push:[{key:t.infoName,text:a.sql,values:a.prmCount>0&&null!==f?Array(a.prmCount).fill(f):[]}]}):v=c()(v,{dataset:{$merge:(0,n.Z)({},t.infoName,[])}})})),"report"!==u&&b.Z.report().forEach((function(t){var r={key:t.infoName,sql:o.report[t.infoName](u),values:[]};"printqueue"!==u&&(r.values.push(e.login.data.employee.usergroup),r.values.push(v.current.type)),"trans"===v.current.type&&(r.sql.where.push(["and","r.transtype","=",[[],{select:["id"],from:"groups",where:[["groupname","=","'transtype'"],["and","groupvalue","=","?"]]}]]),r.values.push(v.current.transtype)),g=c()(g,{$push:[{key:r.key,text:(0,d.aT)(e.login.data.engine,r.sql).sql,values:r.values}]})})),x={method:"POST",data:g},i.next=10,r.requestData("/view",x);case 10:if(!(y=i.sent).error){i.next=13;break}return i.abrupt("return",r.resultError(y));case 13:v=c()(v,{dataset:{$merge:y}}),null===f&&(null===_&&(_=a({tablename:u,transtype:m,dataset:v.dataset,current:v.current})),"delivery"===m&&(_=c()(_,{$merge:{direction:v.dataset.groups.filter((function(e){return"direction"===e.groupname&&"transfer"===e.groupvalue}))[0].id}})),v=c()(v,{dataset:{$merge:(0,n.Z)({},u,[_])}})),t("edit",v,(function(){if(!s.cb_key||"SET_EDITOR"===s.cb_key)return"trans"===u?s.shipping?I(s,l.shipping(v.dataset[u][0],v,(0,Z.$8)("ui")),v):I(s,l[m](v.dataset[u][0],v,(0,Z.$8)("ui")),v):I(s,l[u](v.dataset[u][0],v,(0,Z.$8)("ui")),v)}));case 16:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}(),C=function(r){var i=c()(e.edit,{}),s=l[r.fkey](void 0,i,(0,Z.$8)("ui")).options.data;switch("undefined"===typeof s&&(s=r.fkey),i=c()(i,{$merge:{form_dirty:!1}}),i=c()(i,{current:{$merge:{form_type:r.fkey,form_datatype:s}}}),i=c()(i,{current:{$merge:{form:a({tablename:s,dataset:i.dataset,current:i.current})}}}),i=null!==r.id?c()(i,{current:{$merge:{form:i.dataset[r.fkey].filter((function(e){return e.id===parseInt(r.id,10)}))[0]}}}):c()(i,{current:{$merge:{form_dirty:!0}}}),i=c()(i,{current:{$merge:{form_template:l[r.fkey](i.current.form,i,(0,Z.$8)("ui"))}}}),r.fkey){case"price":case"discount":i=c()(i,{current:{$merge:{price_link_customer:null,price_customer_id:null}}}),null!==r.id&&(i=c()(i,{current:{$merge:{price_link_customer:i.current.form.link_customer,price_customer_id:i.current.form.customer_id}}}));break;case"invoice_link":var o={id:(i=c()(i,{current:{$merge:{invoice_link_fieldvalue:i.dataset.invoice_link_fieldvalue}}})).current.form.id,ref_id_1:"",transnumber:"",curr:""},u=i.dataset.invoice_link.filter((function(e){return e.id===i.current.form.id}))[0];"undefined"!==typeof u&&(o=u),i=c()(i,{current:{$merge:{invoice_link:[o]}}});break;case"payment_link":var d={id:(i=c()(i,{current:{$merge:{payment_link_fieldvalue:i.dataset.payment_link_fieldvalue}}})).current.form.id,ref_id_2:"",transnumber:"",curr:""},p=i.dataset.payment_link.filter((function(e){return e.id===i.current.form.id}))[0];"undefined"!==typeof p&&(d=p),i=c()(i,{current:{$merge:{payment_link:[d]}}}),r.link_field&&(i=c()(i,{current:{form:{$merge:(0,n.Z)({},r.link_field,r.link_id)}}}))}var m=c()(i.current.form_template.options.panel,{$merge:{form:!0,state:i.current.state}});"normal"!==i.panel.state&&(i=c()(i,{$merge:{audit:"readonly"}})),"readonly"===i.audit&&(m=c()(m,{$merge:{save:!1}})),"all"!==i.audit&&(m=c()(m,{$merge:{link:!1,delete:!1,new:!1}})),i=c()(i,{$merge:{panel:m}}),t("edit",i)},O=function(t){var n=function(){var t=(0,m.Z)((0,p.Z)().mark((function t(n){var a,i;return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={method:"POST",data:[n]},t.next=3,r.requestData("/fieldvalue",a);case 3:if(!(i=t.sent).error){t.next=6;break}return t.abrupt("return",r.resultError(i));case 6:D({ntype:e.edit.current.type,ttype:e.edit.current.transtype,id:e.edit.current.item.id,form:"fieldvalue",form_id:i[0]});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();if(""===t)return r.showToast({type:"error",title:r.getText("msg_warning"),message:r.getText("fields_deffield_missing")});var i=e.edit.dataset.deffield.filter((function(e){return e.fieldname===t}))[0],s=e.login.data.groups.filter((function(e){return e.id===i.fieldtype}))[0].groupvalue,l=c()(a({tablename:"fieldvalue"}),{$merge:{id:null,fieldname:i.fieldname}}),o=!1;switch(s){case"bool":l=c()(l,{$merge:{value:"false"}});break;case"date":l=c()(l,{$merge:{value:(0,f.Z)(new Date,{representation:"date"})}});break;case"time":l=c()(l,{$merge:{value:"00:00"}});break;case"float":case"integer":l=c()(l,{$merge:{value:"0"}});break;case"valuelist":l=c()(l,{$merge:{value:i.valuelist.split("|")[0]}})}["customer","tool","trans","transitem","transmovement","transpayment","product","project","employee","place"].includes(s)&&(o=!0),o?r.onSelector(s,"",(function(e,t){var r=e.id.split("/");l=c()(l,{$merge:{value:String(parseInt(r[2],10))}}),n(l)})):n(l)},S=function(){var n=function(){t("edit",{dataset:{},current:{},dirty:!1,form_dirty:!1}),t("current",{module:"search"})},a=function(){var t=(0,m.Z)((0,p.Z)().mark((function t(){var a;return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.requestData("/"+e.edit.current.type,{method:"DELETE",query:{id:e.edit.current.item.id}});case 2:if(!(a=t.sent)||!a.error){t.next=5;break}return t.abrupt("return",r.resultError(a));case 5:return t.next=7,r.createHistory("delete");case 7:n();case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t("current",{modalForm:(0,K.jsx)(T.default,{title:r.getText("msg_warning"),message:r.getText("msg_delete_text"),infoText:r.getText("msg_delete_info"),labelOK:r.getText("msg_ok"),labelCancel:r.getText("msg_cancel"),onCancel:function(){t("current",{modalForm:null})},onOK:function(i){t("current",{modalForm:null},(0,m.Z)((0,p.Z)().mark((function t(){var i,s,l;return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==e.edit.current.item.id){t.next=4;break}n(),t.next=16;break;case 4:if("undefined"===typeof o[e.edit.current.type].delete_state){t.next=15;break}return i=(0,d.aT)(e.login.data.engine,o[e.edit.current.type].delete_state()),s={method:"POST",data:[{key:"state",text:i.sql,values:Array(i.prmCount).fill(e.edit.current.item.id)}]},t.next=9,r.requestData("/view",s);case 9:if(!(l=t.sent).error){t.next=12;break}return t.abrupt("return",r.resultError(l));case 12:l.state[0].sco>0?r.showToast({type:"error",title:r.getText("msg_warning"),message:r.getText("msg_integrity_err")}):a(),t.next=16;break;case 15:a();case 16:case"end":return t.stop()}}),t)}))))}}),side:"hide"})},F=function(n){var a=function(){D({ntype:e.edit.current.type,ttype:e.edit.current.transtype,id:e.edit.current.item.id,form:n.fkey})},i=function(){var e=(0,m.Z)((0,p.Z)().mark((function e(){var t,i;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==n.id){e.next=4;break}a(),e.next=13;break;case 4:return t=n.table?n.table:n.fkey,e.next=7,r.requestData("/"+t,{method:"DELETE",query:{id:n.id}});case 7:if(!(i=e.sent)||!i.error){e.next=10;break}return e.abrupt("return",r.resultError(i));case 10:return e.next=12,r.createHistory("save");case 12:a();case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();n.prompt?i():t("current",{modalForm:(0,K.jsx)(T.default,{title:r.getText("msg_warning"),message:r.getText("msg_delete_text"),infoText:r.getText("msg_delete_info"),labelOK:r.getText("msg_ok"),labelCancel:r.getText("msg_cancel"),onCancel:function(){t("current",{modalForm:null})},onOK:function(e){t("current",{modalForm:null},(function(){i()}))}}),side:"hide"})},P=function(t,r,i,s,l){var o=t.findIndex((function(e){return e.ref_id===i&&e.fieldname===r}));if(-1===o){var u=c()(a({tablename:"fieldvalue",current:e.edit.current}),{$merge:{fieldname:r,ref_id:i,value:"undefined"===typeof l||null===l?s:l}});t=c()(t,{$push:[u]})}else l&&(t=c()(t,(0,n.Z)({},o,{$merge:{value:l}})));return t},R=function(t,r){var n={},i=a({tablename:t,dataset:e.edit.dataset,current:e.edit.current});for(var s in r)i.hasOwnProperty(s)&&(n[s]=r[s]);return n},L=function(){var t=(0,m.Z)((0,p.Z)().mark((function t(){var i,l,o,u,d,m,f,v,_,g,x,y;return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=c()(e.edit,{}),l=R(i.current.form_datatype,i.current.form),t.next=4,s(i.current.form_datatype,l);case 4:if(!(l=t.sent).error){t.next=8;break}return r.resultError(l),t.abrupt("return",null);case 8:return t.next=10,r.requestData("/"+i.current.form_datatype,{method:"POST",data:[l]});case 10:if(!(o=t.sent).error){t.next=14;break}return r.resultError(o),t.abrupt("return",null);case 14:return null===i.current.form.id&&(i=c()(i,{current:{form:{$merge:{id:o[0]}}}})),i=c()(i,{$merge:{form_dirty:!1}}),t.next=18,r.createHistory("save");case 18:t.t0=i.current.form_type,t.next="movement"===t.t0?21:"price"===t.t0||"discount"===t.t0?44:"invoice_link"===t.t0||"payment_link"===t.t0?62:75;break;case 21:if("delivery"!==i.current.transtype){t.next=43;break}return u=[],d=null,"undefined"!==typeof(m=i.dataset.movement_transfer.filter((function(e){return e.id===i.current.form.id}))[0])?(m=i.dataset.movement.filter((function(e){return e.id===m.ref_id}))[0],m=c()(a({tablename:"movement",dataset:i.dataset,current:i.current}),{$merge:m})):(m=c()(a({tablename:"movement",dataset:i.dataset,current:i.current}),{$merge:{place_id:i.current.item.place_id}}),d=c()(a({tablename:"link",dataset:i.dataset,current:i.current}),{$merge:{nervatype_1:e.login.data.groups.filter((function(e){return"nervatype"===e.groupname&&"movement"===e.groupvalue}))[0].id,nervatype_2:e.login.data.groups.filter((function(e){return"nervatype"===e.groupname&&"movement"===e.groupvalue}))[0].id,ref_id_2:i.current.form.id}})),m=c()(m,{$merge:{product_id:i.current.form.product_id,qty:-i.current.form.qty,notes:i.current.form.notes}}),u.push(R("movement",m)),i.dataset.movement_transfer.forEach((function(e){(m=c()(a({tablename:"movement",dataset:i.dataset,current:i.current}),{$merge:R("movement",e)})).id!==i.current.form.id&&m.place_id!==i.current.form.place_id&&(m=c()(m,{$merge:{place_id:i.current.form.place_id}}),u.push(m))})),t.next=31,r.requestData("/movement",{method:"POST",data:u});case 31:if(!(f=t.sent).error){t.next=35;break}return r.resultError(f),t.abrupt("return",null);case 35:if(null===d){t.next=43;break}return d=c()(d,{$merge:{ref_id_1:f[0]}}),t.next=39,r.requestData("/link",{method:"POST",data:[d]});case 39:if(!(f=t.sent).error){t.next=43;break}return r.resultError(f),t.abrupt("return",null);case 43:case 61:case 74:case 75:return t.abrupt("break",76);case 44:if(null===i.current.price_link_customer&&null===i.current.price_customer_id){t.next=61;break}if(null!==i.current.price_customer_id){t.next=54;break}return t.next=48,r.requestData("/link",{method:"DELETE",query:{id:i.current.price_link_customer}});case 48:if(!(o=t.sent)||!o.error){t.next=52;break}return r.resultError(o),t.abrupt("return",null);case 52:t.next=61;break;case 54:return v=c()(a({tablename:"link",dataset:i.dataset,current:i.current}),{$merge:{id:i.current.price_link_customer,nervatype_1:e.login.data.groups.filter((function(e){return"nervatype"===e.groupname&&"price"===e.groupvalue}))[0].id,ref_id_1:i.current.form.id,nervatype_2:e.login.data.groups.filter((function(e){return"nervatype"===e.groupname&&"customer"===e.groupvalue}))[0].id,ref_id_2:i.current.price_customer_id}}),t.next=57,r.requestData("/link",{method:"POST",data:[v]});case 57:if(!(o=t.sent).error){t.next=61;break}return r.resultError(o),t.abrupt("return",null);case 62:for(_=i.current.form_type+"_fieldvalue",g=0;g<i.current[_].length;g++)null===i.current[_][g].ref_id&&(i=c()(i,{current:(0,n.Z)({},_,(0,n.Z)({},g,{$merge:{ref_id:i.current.form.id}}))}));return x={link_qty:"0",link_rate:"1"},y=i.current[_],Object.keys(x).forEach((function(e){y=P(y,e,i.current.form.id,x[e])})),i=c()(i,{current:{$merge:(0,n.Z)({},_,y)}}),t.next=70,r.requestData("/fieldvalue",{method:"POST",data:y});case 70:if(!(o=t.sent).error){t.next=74;break}return r.resultError(o),t.abrupt("return",null);case 76:return t.abrupt("return",i);case 77:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),W=function(e,t,r){var n={customer:t===r.custtype,place:t===r.placetype,product:t===r.protype,tool:t===r.toolgroup,trans:t===r.transtype};return null===t||"undefined"===typeof n[e]||n[e]},M=function(){var t=(0,m.Z)((0,p.Z)().mark((function t(){var i,l,u,m,v,x,y,h,b,k,j,w,Z;return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=c()(e.edit,{}),l=null===i.current.item.id,u=R(i.current.type,i.current.item),t.next=5,s(i.current.type,u);case 5:if(!(u=t.sent).error){t.next=9;break}return r.resultError(u),t.abrupt("return",null);case 9:return t.next=11,r.requestData("/"+i.current.type,{method:"POST",data:[u]});case 11:if(!(m=t.sent).error){t.next=15;break}return r.resultError(m),t.abrupt("return",null);case 15:return null===i.current.item.id&&(i=c()(i,{current:{item:{$merge:{id:m[0]}}}})),i=c()(i,{$merge:{dirty:!1}}),t.next=19,r.createHistory("save");case 19:for("undefined"!==typeof i.current.extend&&(null===i.current.extend.ref_id&&(i=c()(i,{current:{extend:{$merge:{ref_id:i.current.item.id}}}})),null===i.current.extend.trans_id&&(i=c()(i,{current:{extend:{$merge:{trans_id:i.current.item.id}}}}))),v=0;v<i.current.fieldvalue.length;v++)null===i.current.fieldvalue[v].ref_id&&(i=c()(i,{current:{fieldvalue:(0,n.Z)({},v,{$merge:{ref_id:i.current.item.id}})}}));if("trans"!==i.current.type){t.next=52;break}t.t0=i.current.transtype,t.next="invoice"===t.t0?25:"worksheet"===t.t0?35:"rent"===t.t0?38:"delivery"===t.t0?41:51;break;case 25:if(l){t.next=34;break}return x={method:"POST",data:[{key:"fields",text:(0,d.aT)(e.login.data.engine,o.trans.invoice_customer()).sql,values:[i.current.item.customer_id]}]},t.next=29,r.requestData("/view",x);case 29:if(!(y=t.sent).error){t.next=33;break}return r.resultError(y),t.abrupt("return",null);case 33:y.fields.length>0&&Object.keys(y.fields[0]).forEach((function(e){i=c()(i,{current:{$merge:{fieldvalue:P(i.current.fieldvalue,e,i.current.item.id,null,y.fields[0][e])}}})}));case 34:return t.abrupt("break",52);case 35:return h={trans_wsdistance:0,trans_wsrepair:0,trans_wstotal:0,trans_wsnote:""},Object.keys(h).forEach((function(e){i=c()(i,{current:{$merge:{fieldvalue:P(i.current.fieldvalue,e,i.current.item.id,null,h[e])}}})})),t.abrupt("break",52);case 38:return b={trans_reholiday:0,trans_rebadtool:0,trans_reother:0,trans_rentnote:""},Object.keys(b).forEach((function(e){i=c()(i,{current:{$merge:{fieldvalue:P(i.current.fieldvalue,e,i.current.item.id,null,b[e])}}})})),t.abrupt("break",52);case 41:if(k=[],i.dataset.movement.forEach((function(e){var t=c()(a({tablename:"movement",dataset:i.dataset,current:i.current}),{$merge:e});(0,g.Z)((0,_.Z)(t.shippingdate),(0,_.Z)(i.current.item.transdate))||(t=c()(t,{$merge:{shippingdate:(0,f.Z)((0,_.Z)(i.current.item.transdate))}}),k.push(t))})),!(k.length>0)){t.next=50;break}return t.next=46,r.requestData("/movement",{method:"POST",data:k});case 46:if(!(m=t.sent).error){t.next=50;break}return r.resultError(m),t.abrupt("return",null);case 50:case 51:return t.abrupt("break",52);case 52:if(!(i.current.fieldvalue.length>0)){t.next=60;break}return t.next=55,r.requestData("/fieldvalue",{method:"POST",data:i.current.fieldvalue});case 55:if(!(m=t.sent).error){t.next=59;break}return r.resultError(m),t.abrupt("return",null);case 59:for(j=0;j<m.length;j++)i.current.fieldvalue[j].id||(i=c()(i,{current:{fieldvalue:(0,n.Z)({},j,{$merge:{id:m[j]}})}}));case 60:if("undefined"===typeof i.current.extend){t.next=98;break}w=String(i.template.options.extend).split("_")[0],Z=c()(i.current.extend,{}),t.t1=i.current.transtype,t.next="waybill"===t.t1?66:"formula"===t.t1?83:"production"===t.t1?86:89;break;case 66:if(w=Z.seltype,"transitem"!==Z.seltype){t.next=74;break}w="link",Z=a({tablename:"link",dataset:i.dataset,current:i.current}),Z=i.dataset.translink.length>0?c()(Z,{$merge:i.dataset.translink[0]}):c()(Z,{$merge:{nervatype_1:e.login.data.groups.filter((function(e){return"nervatype"===e.groupname&&"trans"===e.groupvalue}))[0].id,nervatype_2:e.login.data.groups.filter((function(e){return"nervatype"===e.groupname&&"trans"===e.groupvalue}))[0].id,ref_id_1:i.current.item.id}}),Z=c()(Z,{$merge:{ref_id_2:i.current.extend.ref_id}}),t.next=82;break;case 74:if(Z=null,!(i.dataset.translink.length>0)){t.next=82;break}return t.next=78,r.requestData("/link",{method:"DELETE",query:{id:i.dataset.translink[0].id}});case 78:if(!(m=t.sent)||!m.error){t.next=82;break}return r.resultError(m),t.abrupt("return",null);case 82:return t.abrupt("break",89);case 83:return Z=c()(Z,{$unset:["product"]}),Z=c()(Z,{$merge:{shippingdate:(0,f.Z)((0,_.Z)(i.current.item.transdate))}}),t.abrupt("break",89);case 86:return Z=c()(Z,{$unset:["product"]}),Z=c()(Z,{$merge:{shippingdate:i.current.item.duedate,place_id:i.current.item.place_id}}),t.abrupt("break",89);case 89:if(null===Z){t.next=98;break}return t.next=92,r.requestData("/"+w,{method:"POST",data:[Z]});case 92:if(!(m=t.sent).error){t.next=96;break}return r.resultError(m),t.abrupt("return",null);case 96:null===Z.id&&(Z=c()(Z,{$merge:{id:m[0]}})),i=c()(i,{current:{$merge:{extend:Z}}});case 98:return t.abrupt("return",i);case 99:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),U=function(n){t("current",{modalForm:(0,K.jsx)(T.default,{title:r.getText("msg_warning"),message:r.getText("ms_load_formula"),infoText:r.getText("msg_delete_info")+" "+r.getText("ms_continue_warning"),defaultOK:!0,labelOK:r.getText("msg_ok"),labelCancel:r.getText("msg_cancel"),onCancel:function(){t("current",{modalForm:null})},onOK:function(i){t("current",{modalForm:null},(0,m.Z)((0,p.Z)().mark((function i(){var s,l,m,f,v,_,g,x,y;return(0,p.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return s={method:"POST",data:[{key:"formula",text:(0,d.aT)(e.login.data.engine,o.trans.formula_items()).sql,values:[n]}]},i.next=3,r.requestData("/view",s);case 3:if(!(l=i.sent).error){i.next=6;break}return i.abrupt("return",r.resultError(l));case 6:m=e.edit.dataset.movement_head[0].qty,f=e.edit.dataset.movement_head[0].place_id,v=e.edit.dataset.formula_head.filter((function(e){return e.id===n}))[0].qty,_=[],l.formula.forEach((function(t){var r=c()(a({tablename:"movement",dataset:e.edit.dataset,current:e.edit.current}),{$merge:{product_id:t.product_id,place_id:null===t.place_id?f:t.place_id,qty:1===t.shared?-Math.ceil(m/v):-u(m/v*t.qty,2)}});_.push(r)})),g=0;case 12:if(!(g<e.edit.dataset.movement.length)){i.next=21;break}return i.next=15,r.requestData("/movement",{method:"DELETE",query:{id:e.edit.dataset.movement[g].id}});case 15:if(!(x=i.sent)||!x.error){i.next=18;break}return i.abrupt("return",r.resultError(x));case 18:g++,i.next=12;break;case 21:return i.next=23,r.requestData("/movement",{method:"POST",data:_});case 23:if(!(y=i.sent).error){i.next=26;break}return i.abrupt("return",r.resultError(y));case 26:t("current",{modalForm:null},(function(){D({ntype:e.edit.current.type,ttype:e.edit.current.transtype,id:e.edit.current.item.id,form:"movement"})}));case 27:case"end":return i.stop()}}),i)}))))}})})},z=function(){var t=(0,m.Z)((0,p.Z)().mark((function t(n){var i,s,l,o,d,m,_,g,x,y,h,b,k,j,w,Z,T,N,E,$,q,I,C,O,S,F,P,K;return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=function(e){return"waybill"===e.transtype?"link":"delivery"!==e.transtype||"normal"!==e.transcast||"in"!==e.direction&&"out"!==e.direction?"copy"===e.cmdtype&&"normal"===e.transcast?"":"normal"!==e.transcast||e.refno?"reflink":"refnumber":""},s=c()(e.edit.dataset.trans[0],{}),l=e.edit.dataset.groups.filter((function(e){return e.id===s.transtype}))[0].groupvalue,o=s.transtype,d=e.edit.dataset.groups.filter((function(e){return e.id===s.direction}))[0].groupvalue,m=s.direction,"undefined"===typeof n.new_transtype||"undefined"===typeof n.new_direction){t.next=16;break}if(l=n.new_transtype,"undefined"===typeof(_=e.login.data.audit.filter((function(e){return"trans"===e.nervatypeName&&e.subtypeName===l}))[0])){t.next=13;break}if("disabled"!==_.inputfilterName){t.next=13;break}return r.showToast({type:"info",title:r.getText("msg_warning"),message:r.getText("msg_create_disabled_err")+" "+l}),t.abrupt("return",!1);case 13:o=e.edit.dataset.groups.filter((function(e){return"transtype"===e.groupname&&e.groupvalue===l}))[0].id,d=n.new_direction,m=e.edit.dataset.groups.filter((function(e){return"direction"===e.groupname&&e.groupvalue===d}))[0].id;case 16:if("receipt"!==l&&"worksheet"!==l||"in"!==d){t.next=19;break}return r.showToast({type:"info",title:r.getText("msg_warning"),message:r.getText("msg_input_invalid")+" in"}),t.abrupt("return",!1);case 19:if("cancellation"!==s.transcast){t.next=22;break}return r.showToast({type:"info",title:r.getText("msg_warning"),message:r.getText("msg_create_cancellation_err1")}),t.abrupt("return",!1);case 22:if("cancellation"!==n.transcast||!["invoice","receipt"].includes(l)||0!==s.deleted){t.next=25;break}return r.showToast({type:"info",title:r.getText("msg_warning"),message:r.getText("msg_create_cancellation_err2")}),t.abrupt("return",!1);case 25:if(!("cancellation"===n.transcast&&e.edit.dataset.cancel_link.length>0)){t.next=28;break}return r.showToast({type:"info",title:r.getText("msg_warning"),message:r.getText("msg_create_cancellation_err3"+e.edit.dataset.cancel_link[0].transnumber)}),t.abrupt("return",!1);case 28:if("amendment"!==n.transcast||1!==s.deleted){t.next=31;break}return r.showToast({type:"info",title:r.getText("msg_warning"),message:r.getText("msg_create_amendment_err")}),t.abrupt("return",!1);case 31:return g=c()({},{$set:{id:null,transtype:o,transnumber:null,crdate:(0,f.Z)(new Date,{representation:"date"}),transdate:(0,f.Z)(new Date,{representation:"date"}),duedate:null,customer_id:s.customer_id,employee_id:s.employee_id,department:s.department,project_id:s.project_id,place_id:s.place_id,paidtype:s.paidtype,curr:s.curr,notax:s.notax,paid:0,acrate:s.acrate,notes:s.notes,intnotes:s.intnotes,fnote:s.fnote,transtate:e.edit.dataset.transtate.filter((function(e){return"transtate"===e.groupname&&"ok"===e.groupvalue}))[0].id,closed:0,deleted:0,direction:m,cruser_id:e.login.data.employee.id,trans_transcast:n.transcast||"normal"}}),null!==s.duedate&&(g.duedate=(0,f.Z)(new Date,{representation:"date"})+"T00:00:00"),"invoice"===l&&"out"===d&&"undefined"!==typeof(x=e.edit.dataset.settings.filter((function(e){return"default_deadline"===e.fieldname}))[0])&&(g.duedate=(0,f.Z)((0,v.Z)(new Date,parseInt(x.value,10)),{representation:"date"})+"T00:00:00"),"receipt"===l&&(g.customer_id=null),"refnumber"!==(y=i({transtype:l,transcast:n.transcast,direction:d,cmdtype:n.cmdtype,refno:n.refno}))&&"reflink"!==y||(g.ref_transnumber=s.transnumber),h=l+"_"+d,"waybill"!==l&&"cash"!==l||(h=l),b={method:"POST",data:{key:"nextNumber",values:{numberkey:h,step:!0}}},t.next=42,r.requestData("/function",b);case 42:if(!(k=t.sent).error){t.next=46;break}return r.resultError(k),t.abrupt("return",null);case 46:return"cancellation"===n.transcast?(g.transnumber=k+"/C","delivery"!==l&&"inventory"!==l&&(g.deleted=1),g.transdate=s.transdate,g.duedate=s.duedate):"amendment"===n.transcast?g.transnumber=k+"/A":g.transnumber=k,t.next=49,r.requestData("/trans",{method:"POST",data:[g]});case 49:if(!(k=t.sent).error){t.next=53;break}return r.resultError(k),t.abrupt("return",null);case 53:if(g.id=k[0],j=[],e.edit.current.fieldvalue.forEach((function(t){if("trans_transcast"!==t.fieldname&&"invoice"!==l){var r=e.edit.dataset.deffield.filter((function(e){return e.fieldname===t.fieldname}))[0],a=W("trans",r.subtype,g);if(0===t.deleted&&1===r.visible&&a||0===t.deleted&&a&&"copy"===n.cmdtype){var i=R("fieldvalue",t);i.id=null,i.ref_id=g.id,j.push(i)}}})),!(j.length>0)){t.next=63;break}return t.next=59,r.requestData("/fieldvalue",{method:"POST",data:j});case 59:if(!(k=t.sent).error){t.next=63;break}return r.resultError(k),t.abrupt("return",null);case 63:if("link"!==y&&"reflink"!==y){t.next=71;break}return w=c()(a({tablename:"link"}),{$merge:{nervatype_1:e.edit.dataset.groups.filter((function(e){return"nervatype"===e.groupname&&"trans"===e.groupvalue}))[0].id,ref_id_1:g.id,nervatype_2:e.edit.dataset.groups.filter((function(e){return"nervatype"===e.groupname&&"trans"===e.groupvalue}))[0].id,ref_id_2:s.id}}),t.next=67,r.requestData("/link",{method:"POST",data:[w]});case 67:if(!(k=t.sent).error){t.next=71;break}return r.resultError(k),t.abrupt("return",null);case 71:if(Z=[],"invoice"===l||"receipt"===l?(T=function(e,t,r){var n=0;return e.forEach((function(e){e.product_id===t&&e.deposit===r&&(n+=e.qty)})),n},N=function(e,t,r){return e.netamount=u(e.fxprice*(1-e.discount/100)*e.qty,r),e.vatamount=u(e.fxprice*(1-e.discount/100)*e.qty*t,r),e.amount=u(e.netamount+e.vatamount,r),e},E={},n.from_inventory&&e.edit.dataset.transitem_invoice?e.edit.dataset.transitem_shipping.forEach((function(t){var r=e.edit.dataset.item.filter((function(e){return"".concat(e.id,"-").concat(e.product_id)===t.id}))[0];if("undefined"!==typeof r){var n="out"===e.edit.dataset.groups.filter((function(e){return e.id===s.direction}))[0].groupvalue?-parseFloat(t.sqty):parseFloat(t.sqty);if(0===r.deleted&&n>0&&(Object.keys(E).includes(String(r.product_id))||(n-=T(e.edit.dataset.transitem_invoice,r.product_id,0),E[r.product_id]=!0),0!==n)){var a=R("item",r);a.qty=n,a=N(a,r.rate,s.digit),Z.push(a)}}})):e.edit.dataset.item.forEach((function(t){if(0===t.deleted)if(n.netto_qty&&e.edit.dataset.transitem_invoice){var r=t.qty;if(Object.keys(E).includes(String(t.product_id))||(r-=T(e.edit.dataset.transitem_invoice,t.product_id,0),E[t.product_id]=!0),0!==r){var a=R("item",t);a.qty=r,a=N(a,t.rate,s.digit),Z.push(a)}}else Z.push(R("item",t))})),c()([],{$set:Z}).forEach((function(t){if(1===t.deposit){var r=T(e.edit.dataset.transitem_invoice,t.product_id,1);if(0!==r){var n=R("item",t);n.qty=-r,Z=c()(Z,{$unshift:[n]})}}}))):e.edit.dataset.item.forEach((function(e){0===e.deleted&&Z.push(R("item",e))})),c()([],{$set:Z}).forEach((function(e){if(e.id=null,e.trans_id=g.id,e.ownstock=0,"invoice"!==l&&"receipt"!==l&&(e.deposit=0),"cancellation"===n.transcast&&(e.qty=-e.qty,e.netamount=-e.netamount,e.vatamount=-e.vatamount,e.amount=-e.amount),"amendment"===n.transcast){var t=R("item",e);t.qty=-t.qty,t.netamount=-t.netamount,t.vatamount=-t.vatamount,t.amount=-t.amount,Z=c()(Z,{$push:[t]})}})),!(Z.length>0)){t.next=82;break}return t.next=78,r.requestData("/item",{method:"POST",data:Z});case 78:if(!(k=t.sent).error){t.next=82;break}return r.resultError(k),t.abrupt("return",null);case 82:if($=[],e.edit.dataset.payment.forEach((function(e){if(0===e.deleted){var t=R("payment",e);t.id=null,t.trans_id=g.id,"cancellation"===n.transcast&&(t.amount=-t.amount),$.push(t)}})),!($.length>0)){t.next=91;break}return t.next=87,r.requestData("/payment",{method:"POST",data:$});case 87:if(!(k=t.sent).error){t.next=91;break}return r.resultError(k),t.abrupt("return",null);case 91:if(q=[],I=[],"formula"!==l&&"production"!==l||((C=R("movement",e.edit.dataset.movement_head[0])).id=null,C.trans_id=g.id,q.push(C)),(e.edit.dataset.movement||[]).forEach((function(e){if(0===e.deleted){(e.item_id||e.ref_id)&&I.push({id:e.id,item_id:e.item_id,ref_id:e.ref_id});var t=R("movement",e);t.id=null,t.trans_id=g.id,"cancellation"===n.transcast&&(t.qty=-t.qty),q.push(t)}})),!(q.length>0)){t.next=115;break}return t.next=99,r.requestData("/movement",{method:"POST",data:q});case 99:if(!(k=t.sent).error){t.next=103;break}return r.resultError(k),t.abrupt("return",null);case 103:for(O=[],S=e.edit.dataset.groups.filter((function(e){return"nervatype"===e.groupname&&"movement"===e.groupvalue}))[0].id,F=e.edit.dataset.groups.filter((function(e){return"nervatype"===e.groupname&&"item"===e.groupvalue}))[0].id,P=function(t){var r=c()(a({tablename:"link"}),{$merge:{nervatype_1:S}});null!==I[t].item_id?(r.ref_id_1=k[t].id,r.nervatype_2=F,r.ref_id_2=I[t].item_id,O.push(r)):(r.ref_id_1=k[e.edit.dataset.movement.findIndex((function(e){return e.id===I[t].ref_id}))].id,r.nervatype_2=S,r.ref_id_2=k[e.edit.dataset.movement.findIndex((function(e){return e.id===I[t].id}))].id,O.push(r))},K=0;K<I.length;K++)P(K);if(!(O.length>0)){t.next=115;break}return t.next=111,r.requestData("/link",{method:"POST",data:O});case 111:if(!(k=t.sent).error){t.next=115;break}return r.resultError(k),t.abrupt("return",null);case 115:return t.next=117,r.createHistory("save");case 117:D({ntype:"trans",ttype:l,id:g.id});case 118:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),V=function(){var n=c()(e.edit,{}),a={directions:["in","out"],baseTranstype:n.current.transtype,transtype:n.current.transtype,direction:n.dataset.groups.filter((function(e){return e.id===n.current.item.direction}))[0].groupvalue,elementCount:parseInt(n.dataset.element_count[0].pec,10),doctypes:["order","worksheet","rent","invoice","receipt"],refno:!0,netto:!0,from:!1,nettoDiv:!1,fromDiv:!1};switch(a.transtype){case"offer":a.doctypes=["offer","order","worksheet","rent"],a.transtype="order",a.nettoDiv=!1,a.fromDiv=!1;break;case"order":case"worksheet":case"rent":a.doctypes=["offer","order","worksheet","rent","invoice","receipt"],a.transtype="invoice",a.nettoDiv=!0,0===a.elementCount?a.fromDiv=!0:a.fromDiv=!1;break;case"invoice":a.doctypes=["order","worksheet","rent","invoice","receipt"],a.transtype="order",a.nettoDiv=!1,a.fromDiv=!1;break;default:a.transtype="order"}t("current",{modalForm:(0,K.jsx)(me,(0,i.Z)((0,i.Z)({},a),{},{getText:r.getText,onClose:function(){return t("current",{modalForm:null})},onCreate:function(e){t("current",{modalForm:null},(function(){z({cmdtype:"create",transcast:"normal",new_transtype:e.newTranstype,new_direction:e.newDirection,refno:e.refno,from_inventory:e.fromInventory,netto_qty:e.nettoQty})}))}})),side:"hide"})},H=function(n,a){var i=function(a){switch(a){case"LOAD_EDITOR":D(n);break;case"SET_EDITOR_ITEM":C(n);break;case"LOAD_FORMULA":t("current",{modalForm:(0,K.jsx)(A,{formula:n.formula,partnumber:e.edit.dataset.movement_head[0].partnumber,description:e.edit.dataset.movement_head[0].description,formulaValues:e.edit.dataset.formula_head.map((function(e){return{value:String(e.id),text:e.transnumber}})),getText:r.getText,onClose:function(){return t("current",{modalForm:null})},onFormula:function(e){t("current",{modalForm:null},(function(){U(e)}))}}),side:"hide"});break;case"NEW_FIELDVALUE":O(n.fieldname);break;case"CREATE_TRANS":z(n);break;case"CREATE_TRANS_OPTIONS":V();break;case"FORM_ACTIONS":Y(n)}};if(!0===e.edit.dirty&&e.edit.current.item||!0===e.edit.form_dirty&&e.edit.current.form)return t("current",{modalForm:(0,K.jsx)(T.default,{title:r.getText("msg_warning"),message:r.getText("msg_dirty_text"),infoText:r.getText("msg_delete_info"),defaultOK:!0,labelOK:r.getText("msg_save"),labelCancel:r.getText("msg_cancel"),onCancel:function(){t("current",{modalForm:null},(function(){i(a)}))},onOK:function(r){t("current",{modalForm:null},(0,m.Z)((0,p.Z)().mark((function r(){var n;return(0,p.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!e.edit.form_dirty){r.next=6;break}return r.next=3,L();case 3:r.t0=r.sent,r.next=9;break;case 6:return r.next=8,M();case 8:r.t0=r.sent;case 9:if(!(n=r.t0)){r.next=12;break}return r.abrupt("return",t("edit",n,(function(){i(a)})));case 12:case"end":return r.stop()}}),r)}))))}}),side:"hide"});i(a)},B=function(){var t=(0,m.Z)((0,p.Z)().mark((function t(n,a){var s,l;return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("trans"!==n.ntype&&"transitem"!==n.ntype&&"transmovement"!==n.ntype&&"transpayment"!==n.ntype||null!==n.ttype){t.next=10;break}return s={method:"POST",data:[{key:"transtype",text:(0,d.aT)(e.login.data.engine,{select:["groupvalue"],from:"groups g",inner_join:["trans t","on",[["g.id","=","t.transtype"],["and","t.id","=","?"]]]}).sql,values:[n.id]}]},t.next=4,r.requestData("/view",s);case 4:if(!(l=t.sent).error){t.next=7;break}return t.abrupt("return",r.resultError(l));case 7:H((0,i.Z)((0,i.Z)({},n),{},{ntype:"trans",ttype:l.transtype[0].groupvalue,id:n.id}),a),t.next=11;break;case 10:H(n,a);case 11:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),G=function(){var n=(0,m.Z)((0,p.Z)().mark((function n(a){var i,s;return(0,p.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i={method:"POST",data:[{key:"stock",text:(0,d.aT)(e.login.data.engine,o.trans.shipping_stock()).sql,values:[a.product_id]}]},n.next=3,r.requestData("/view",i);case 3:if(!(s=n.sent).error){n.next=6;break}return n.abrupt("return",r.resultError(s));case 6:if(0!==s.stock.length){n.next=8;break}return n.abrupt("return",r.showToast({type:"info",title:r.getText("msg_warning"),message:r.getText("ms_no_stock")}));case 8:t("current",{modalForm:(0,K.jsx)(ae,{partnumber:a.partnumber,partname:a.partname,rows:s.stock,getText:r.getText,onClose:function(){return t("current",{modalForm:null})}})});case 9:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),X=function(){var t=(0,m.Z)((0,p.Z)().mark((function t(r){var n;return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.edit.current.item,t.next=3,E({type:n.mode,template:r.reportkey,title:r.refnumber,orient:n.orientation,size:n.size,copy:r.copies,nervatype:r.typename,id:r.ref_id});case 3:F({fkey:"items",table:"ui_printqueue",id:r.id,prompt:!0});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Y=function(a){var i=a.row||{},s=c()({},{$set:e.edit});switch(a.params.action){case"loadEditor":H({ntype:a.params.ntype||s.current.type,ttype:a.params.ttype||s.current.transtype,id:i.id||null},"LOAD_EDITOR");break;case"newEditorItem":H({fkey:a.params.fkey,id:null},"SET_EDITOR_ITEM");break;case"editEditorItem":C({fkey:a.params.fkey,id:i.id});break;case"deleteEditorItem":F({fkey:a.params.fkey,table:a.params.table,id:i.id});break;case"loadShipping":H({ntype:a.params.ntype||s.current.type,ttype:a.params.ttype||s.current.transtype,id:a.params.id||s.current.item.id,shipping:!0},"LOAD_EDITOR");break;case"addShippingRow":!0!==i.edited&&(s=c()(s,{dataset:{shiptemp:{$push:[{id:i.item_id+"-"+i.product_id,item_id:i.item_id,product_id:i.product_id,product:i.product,partnumber:i.partnumber,partname:i.partname,unit:i.unit,batch_no:"",qty:i.diff,diff:0,oqty:i.qty,tqty:i.tqty}]}}}),I({shipping:!0,form:"shipping_items"},s.template,s));break;case"showShippingStock":G({product_id:i.product_id,partnumber:i.partnumber,partname:i.partname});break;case"editShippingRow":t("current",{modalForm:(0,K.jsx)(Q,{partnumber:i.partnumber,description:i.product,unit:i.unit,batch_no:i.batch_no,qty:i.qty,getText:r.getText,onClose:function(){return t("current",{modalForm:null})},onShipping:function(e,r){t("current",{modalForm:null},(function(){var a=s.dataset.shiptemp.findIndex((function(e){return e.id===i.id}));s=c()(s,{dataset:{shiptemp:(0,n.Z)({},a,{$merge:{batch_no:e,qty:r,diff:i.oqty-(i.tqty+r)}})}}),t("edit",s)}))}})});break;case"deleteShippingRow":var l=s.dataset.shiptemp.findIndex((function(e){return e.id===i.id}));s=c()(s,{dataset:{shiptemp:{$splice:[[l,1]]}}}),I({shipping:!0,form:"shiptemp_items"},s.template,s);break;case"exportQueueItem":X(i)}},J=function(t,r){switch(e.login.data.transfilterName){case"usergroup":t.where.push(["and","cruser_id","in",[{select:["id"],from:"employee",where:["usergroup","=","?"]}]]),r.push(e.login.data.employee.usergroup);break;case"own":t.where.push(["and","cruser_id","=","?"]),r.push(e.login.data.employee.id)}return[t,r]},ee=function(){var t=(0,m.Z)((0,p.Z)().mark((function t(){var n,a,i,s,l,o,c;return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("trans"===e.edit.current.type&&null!==e.edit.current.item.id){t.next=2;break}return t.abrupt("return");case 2:return n=e.edit.current.transtype,a=e.edit.dataset.groups.filter((function(t){return t.id===e.edit.current.item.direction}))[0].groupvalue,i={select:["max(id) as id"],from:"trans",where:[["transtype","=","?"],["and","id","<","?"]]},s=[e.edit.current.item.transtype,e.edit.current.item.id],["cash","waybill"].includes(n)||(i.where.push(["and","direction","=","?"]),s.push(e.edit.current.item.direction)),["invoice_out","receipt_out","cash_out","cash_in"].includes("".concat(n,"_").concat(a))||i.where.push(["and","deleted","=","0"]),l=J(i,s),o={method:"POST",data:[{key:"prev",text:(0,d.aT)(e.login.data.engine,l[0]).sql,values:l[1]}]},t.next=12,r.requestData("/view",o);case 12:if(!(c=t.sent).error){t.next=15;break}return t.abrupt("return",r.resultError(c));case 15:null!==c.prev[0].id&&H({ntype:"trans",ttype:n,id:c.prev[0].id},"LOAD_EDITOR");case 16:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),te=function(){var t=(0,m.Z)((0,p.Z)().mark((function t(){var n,a,i,s,l,o,c;return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.edit.current.transtype,a=e.edit.dataset.groups.filter((function(t){return t.id===e.edit.current.item.direction}))[0].groupvalue,i={select:["min(id) as id"],from:"trans",where:[["transtype","=","?"],["and","id",">","?"]]},s=[e.edit.current.item.transtype,e.edit.current.item.id],["cash","waybill"].includes(n)||(i.where.push(["and","direction","=","?"]),s.push(e.edit.current.item.direction)),["invoice_out","receipt_out","cash_out","cash_in"].includes("".concat(n,"_").concat(a))||i.where.push(["and","deleted","=","0"]),l=J(i,s),o={method:"POST",data:[{key:"next",text:(0,d.aT)(e.login.data.engine,l[0]).sql,values:l[1]}]},t.next=10,r.requestData("/view",o);case 10:if(!(c=t.sent).error){t.next=13;break}return t.abrupt("return",r.resultError(c));case 13:null===c.next[0].id?["delivery_out","delivery_in"].includes("".concat(n,"_").concat(a))||H({ntype:"trans",ttype:n,id:null},"LOAD_EDITOR"):H({ntype:"trans",ttype:n,id:c.next[0].id},"LOAD_EDITOR");case 14:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),re=function(){var t=(0,m.Z)((0,p.Z)().mark((function t(){var n,i,s,l,o,u,d,m;return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==e.edit.current.shipping_place_id){t.next=2;break}return t.abrupt("return",r.showToast({type:"error",title:r.getText("msg_warning"),message:r.getText("msg_required")+" "+r.getText("inventory_warehouse")}));case 2:if(!(e.edit.dataset.shiptemp.length>0)){t.next=42;break}return n=c()(a({tablename:"trans",dataset:e.edit.dataset,current:e.edit.current}),{$merge:{transtype:e.edit.dataset.groups.filter((function(e){return"transtype"===e.groupname&&"delivery"===e.groupvalue}))[0].id,direction:e.edit.dataset[e.edit.current.type][0].direction,transdate:(0,f.Z)((0,_.Z)(e.edit.current.item.shippingdate),{representation:"date"}),duedate:null,curr:null,paidtype:null}}),"undefined"!==typeof(i=e.edit.dataset.delivery_pattern.filter((function(e){return 1===e.defpattern}))[0])&&(n=c()(n,{$merge:{fnote:i.notes}})),s={method:"POST",data:{key:"nextNumber",values:{numberkey:"delivery_"+e.edit.current.direction,step:!0}}},t.next=9,r.requestData("/function",s);case 9:if(!(l=t.sent).error){t.next=13;break}return r.resultError(l),t.abrupt("return",null);case 13:return n=c()(n,{$merge:{transnumber:l}}),t.next=16,r.requestData("/trans",{method:"POST",data:[n]});case 16:if(!(l=t.sent).error){t.next=20;break}return r.resultError(l),t.abrupt("return",null);case 20:return n.id=l[0],t.next=23,r.createHistory("save");case 23:return o=[],e.edit.dataset.shiptemp.forEach((function(t){var r=c()(a({tablename:"movement",dataset:e.edit.dataset,current:e.edit.current}),{$merge:{trans_id:n.id,shippingdate:(0,f.Z)((0,_.Z)(e.edit.current.shippingdate)),product_id:t.product_id,place_id:e.edit.current.shipping_place_id,notes:t.batch_no,qty:"out"===e.edit.current.direction?-t.qty:t.qty}});o.push(r)})),t.next=27,r.requestData("/movement",{method:"POST",data:o});case 27:if(!(l=t.sent).error){t.next=31;break}return r.resultError(l),t.abrupt("return",null);case 31:return u=[],d=e.edit.dataset.groups.filter((function(e){return"nervatype"===e.groupname&&"movement"===e.groupvalue}))[0].id,m=e.edit.dataset.groups.filter((function(e){return"nervatype"===e.groupname&&"item"===e.groupvalue}))[0].id,l.forEach((function(t,r){var n=c()(a({tablename:"link",dataset:e.edit.dataset,current:e.edit.current}),{$merge:{nervatype_1:d,ref_id_1:t,nervatype_2:m,ref_id_2:e.edit.dataset.shiptemp[r].item_id}});u.push(n)})),t.next=37,r.requestData("/link",{method:"POST",data:u});case 37:if(!(l=t.sent).error){t.next=41;break}return r.resultError(l),t.abrupt("return",null);case 41:D({ntype:e.edit.current.type,ttype:e.edit.current.transtype,id:e.edit.current.item.id,shipping:!0});case 42:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),ne=function(t,r){var n=e.edit.dataset.tax.filter((function(e){return e.id===parseInt(r.tax_id,10)}))[0];n="undefined"!==typeof n?n.rate:0;var a=e.edit.dataset.currency.filter((function(t){return t.curr===e.edit.current.item.curr}))[0];a="undefined"!==typeof a?a.digit:2;var i=0,s=0,l=0,o=0;switch(t){case"netamount":i=parseFloat(r.netamount),0!==parseFloat(r.qty)&&(o=u(i/(1-parseFloat(r.discount)/100)/parseFloat(r.qty),parseInt(a,10)),s=u(i*parseFloat(n),parseInt(a,10))),l=u(i+s,parseInt(a,10));break;case"amount":l=parseFloat(r.amount),0!==parseFloat(r.qty)&&(i=u(l/(1+parseFloat(n)),parseInt(a,10)),s=u(l-i,parseInt(a,10)),o=u(i/(1-parseFloat(r.discount)/100)/parseFloat(r.qty),parseInt(a,10)));break;default:o=parseFloat(r.fxprice),i=u(o*(1-parseFloat(r.discount)/100)*parseFloat(r.qty),parseInt(a,10)),s=u(o*(1-parseFloat(r.discount)/100)*parseFloat(r.qty)*parseFloat(n),parseInt(a,10)),l=u(i+s,parseInt(a,10))}return c()(r,{$merge:{fxprice:o,netamount:i,vatamount:s,amount:l}})},ie=function(){var a=(0,m.Z)((0,p.Z)().mark((function a(i){var s,l,o,u,d,f,v,_;return(0,p.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(s=function(){var e=(0,m.Z)((0,p.Z)().mark((function e(t,n){var a;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"POST",data:{key:"getPriceValue",values:{vendorprice:n.vendorprice,product_id:n.product_id,posdate:t.transdate,curr:t.curr,qty:n.qty,customer_id:t.customer_id}}},e.abrupt("return",r.requestData("/function",a));case 2:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),l=c()({},{$set:e.edit}),!["fieldvalue_value","fieldvalue_notes","fieldvalue_deleted"].includes(i.name)){a.next=7;break}(o=l.current.fieldvalue.findIndex((function(e){return e.id===i.id})))>-1&&["all","update"].includes(l.audit)&&(l=c()(l,{$merge:{dirty:!0}}),l=c()(l,{current:{fieldvalue:(0,n.Z)({},o,{$merge:(0,n.Z)({},i.name.split("_")[1],"fieldvalue_deleted"===i.name?1:i.value.toString())})}})),a.next=98;break;case 7:if(!l.current.form){a.next=54;break}"undefined"!==typeof(l=c()(l,{$merge:{form_dirty:!0}})).current.form[i.name]&&(l=c()(l,{current:{form:{$merge:(0,n.Z)({},i.name,i.value)}}})),a.t0=l.current.form_type,a.next="item"===a.t0?13:"price"===a.t0||"discount"===a.t0?45:"invoice_link"===a.t0?47:"payment_link"===a.t0?49:51;break;case 13:if("product_id"!==i.name||"undefined"===typeof i.item){a.next=25;break}return 0===(l=c()(l,{current:{form:{$merge:{description:i.item.description,unit:i.item.unit,tax_id:parseInt(i.item.tax_id,10)}}}})).current.form.qty&&(l=c()(l,{current:{form:{$merge:{qty:1}}}})),a.next=18,s(l.current.item,l.current.form);case 18:if(!(u=a.sent).error){a.next=21;break}return a.abrupt("return",r.resultError(u));case 21:l=c()(l,{current:{form:{$merge:{fxprice:isNaN(parseFloat(u.price))?0:parseFloat(u.price),discount:isNaN(parseFloat(u.discount))?0:parseFloat(u.discount)}}}}),"blur"===i.event_type&&(l=c()(l,{current:{$merge:{form:ne("fxprice",l.current.form)}}})),a.next=44;break;case 25:a.t1=i.name,a.next="qty"===a.t1?28:"fxprice"===a.t1||"tax_id"===a.t1||"discount"===a.t1?37:"amount"===a.t1?39:"netamount"===a.t1?41:43;break;case 28:if(0!==parseFloat(l.current.form.fxprice)){a.next=35;break}return a.next=31,s(l.current.item,l.current.form);case 31:if(!(d=a.sent).error){a.next=34;break}return a.abrupt("return",r.resultError(d));case 34:l=c()(l,{current:{form:{$merge:{fxprice:isNaN(parseFloat(d.price))?0:parseFloat(d.price),discount:isNaN(parseFloat(d.discount))?0:parseFloat(d.discount)}}}});case 35:case 37:return"blur"===i.event_type&&(l=c()(l,{current:{$merge:{form:ne("fxprice",l.current.form)}}})),a.abrupt("break",44);case 39:return"blur"===i.event_type&&(l=c()(l,{current:{$merge:{form:ne("amount",l.current.form)}}})),a.abrupt("break",44);case 41:return"blur"===i.event_type&&(l=c()(l,{current:{$merge:{form:ne("netamount",l.current.form)}}})),a.abrupt("break",44);case 43:return a.abrupt("break",44);case 44:return a.abrupt("break",52);case 45:return"customer_id"===i.name&&(l=c()(l,{current:{$merge:{price_customer_id:i.value}}})),a.abrupt("break",52);case 47:return"ref_id_1"===i.name&&"undefined"!==typeof i.item?l=c()(l,{current:{invoice_link:{0:{$merge:{curr:i.item.curr}}}}}):"link_qty"!==i.name&&"link_rate"!==i.name||(l=c()(l,{current:{$merge:{invoice_link_fieldvalue:P(l.current.invoice_link_fieldvalue,i.name,l.current.form.id,null,i.value)}}})),a.abrupt("break",52);case 49:return"ref_id_2"===i.name&&"undefined"!==typeof i.item?l=c()(l,{current:{payment_link:{0:{$merge:{curr:i.item.curr}}}}}):"link_qty"!==i.name&&"link_rate"!==i.name||(l=c()(l,{current:{$merge:{payment_link_fieldvalue:P(l.current.payment_link_fieldvalue,i.name,l.current.form.id,null,i.value)}}})),a.abrupt("break",52);case 51:return a.abrupt("break",52);case 52:a.next=98;break;case 54:"undefined"!==typeof l.current.item[i.name]&&!1===i.extend?(l=c()(l,{current:{item:{$merge:(0,n.Z)({},i.name,i.value)}}}),i.label_field&&(l=c()(l,{current:{item:{$merge:(0,n.Z)({},i.label_field,i.refnumber||null)}}}))):"undefined"!==typeof l.template.options.extend&&!0===i.extend&&(l=c()(l,{current:{extend:{$merge:(0,n.Z)({},i.name,i.value)}}})),"all"!==l.audit&&"update"!==l.audit||(l=c()(l,{$merge:{dirty:!0}})),a.t2=l.current.type,a.next="report"===a.t2?59:"printqueue"===a.t2?62:"trans"===a.t2?65:97;break;case 59:return l=c()(l,{$merge:{dirty:!1}}),"selected"===i.name?(f=l.current.fieldvalue.findIndex((function(e){return e.id===i.id})))>-1&&(l=c()(l,{current:{fieldvalue:(0,n.Z)({},f,{$merge:{selected:i.value}})}})):(v=l.current.fieldvalue.findIndex((function(e){return e.name===i.name})))>-1&&(l=c()(l,{current:{fieldvalue:(0,n.Z)({},v,{$merge:{value:i.value}})}})),a.abrupt("break",98);case 62:return l=c()(l,{$merge:{dirty:!1}}),l=c()(l,{printqueue:{$merge:(0,n.Z)({},i.name,i.value)}}),a.abrupt("break",98);case 65:a.t3=i.name,a.next="closed"===a.t3?68:"paiddate"===a.t3?70:"direction"===a.t3?72:"seltype"===a.t3?74:"ref_id"===a.t3?76:"trans_wsdistance"===a.t3||"trans_wsrepair"===a.t3||"trans_wstotal"===a.t3||"trans_reholiday"===a.t3||"trans_rebadtool"===a.t3||"trans_reother"===a.t3||"trans_wsnote"===a.t3||"trans_rentnote"===a.t3?88:"shippingdate"===a.t3||"shipping_place_id"===a.t3?90:"fnote"===a.t3?93:95;break;case 68:return 1===i.value&&t("current",{modalForm:(0,K.jsx)(T.default,{title:r.getText("msg_warning"),message:r.getText("msg_close_text"),infoText:r.getText("msg_delete_info"),labelOK:r.getText("msg_ok"),labelCancel:r.getText("msg_cancel"),onCancel:function(){t("current",{modalForm:null},(function(){l=c()(l,{current:{item:{$merge:(0,n.Z)({},i.name,0)}}}),t("edit",l)}))},onOK:function(e){t("current",{modalForm:null},(function(){l=c()(l,{current:{$merge:{closed:1}}}),t("edit",l)}))}})}),a.abrupt("break",96);case 70:return l=c()(l,{current:{item:{$merge:{transdate:i.value}}}}),a.abrupt("break",96);case 72:return"cash"===l.current.transtype&&(_=l.dataset.groups.filter((function(e){return e.id===i.value}))[0].groupvalue,l=c()(l,{template:{options:{$merge:{opposite:"out"===_}}}})),a.abrupt("break",96);case 74:return l=c()(l,{current:{extend:{$merge:{seltype:i.value,ref_id:null,refnumber:""}},item:{$merge:{customer_id:null,employee_id:null,ref_transnumber:null}}}}),a.abrupt("break",96);case 76:l=c()(l,{current:{extend:{$merge:{refnumber:i.refnumber,ntype:"transitem"===l.current.extend.seltype?"trans":l.current.extend.seltype,transtype:i.item&&i.item.transtype?i.item.transtype.split("-")[0]:""}}}}),a.t4=l.current.extend.seltype,a.next="customer"===a.t4?80:"employee"===a.t4?82:"transitem"===a.t4?84:86;break;case 80:return l=c()(l,{current:{item:{$merge:{customer_id:i.value}}}}),a.abrupt("break",87);case 82:return l=c()(l,{current:{item:{$merge:{employee_id:i.value}}}}),a.abrupt("break",87);case 84:return l=c()(l,{current:{item:{$merge:{ref_transnumber:i.refnumber}}}}),a.abrupt("break",87);case 86:return a.abrupt("break",87);case 87:return a.abrupt("break",96);case 88:return l=c()(l,{current:{$merge:{fieldvalue:P(l.current.fieldvalue,i.name,l.current.item.id,null,i.value)}}}),a.abrupt("break",96);case 90:return l=c()(l,{$merge:{dirty:!1}}),l=c()(l,{current:{$merge:(0,n.Z)({},i.name,i.value)}}),a.abrupt("break",96);case 93:return l=c()(l,{current:{item:{$merge:{fnote:i.value}}}}),a.abrupt("break",96);case 95:return a.abrupt("break",96);case 96:case 97:return a.abrupt("break",98);case 98:t("edit",l);case 99:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),se=function(){var t=(0,m.Z)((0,p.Z)().mark((function t(){var r;return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=null,!e.edit.current.form){t.next=7;break}return t.next=4,L();case 4:r=t.sent,t.next=10;break;case 7:return t.next=9,M();case 9:r=t.sent;case 10:r&&D({ntype:r.current.type,ttype:r.current.transtype,id:r.current.item.id,form:r.current.view});case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return{addPrintQueue:N,calcFormula:U,calcPrice:ne,checkEditor:H,checkSubtype:W,checkTranstype:B,createReport:q,createShipping:re,createTrans:z,createTransOptions:V,deleteEditor:S,deleteEditorItem:F,editItem:ie,editorBack:function(){if(e.edit.current.form)H({ntype:e.edit.current.type,ttype:e.edit.current.transtype,id:e.edit.current.item.id,form:e.edit.current.form_type},"LOAD_EDITOR");else if("transitem_shipping"===e.edit.current.form_type)H({ntype:e.edit.current.type,ttype:e.edit.current.transtype,id:e.edit.current.item.id,form:e.edit.current.form_type},"LOAD_EDITOR");else{var t=e.login.data.groups.filter((function(t){return t.id===e.edit.current.item.nervatype}))[0].groupvalue;H({ntype:t,ttype:null,id:e.edit.current.item.ref_id,form:e.edit.current.type},"LOAD_EDITOR")}},editorDelete:function(){e.edit.current.form?F({fkey:e.edit.current.form_type,table:e.edit.current.form_datatype,id:e.edit.current.form.id}):S()},editorNew:function(t){"shipping"===t.ttype?r.onSelector("transitem_delivery","",(function(e,t){var r=e.id.split("/");H({ntype:r[0],ttype:r[1],id:parseInt(r[2],10),shipping:!0},"LOAD_EDITOR")})):H({ntype:t.ntype||e.edit.current.type,ttype:t.ttype||e.edit.current.transtype,id:null},"LOAD_EDITOR")},editorSave:se,exportEvent:function(){var t=e.edit.current.item,r="BEGIN:VCALENDAR\nPRODID:-//nervatura.com/NONSGML Nervatura Calendar//EN\nVERSION:2.0\nBEGIN:VEVENT\nUID:".concat(null!==t.uid?t.uid:(0,d.M8)());if(null!==t.fromdate&&(r+="\nDTSTART:".concat((0,x.Z)((0,_.Z)(t.fromdate),"yyyyMMdd'T'HHmmss"))),null!==t.todate&&(r+="\nDTEND:".concat((0,x.Z)((0,_.Z)(t.todate),"yyyyMMdd'T'HHmmss"))),null!==t.subject&&(r+="\nSUMMARY:".concat(t.subject)),null!==t.place&&(r+="\nLOCATION:".concat(t.place)),null!==t.description&&(r+="\nDESCRIPTION:".concat(t.description)),null!==t.eventgroup){var n=e.edit.dataset.eventgroup.filter((function(e){return e.id===t.eventgroup}))[0];"undefined"!==typeof n&&(r+="\nCATEGORY:".concat(n.groupvalue))}r+="\nEND:VEVENT\nEND:VCALENDAR";var a=t.calnumber.replace(/\//g,"_")+".ics",i=URL.createObjectURL(new Blob([r],{type:"text/ics;charset=utf-8;"}));(0,d.GX)(i,a)},exportQueueAll:function(){var n=e.edit.current.item;if(e.edit.dataset.items.length>0){if("print"===n.mode)return r.showToast({type:"error",title:r.getText("msg_warning"),message:r.getText("ms_export_invalid")+" "+r.getText("printqueue_mode_print")});t("current",{modalForm:(0,K.jsx)(T.default,{title:r.getText("msg_warning"),message:r.getText("label_export_all_selected"),infoText:r.getText("msg_delete_info")+" "+r.getText("ms_continue_warning"),defaultOK:!0,labelOK:r.getText("msg_ok"),labelCancel:r.getText("msg_cancel"),onCancel:function(){t("current",{modalForm:null})},onOK:function(a){t("current",{modalForm:null},(0,m.Z)((0,p.Z)().mark((function t(){var a,i,s;return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=0;case 1:if(!(a<e.edit.dataset.items.length)){t.next=15;break}return i=e.edit.dataset.items[a],t.next=5,E({type:n.mode,template:i.reportkey,title:i.refnumber,orient:n.orientation,size:n.size,copy:i.copies,nervatype:i.typename,id:i.ref_id});case 5:if(!(s=t.sent)){t.next=12;break}return t.next=9,r.requestData("/ui_printqueue",{method:"DELETE",query:{id:i.id}});case 9:if(!(s=t.sent)||!s.error){t.next=12;break}return t.abrupt("return",r.resultError(s));case 12:a++,t.next=1;break;case 15:$();case 16:case"end":return t.stop()}}),t)}))))}})})}},exportQueue:X,getTransFilter:J,loadEditor:D,newFieldvalue:O,nextTransNumber:te,prevTransNumber:ee,reportOutput:E,reportPath:y,reportSettings:function(){var n="trans"===e.edit.current.type?e.edit.dataset.groups.filter((function(t){return t.id===e.edit.current.item.direction}))[0].groupvalue:"out",a="trans"===e.edit.current.type?e.edit.dataset.settings.filter((function(t){return t.fieldname==="default_trans_"+e.edit.current.transtype+"_"+n+"_report"}))[0]:e.edit.dataset.settings.filter((function(t){return t.fieldname==="default_"+e.edit.current.type+"_report"}))[0],i=[];e.edit.dataset.report.forEach((function(t){var r=e.login.data.audit.filter((function(e){return"report"===e.nervatypeName&&e.subtype===t.id}))[0];"disabled"!==(r=r?r.inputfilterName:"all")&&("trans"===e.edit.current.type?e.edit.current.item.direction===t.direction&&i.push({value:t.reportkey,text:t.repname}):i.push({value:t.reportkey,text:t.repname}))})),a="undefined"!==typeof a?a.value:i.length>0?i[0].value:"",t("current",{modalForm:(0,K.jsx)(ke,{title:e.edit.current.item[e.edit.template.options.title_field],template:a,templates:i,orient:(0,Z.$8)("page_orient"),size:(0,Z.$8)("page_size"),copy:1,getText:r.getText,onClose:function(){return t("current",{modalForm:null})},onOutput:function(e){t("current",{modalForm:null},(function(){E(e)}))}}),side:"hide"})},round:u,saveEditorForm:L,saveEditor:M,searchQueue:$,setEditorItem:C,setEditor:I,setFieldvalue:P,setFormActions:Y,setLink:function(r,n){t("current",{side:"hide"},(function(){var t="cash"===e.edit.current.transtype?e.edit.current.extend.id:e.edit.current.form.id;H({fkey:r,id:null,link_field:n,link_id:t},"SET_EDITOR_ITEM")}))},setPassword:function(r){!r&&e.edit.current&&(r=e.edit.dataset[e.edit.current.type][0].username),t("current",{module:"setting",content:{username:r,nextKey:"PASSWORD_FORM"},side:"hide"})},setPattern:function(i){var s=i.key,l=function(){var t=(0,m.Z)((0,p.Z)().mark((function t(n){var a,i;return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={method:"POST",data:n},t.next=3,r.requestData("/pattern",a);case 3:if(!(i=t.sent).error){t.next=6;break}return t.abrupt("return",r.resultError(i));case 6:H({ntype:e.edit.current.type,ttype:e.edit.current.transtype,id:e.edit.current.item.id,form:"fnote"},"LOAD_EDITOR");case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),o={default:{title:r.getText("msg_warning"),message:r.getText("msg_pattern_default"),infoText:void 0,value:"",showValue:!1,defaultOK:!0,ok:function(t){var r=c()(e.edit.dataset.pattern,{});r.forEach((function(t,a){r=c()(r,(0,n.Z)({},a,{$merge:{defpattern:t.id===parseInt(e.edit.current.template,10)?1:0}}))})),l(r)}},save:{title:r.getText("msg_warning"),message:r.getText("msg_pattern_save"),infoText:void 0,value:"",showValue:!1,defaultOK:!0,ok:function(t){var r=e.edit.dataset.pattern.filter((function(t){return t.id===parseInt(e.edit.current.template,10)}))[0];r&&(r=c()(r,{$merge:{notes:e.edit.current.item.fnote}}),l([r]))}},new:{title:r.getText("msg_pattern_new"),message:r.getText("msg_pattern_name"),infoText:void 0,value:"",showValue:!0,defaultOK:!1,ok:function(){var t=(0,m.Z)((0,p.Z)().mark((function t(n){var i,s;return(0,p.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""===n){t.next=10;break}return t.next=3,r.requestData("/pattern",{query:{filter:"description;==;"+n}});case 3:if(!(i=t.sent).error){t.next=6;break}return t.abrupt("return",r.resultError(i));case 6:if(!(i.length>0)){t.next=8;break}return t.abrupt("return",r.showToast({type:"error",title:r.getText("msg_warning"),message:r.getText("msg_value_exists")}));case 8:s=c()(a({tablename:"pattern",current:e.edit.current}),{$merge:{description:n,defpattern:0===e.edit.dataset.pattern.length?1:0}}),l([s]);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},delete:{title:r.getText("msg_warning"),message:r.getText("msg_delete_text"),infoText:r.getText("msg_delete_info"),value:"",showValue:!1,defaultOK:!1,ok:function(t){var r=e.edit.dataset.pattern.filter((function(t){return t.id===parseInt(e.edit.current.template,10)}))[0];r&&(r=c()(r,{$merge:{deleted:1,defpattern:0}}),l([r]))}}};if("new"!==s&&(!e.edit.current.template||""===e.edit.current.template))return r.showToast({type:"error",title:r.getText("msg_warning"),message:r.getText("msg_pattern_missing")});if("load"===s){var u=e.edit.dataset.pattern.filter((function(t){return t.id===parseInt(e.edit.current.template,10)}))[0];if(u){var d=c()(e.edit,{current:{item:{$merge:{fnote:u.notes}}}});d=c()(d,{$merge:{dirty:!0,lastUpdate:(new Date).getTime()}}),t("edit",d)}}else t("current",{modalForm:(0,K.jsx)(T.default,{title:o[s].title,message:o[s].message,infoText:o[s].infoText,value:o[s].value,showValue:o[s].showValue,defaultOK:o[s].defaultOK,labelOK:r.getText("msg_ok"),labelCancel:r.getText("msg_cancel"),onCancel:function(){t("current",{modalForm:null})},onOK:function(e){t("current",{modalForm:null},(function(){o[s].ok(e)}))}})})},shippingAddAll:function(){var t=c()({},{$set:e.edit});t.dataset.shipping_items_.forEach((function(e){0!==e.diff&&!0!==e.edited&&(t=c()(t,{dataset:{shiptemp:{$push:[{id:e.item_id+"-"+e.product_id,item_id:e.item_id,product_id:e.product_id,product:e.product,partnumber:e.partnumber,partname:e.partname,unit:e.unit,batch_no:"",qty:e.diff,diff:0,oqty:e.qty,tqty:e.tqty}]}}}))})),I({shipping:!0,form:"shiptemp_items"},t.template,t)},showStock:G,tableValues:R,transCopy:function(e){"create"===e?H({},"CREATE_TRANS_OPTIONS"):t("current",{modalForm:(0,K.jsx)(T.default,{title:r.getText("msg_warning"),message:r.getText("msg_copy_text"),infoText:r.getText("msg_delete_info"),defaultOK:!0,labelOK:r.getText("msg_ok"),labelCancel:r.getText("msg_cancel"),onCancel:function(){t("current",{modalForm:null})},onOK:function(r){t("current",{modalForm:null},(function(){H({cmdtype:"copy",transcast:e},"CREATE_TRANS")}))}}),side:"hide"})}}}(r,o),E=(0,l.useState)(c()(e,{$merge:{login:r.login.data,forms:(0,j.E)({getText:y.getText})}})),$=(0,s.Z)(E,1)[0];return $.data=c()($.data,{$merge:(0,i.Z)({},r[$.key])}),$.current=c()($.current,{$merge:(0,i.Z)({},r.current)}),(0,l.useEffect)((function(){if($.current&&$.current.content){var e=$.current.content;o("current",{content:null},(function(){N.checkEditor(e,e.nextKey||"LOAD_EDITOR")}))}}),[o,N,$]),$.getText=function(e,t){return y.getText(e,t)},$.onEvent=function(e,t){return t=t||[],$[e]?$[e].apply($,(0,a.Z)(t)):N[e]?N[e].apply(N,(0,a.Z)(t)):y[e]?y[e].apply(y,(0,a.Z)(t)):void 0},$.changeData=function(e,t){o($.key,(0,n.Z)({},e,t))},$.changeCurrentData=function(e,t){var r=c()($.data.current,{$merge:(0,n.Z)({},e,t)});o($.key,{current:r})},(0,K.jsx)($t,(0,i.Z)({},$))};qt.defaultProps=(0,i.Z)((0,i.Z)({key:"edit"},Et.defaultProps),{},{changeData:void 0,changeCurrentData:void 0});var It=qt},9572:function(e,t){!function(e){"use strict";var t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r="defaultParagraphSeparator",n="formatBlock",a=function(e,t,r){return e.addEventListener(t,r)},i=function(e,t){return e.appendChild(t)},s=function(e){return document.createElement(e)},l=function(e){return document.queryCommandState(e)},o=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return document.execCommand(e,!1,t)},c={bold:{icon:"<b>B</b>",title:"Bold",state:function(){return l("bold")},result:function(){return o("bold")}},italic:{icon:"<i>I</i>",title:"Italic",state:function(){return l("italic")},result:function(){return o("italic")}},underline:{icon:"<u>U</u>",title:"Underline",state:function(){return l("underline")},result:function(){return o("underline")}},strikethrough:{icon:"<strike>S</strike>",title:"Strike-through",state:function(){return l("strikeThrough")},result:function(){return o("strikeThrough")}},heading1:{icon:"<b>H<sub>1</sub></b>",title:"Heading 1",result:function(){return o(n,"<h1>")}},heading2:{icon:"<b>H<sub>2</sub></b>",title:"Heading 2",result:function(){return o(n,"<h2>")}},paragraph:{icon:"&#182;",title:"Paragraph",result:function(){return o(n,"<p>")}},quote:{icon:"&#8220; &#8221;",title:"Quote",result:function(){return o(n,"<blockquote>")}},olist:{icon:"&#35;",title:"Ordered List",result:function(){return o("insertOrderedList")}},ulist:{icon:"&#8226;",title:"Unordered List",result:function(){return o("insertUnorderedList")}},code:{icon:"&lt;/&gt;",title:"Code",result:function(){return o(n,"<pre>")}},line:{icon:"&#8213;",title:"Horizontal Line",result:function(){return o("insertHorizontalRule")}},link:{icon:"&#128279;",title:"Link",result:function(){var e=window.prompt("Enter the link URL");e&&o("createLink",e)}},image:{icon:"&#128247;",title:"Image",result:function(){var e=window.prompt("Enter the image URL");e&&o("insertImage",e)}}},u={actionbar:"pell-actionbar",button:"pell-button",content:"pell-content",selected:"pell-button-selected"},d=function(e){var l=e.actions?e.actions.map((function(e){return"string"==typeof e?c[e]:c[e.name]?t({},c[e.name],e):e})):Object.keys(c).map((function(e){return c[e]})),d=t({},u,e.classes),p=e[r]||"div",m=s("div");m.className=d.actionbar,i(e.element,m);var f=e.element.content=s("div");return f.contentEditable=!0,f.className=d.content,f.oninput=function(t){var r=t.target.firstChild;r&&3===r.nodeType?o(n,"<"+p+">"):"<br>"===f.innerHTML&&(f.innerHTML=""),e.onChange(f.innerHTML)},f.onkeydown=function(e){var t;"Enter"===e.key&&"blockquote"===(t=n,document.queryCommandValue(t))&&setTimeout((function(){return o(n,"<"+p+">")}),0)},i(e.element,f),l.forEach((function(e){var t=s("button");if(t.className=d.button,t.innerHTML=e.icon,t.title=e.title,t.setAttribute("type","button"),t.onclick=function(){return e.result()&&f.focus()},e.state){var r=function(){return t.classList[e.state()?"add":"remove"](d.selected)};a(f,"keyup",r),a(f,"mouseup",r),a(t,"click",r)}i(m,t)})),e.styleWithCSS&&o("styleWithCSS"),o(r,p),e.element},p={exec:o,init:d};e.exec=o,e.init=d,e.default=p,Object.defineProperty(e,"__esModule",{value:!0})}(t)}}]);