<!DOCTYPE html>
<html>
  <head>
    <title>Nervatura MCP</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/svg+xml" href="../favicon.svg">
    <link rel="preconnect" href="https://rsms.me/">
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
    <link href="../css/style.css" rel="stylesheet">
  </head>
  <body>
    <main class="relative flex justify-center mx-auto max-w-8xl sm:px-2 lg:px-8 xl:px-12 bg-slate-200">
    <label for="navigation" class="fixed bottom-0 left-0 z-50 flex items-center justify-center w-12 h-12 mb-4 ml-4 bg-white border rounded-full shadow-lg cursor-pointer text-slate-600 border-slate-300 lg:hidden transition duration-200 ease-in-out active:scale-95">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M4 8h16M4 16h16" />
      </svg>
    </label>

    <input type="checkbox" name="navigation" id="navigation" class="hidden peer" />
    <div class="fixed top-0 h-screen shadow-xl px-4 left-0 hidden peer-checked:block lg:relative lg:top-0 lg:h-auto lg:px-0 lg:block lg:flex-none lg:shadow-none z-40">
      <div class="absolute inset-y-0 right-0 w-full lg:w-[50vw] bg-slate-200"></div>

      <nav class="sticky top-0 pr-8 text-base lg:text-sm  xl:pr-16 w-auto">
        <ul role="list" class="-ml-0.5 h-screen overflow-y-auto pl-0.5 space-y-8 py-4">
          <li class="mb-4">
            <h2 class="text-lg font-semibold tracking-tight text-slate-900">
              <a href="../" class="text-slate-600 hover:text-slate-800">
                <span class="inline-block w-4 align-middle">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4">
                    <path d="M8.543 2.232a.75.75 0 0 0-1.085 0l-5.25 5.5A.75.75 0 0 0 2.75 9H4v4a1 1 0 0 0 1 1h1a1 1 0 0 0 1-1v-1a1 1 0 1 1 2 0v1a1 1 0 0 0 1 1h1a1 1 0 0 0 1-1V9h1.25a.75.75 0 0 0 .543-1.268l-5.25-5.5Z" />
                  </svg>                  
                </span>
                <span class="inline-block align-middle">
                  Nervatura Docs
                </span>
              </a>
            </h2>
          </li>

          <li class="mb-2">
            <h2 class="font-semibold tracking-tight text-slate-900">
              <a href="#overview" class="text-slate-600 hover:text-slate-800">
                Overview
              </a>
            </h2>
          </li>

          <li class="mb-2">
            <h2 class="font-semibold tracking-tight text-slate-900">
              <a href="#quick-start" class="text-slate-600 hover:text-slate-800">
                Quick start
              </a>
            </h2>
          </li>

          <li class="mb-2">
            <h2 class="font-semibold tracking-tight text-slate-900">
              <a href="#oauth-settings" class="text-slate-600 hover:text-slate-800">
                OAuth settings
              </a>
            </h2>
          </li>

          <li class="mb-2">
            <h2 class="font-semibold tracking-tight text-slate-900">
              <a href="#mcp-tools" class="text-slate-600 hover:text-slate-800">
                MCP tools
              </a>
            </h2>
          </li>

          <li class="mb-2">
            <h2 class="font-semibold tracking-tight text-slate-900">
              <a href="#mcp-resources" class="text-slate-600 hover:text-slate-800">
                MCP resources
              </a>
            </h2>
          </li>

          <li class="mb-2">
            <h2 class="font-semibold tracking-tight text-slate-900">
              <a href="#mcp-prompts" class="text-slate-600 hover:text-slate-800">
                MCP prompts
              </a>
            </h2>
          </li>
        </ul>
      </nav>
    </div>

    <div class="flex-auto max-w-2xl min-w-0 px-4 py-10 lg:max-w-none lg:pr-0 lg:pl-8 xl:px-16 bg-slate-100">
      <article>
        <header class="">
          <p class="text-base font-medium text-slate-500">
            Nervatura Service
          </p>

          <h1 class="text-3xl font-bold tracking-tight text-slate-900">
            Model Context Protocol
          </h1>
        </header>

        <h3 id="overview" class="mt-6 mb-3 text-xl font-bold tracking-tight text-slate-900">
          Overview
        </h3>

        <p class="mb-2 text-base text-slate-600">The <a href="https://modelcontextprotocol.io/docs/getting-started/intro" target="_blank" class="text-blue-600 dark:text-blue-500 hover:underline">Model Context Protocol</a> (MCP) is an open protocol that enables seamless integration between LLM applications and external data sources and tools. Whether you're building an AI-powered IDE, enhancing a chat interface, or creating custom AI workflows, MCP provides a standardized way to connect LLMs with the context they need.</p>

        <div class="panel text-sm text-slate-600 bg-gray-50 border border-slate-200 p-4 rounded-lg mt-4">
          <p class="mb-2">
            MCP defines three core primitives that servers can expose:
          </p>
          <ul class="list-disc list-inside">
            <li>
              Tools: Executable functions that AI applications can invoke to perform actions
            </li>
            <li>
              Resources: Data sources that provide contextual information to AI applications
            </li>
            <li>
              Prompts: Reusable templates that help structure interactions with language models
            </li>
          </ul>
        </div>
        
        <p class="mb-2 mt-4 text-base text-slate-600">
          Nervatura supports Streamable HTTP transport. The default entry point is 
          <code class="text-green-600 dark:text-green-600 bg-gray-200 px-2 py-1 text-xs font-bold">https://your-server.com/mcp</code> which is unprotected and accessible without special permissions. This is where you will find information about using MCP and all tools, resources and prompts that can be used without any permissions. All other MCP access points require permissions and are protected by a Bearer token. MCP uses standardized OAuth authorization flows to build trust between MCP clients and MCP servers.
        </p>

        <p class="mb-2 text-base text-slate-600">
          Nervatura MCP servers operate as part of the Nervatura HTTP server and can be enabled or disabled using the value of the <code class="text-green-600 dark:text-green-600 bg-gray-200 px-2 py-1 text-xs font-bold">NT_MCP_ENABLED</code> environment variable.
        </p>

        <h3 id="quick-start" class="mt-6 mb-3 text-xl font-bold tracking-tight text-slate-900">
          Quick start
        </h3>

        <p class="mb-2 text-base text-slate-600">
          Start the Nervatura service with the MCP server enabled.
        </p>
        
        <div class="relative overflow-x-auto">
          <code class="mb-3 w-auto text-xs text-wrap inline-flex text-left items-center space-x-4 bg-gray-800 text-white rounded-lg px-4 py-2">
            NT_API_KEY=TEST_API_KEY ./nervatura -tray
          </code>
        </div>

        <p class="mb-2 text-base text-slate-600">
          <ul class="list-disc list-inside text-slate-600">
            <li><strong>CLI example</strong>
              <p class="mt-2 mb-2 text-base text-slate-600">
                Query customers by query parameters.
              </p>
              <div class="relative overflow-x-auto">
                <code class="mb-3 w-auto text-xs text-wrap inline-flex text-left items-center space-x-4 bg-gray-800 text-white rounded-lg px-4 py-2">
                  npx @modelcontextprotocol/inspector --cli http://localhost:5000/mcp/customer \ <br />
                  &nbsp;&nbsp;--transport http --method tools/call \ <br />
                  &nbsp;&nbsp;--tool-name nervatura_customer_query --tool-arg customer_type=CUSTOMER_COMPANY \ <br />
                  &nbsp;&nbsp;--header "Authorization: Bearer TEST_API_KEY"
                </code>
              </div>
            </li>

            <li class="mt-2"><strong>MCP Inspector</strong>
              <p class="mt-2 mb-2 text-base text-slate-600">
                The <a href="https://github.com/modelcontextprotocol/inspector" target="_blank" class="text-blue-600 dark:text-blue-500 hover:underline" >MCP Inspector</a> is an interactive developer tool for testing and debugging MCP servers. Start Inspector React graphical interface with the following command:
              </p>
              <div class="relative overflow-x-auto">
                <code class="mb-3 w-auto text-xs text-wrap inline-flex text-left items-center space-x-4 bg-gray-800 text-white rounded-lg px-4 py-2">npx @modelcontextprotocol/inspector --transport http</code>
              </div>
              <p class="mb-2 text-base text-slate-600">
                Set the <strong>Transport Type</strong> to <code class="text-green-600 dark:text-green-600 bg-white px-2 py-1 text-xs font-bold border border-slate-300">Streamable HTTP</code> and the <strong>URL</strong> to <code class="text-green-600 dark:text-green-600 bg-white px-2 py-1 text-xs font-bold border border-slate-300">http://localhost:5000/mcp/all</code><br />
                Press the <strong>Authentication</strong> button and enter the <strong>Client ID:</strong> <code class="text-green-600 dark:text-green-600 bg-white px-2 py-1 text-xs font-bold border border-slate-300">nervatura</code><br />
                Press the <strong>Open Auth Settings</strong> button and <strong>Quick OAuth Flow</strong> button to start the OAuth flow.<br />
                Enter the <strong>Username:</strong> <code class="text-green-600 dark:text-green-600 bg-white px-2 py-1 text-xs font-bold border border-slate-300">admin</code> and the <strong>Password:</strong> <code class="text-green-600 dark:text-green-600 bg-white px-2 py-1 text-xs font-bold border border-slate-300">TEST_API_KEY</code> and press the <strong>Login</strong> button to get the Bearer token.<br />
                Press the <strong>Connect</strong> button to connect to the MCP server.
              </p>
            </li>
          </ul>
        </p>

        <h3 id="oauth-settings" class="mt-6 mb-3 text-xl font-bold tracking-tight text-slate-900">
          OAuth settings
        </h3>

        <p class="mb-2 text-base text-slate-600">
          Nervatura uses its own authentication by default, but any other OAuth authentication server can be configured in the environment variables:
          <ul class="list-disc list-inside text-slate-600">
            <li>
              <code class="text-green-600 dark:text-green-600 bg-gray-200 px-2 py-1 text-xs font-bold">NT_AUTH_SERVER</code> The URL of the OAuth authentication server (example <a href="https://www.keycloak.org" target="_blank" class="text-blue-600 dark:text-blue-500 hover:underline">Keycloak</a> server url)
            </li>
            <li>
              <code class="text-green-600 dark:text-green-600 bg-gray-200 px-2 py-1 text-xs font-bold">NT_AUTH_CLIENT_ID</code> The client ID of the OAuth authentication server.
            </li>
            <li>
              <code class="text-green-600 dark:text-green-600 bg-gray-200 px-2 py-1 text-xs font-bold">NT_AUTH_CLIENT_SECRET</code> The client secret of the OAuth authentication server.
            </li>
          </ul>
        </p>

        <p class="mt-2 mb-2 text-base text-slate-600">
          When using external authentication, the <code class="text-green-600 dark:text-green-600 bg-gray-200 px-2 py-1 text-xs font-bold">NT_TOKEN_USER</code> environment variable can be used to specify which field in the token payload contains the user's name. If the token is valid, Nervatura uses the value of this field to determine user permissions. Only users who have previously registered in the Nervatura database can log in using a valid OAuth token. To match the username, Nervatura login processing associates the token fields in the following order: <i>login.<strong>username</strong></i> = <code class="text-green-600 dark:text-green-600 bg-gray-200 px-2 py-1 text-xs font-bold">NT_TOKEN_USER</code> || <i>token.<strong>user_name</strong></i> || <i>token.<strong>username</strong></i> || <i>token.<strong>preferred_username</strong></i>.
        </p>

        <p class="mt-2 mb-2 text-base text-slate-600">
          Users in the GROUP_GUEST permission group cannot use MCP tools. All tools, resources, and prompts are assigned to multiple scopes. The scope field of the user token can be used by specifying the scopes to which the user can use the assigned tools, separated by spaces. By default, all tools, resources, and prompts are available.
        </p>

        <p class="mb-2 text-base text-slate-600">
          In the case of user authentication based on Nervatura, <code class="text-green-600 dark:text-green-600 bg-gray-200 px-2 py-1 text-xs font-bold">NT_PUBLIC_HOST</code> can be specified as the public address of the server. This address is used to generate the OAuth authorization callback URL and is required for the OAuth flow to work correctly. For more configuration options, see the <a href="../install/#configuration" class="text-blue-600 dark:text-blue-500 hover:underline">Configurations</a> section.
        </p>

        <h3 id="mcp-tools" class="mt-6 mb-3 text-xl font-bold tracking-tight text-slate-900">
          MCP tools
        </h3>

        <p class="mb-2 text-base text-slate-600">
          Tools are the part of MCP that is closest in functionality to Nervatura's other server-side APIs. Basically, we can query and modify data with them in the same way. They can also perform various other tasks, such as creating reports or sending emails. The main difference compared to other protocols is in the way the protocol is used and its structure. Traditional APIs, such as <a href="../open/" class="text-blue-600 dark:text-blue-500 hover:underline">HTTP Open API</a> or <a href="../grpc/" class="text-blue-600 dark:text-blue-500 hover:underline">gRPC</a>, are primarily used and optimized for communication between applications. Other server-side applications or client-side programs use them to retrieve or send data, and then process the result. For example, a frontend application will display the received data to its user, or always validate the sent data in advance based on data security or business logic through input interfaces. In the case of MCP tools, however, the protocol functions do not communicate with the functions of other programs, but directly with the "user", who is not a human, but an AI agent. The logic and requirements of use are in some ways closer to the way user interfaces are used than to traditional server-side interfaces.
        </p>

        <p class="mb-2 text-base text-slate-600">
          In the case of traditional APIs, the data structure is optimized for the data storage logic, the method of use, the size of the data to be sent, and possibly the speed. In the case of MCP tools, the main aspect is simplicity, data security, and clarity of use. Tools are "hybrid logic" functions that are both server-side application functions and frontend program input interfaces implemented in json. Tools are atomized units of operation with precise and clear rules and purpose.
        </p>

        <p class="mb-2 text-base text-slate-600">
          The exact usage of each tool and examples are described in the JSON definition based on the MCP protocol. The tools are assigned to multiple scopes, which allows for easier filtering based on these, as well as linking them to user permissions if necessary. The <code class="text-green-600 dark:text-green-600 bg-gray-200 px-2 py-1 text-xs font-bold">/mcp/all</code> path contains all available tools, resources, and prompts in one place, while the <code class="text-green-600 dark:text-green-600 bg-gray-200 px-2 py-1 text-xs font-bold">/mcp/scope_name</code> path contains only the tools, resources, and prompts found in that scope. The MCP tools/list command can be used to query the list and description of available tools, but the information is also available in html format, regardless of the protocol, on the <code class="text-green-600 dark:text-green-600 bg-gray-200 px-2 py-1 text-xs font-bold">/mcp/catalog</code> path.
        </p>

        <h3 id="mcp-resources" class="mt-6 mb-3 text-xl font-bold tracking-tight text-slate-900">
          MCP resources
        </h3>

        <p class="mb-2 text-base text-slate-600">
          Resources, like tools and prompts, are also assigned to scopes. Not only can Nervatura's built-in resources be queried, but additional custom resource accesses can also be defined. The server processes the valid json file specified in <code class="text-green-600 dark:text-green-600 bg-gray-200 px-2 py-1 text-xs font-bold">NT_MCP_RESOURCE</code> at startup and uses its data. The original resource json descriptor file <a href="https://raw.githubusercontent.com/nervatura/nervatura/master/static/mcp/resource.json" target="_blank" class="text-blue-600 dark:text-blue-500 hover:underline">can be downloaded here</a>.
        </p>

        <h3 id="mcp-prompts" class="mt-6 mb-3 text-xl font-bold tracking-tight text-slate-900">
          MCP prompts
        </h3>

        <p class="mb-2 text-base text-slate-600">
          Prompts are a key element of MCP that can multiply the capabilities and effectiveness of the tools. The tools themselves only allow for the performance of elementary operations, but with the help of prompts, AI agents can also perform complex and interdependent operations. The tools main task is to support data processing and schema validation, and prompts can build more complex business logic into processes.
        </p>

        <p class="mb-2 text-base text-slate-600">
          The basic version of Nervatura does not include built-in prompts for using the tools. A sample json file for creating prompts is <a href="https://raw.githubusercontent.com/nervatura/nervatura/master/static/mcp/prompt.json" target="_blank" class="text-blue-600 dark:text-blue-500 hover:underline">available for download</a>. The server processes the valid json file specified in <code class="text-green-600 dark:text-green-600 bg-gray-200 px-2 py-1 text-xs font-bold">NT_MCP_PROMPT</code> at startup and uses its data.
        </p>

        <p class="mb-2 text-base text-slate-600">
          For more information and support on using Nervatura MCP as a data source and writing prompts for LLM applications, see <a href="https://www.mcp-agency.com" target="_blank" class="text-blue-600 dark:text-blue-500 hover:underline">mcp-agency</a>.
        </p>

        <div class="flex items-center justify-center w-full px-4 pt-10 pb-6">
          <img alt="MCP prompts" src="../images/mcp_prompt.jpg" />
        </div>

        <dl class="flex pt-6 mt-6 border-t border-slate-200">
          <div class="mr-auto text-left">
            <dt class="text-sm font-normal tracking-tight text-slate-600">
              Previous
            </dt>

            <dd class="mt-1">
              <a href="../grpc/" class="text-base font-semibold text-slate-900 hover:underline">
                gRPC API
              </a>
            </dd>
          </div>

          <div class="ml-auto text-right">
            <dt class="text-sm font-normal tracking-tight text-slate-600">
              Next
            </dt>

            <dd class="mt-1">
              <a href="../client/" class="text-base font-semibold text-slate-900 hover:underline">
                Nervatura Client
              </a>
            </dd>
          </div>
        </dl>
      </article>
    </div>
</main>
</body>
</html>