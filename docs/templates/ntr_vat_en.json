{"meta":{"reportkey":"ntr_vat_en","nervatype":"report","repname":"VAT Summary","description":"Recoverable and payable VAT summary grouped by currency.","label":"Invoice","filetype":"pdf"},"report":{"title":"VAT summary","left-margin":15,"top-margin":15,"right-margin":15},"header":[{"row":{"columns":[{"cell":{"name":"custname","value":"company.0.custname","align":"left","font-style":"bold","font-size":12,"width":100}},{"cell":{"name":"label","value":"labels.lb_vat_summary","font-style":"bolditalic","font-size":26,"align":"right","color":"#696969"}}],"height":10}},{"vgap":{"height":2}},{"hline":{"border-color":100,"gap":1}},{"vgap":{"height":3}},{"row":{"columns":[{"cell":{"name":"label","value":"labels.lb_report_date","font-style":"bold","font-size":10,"align":"left"}},{"cell":{"name":"date_from","value":"company.0.date_from","align":"left","font-style":"bold","font-size":10}},{"cell":{"name":"label","value":"-","font-style":"bold","font-size":10,"align":"left","width":5}},{"cell":{"name":"date_to","value":"company.0.date_to","align":"left","font-style":"bold","font-size":10}},{"cell":{"name":"crdate","value":"={{labels.lb_create_date}} ={{crtime}}","align":"right","font-style":"italic","font-size":9}}],"hgap":2,"height":1}}],"details":[{"vgap":{"height":3}},{"datagrid":{"columns":[{"column":{"width":"6%","fieldname":"counter","align":"right","label":"labels.lb_no"}},{"column":{"width":"6%","fieldname":"curr","label":"labels.lb_curr"}},{"column":{"width":"20%","fieldname":"transnumber","label":"labels.lb_invoice_no","footer":"labels.lb_total"}},{"column":{"width":"11%","fieldname":"duedate","align":"center","label":"labels.lb_due_date","header-align":"center"}},{"column":{"width":"20%","fieldname":"custname","label":"labels.lb_customer"}},{"column":{"width":"6%","fieldname":"taxcode","align":"right","label":"={{labels.lb_vat}}"}},{"column":{"width":"12%","fieldname":"netamount","align":"right","label":"labels.lb_net","footer":"total_bycur.0.netamount","header-align":"right","footer-align":"right"}},{"column":{"width":"11%","fieldname":"vatamount","align":"right","label":"labels.lb_vat","footer":"total_bycur.0.vatamount","header-align":"right","footer-align":"right"}},{"column":{"fieldname":"amount","align":"right","label":"labels.lb_gross","footer":"total_bycur.0.amount","header-align":"right","footer-align":"right"}}],"name":"items","databind":"ds","border":"1","border-color":100,"font-size":8,"header-background":230}},{"vgap":{"height":3}},{"datagrid":{"columns":[{"column":{"width":"10%","fieldname":"curr","label":"labels.lb_curr"}},{"column":{"width":"8%","fieldname":"taxcode","align":"right","label":"={{labels.lb_vat}}%","header-align":"right"}},{"column":{"width":"17%","fieldname":"netamount_out","label":"labels.lb_net_income","align":"right","header-align":"right"}},{"column":{"width":"16%","fieldname":"vatamount_out","label":"={{labels.lb_vat}}(+)","align":"right","header-align":"right"}},{"column":{"width":"17%","fieldname":"netamount_in","align":"right","label":"labels.lb_net_payment","header-align":"right"}},{"column":{"width":"16%","fieldname":"vatamount_in","align":"right","label":"={{labels.lb_vat}}(-)","header-align":"right"}},{"column":{"width":"17%","fieldname":"vatamount_diff","align":"right","label":"labels.lb_vat_diff","header-align":"right"}}],"name":"total","databind":"total","border":"1","border-color":100,"font-size":8,"header-background":230}}],"footer":[{"vgap":{"height":2}},{"hline":{"border-color":100}},{"row":{"columns":[{"cell":{"value":"labels.web_page","font-style":"bolditalic","color":"#2100FF"}},{"cell":{"value":"{{page}}","align":"right","font-style":"bold"}}],"height":10}}],"sources":{"total":{"default":"select t.curr as curr, case when t.notax=1 then '={{lb_notax}}' else tx.taxcode end as taxcode , sum(case when dg.groupvalue='out' then netamount else 0 end) as netamount_out , sum(case when dg.groupvalue='in' then netamount else 0 end) as netamount_in , sum(case when dg.groupvalue='out' then vatamount else 0 end) as vatamount_out , sum(case when dg.groupvalue='in' then vatamount else 0 end) as vatamount_in , sum(case when dg.groupvalue='out' then amount else 0 end) as amount_out , sum(case when dg.groupvalue='in' then amount else 0 end) as amount_in ,sum(case when dg.groupvalue='in' then vatamount else 0 end-case when dg.groupvalue='out' then vatamount else 0 end) as vatamount_diff from trans t inner join groups tg on t.transtype = tg.id and tg.groupvalue='invoice' inner join groups dg on t.direction = dg.id inner join item ti on t.id=ti.trans_id and ti.deleted=0 inner join tax tx on ti.tax_id=tx.id where t.deleted=0 and t.transdate >= @date_from and t.transdate <= @date_to @where_str group by t.curr, case when t.notax=1 then '={{lb_notax}}' else tx.taxcode end, tx.rate order by t.curr, tx.rate"},"ds":{"default":"select t.transnumber as transnumber, t.crdate as crdate, t.transdate as transdate, substr(cast(t.duedate as char(10)), 1, 10) as  duedate, c.custname as custname, t.curr as curr, dg.groupvalue as direction , case when t.notax=1 then '={{lb_notax}}' else tx.taxcode end as taxcode , case when dg.groupvalue='in' then 0-sum(netamount) else sum(netamount) end as netamount , case when dg.groupvalue='in' then 0-sum(vatamount) else sum(vatamount) end as vatamount , case when dg.groupvalue='in' then 0-sum(amount) else sum(amount) end as amount from trans t inner join groups tg on t.transtype = tg.id and tg.groupvalue='invoice' inner join groups dg on t.direction = dg.id inner join item ti on t.id=ti.trans_id and ti.deleted=0 inner join customer c on t.customer_id = c.id inner join tax tx on ti.tax_id=tx.id where t.deleted=0 and t.transdate >= @date_from and t.transdate <= @date_to @where_str group by t.transnumber, t.crdate, t.transdate, substr(cast(t.duedate as char(10)), 1, 10), c.custname, t.curr, dg.groupvalue, case when t.notax=1 then '={{lb_notax}}' else tx.taxcode end order by t.curr, t.transdate, c.custname","mssql":"select t.transnumber as transnumber, t.crdate as crdate, t.transdate as transdate, CONVERT(VARCHAR(10), t.duedate, 120) as duedate, c.custname as custname, t.curr as curr, dg.groupvalue as direction , case when t.notax=1 then '={{lb_notax}}' else tx.taxcode end as taxcode , case when dg.groupvalue='in' then 0-sum(netamount) else sum(netamount) end as netamount , case when dg.groupvalue='in' then 0-sum(vatamount) else sum(vatamount) end as vatamount , case when dg.groupvalue='in' then 0-sum(amount) else sum(amount) end as amount from trans t inner join groups tg on t.transtype = tg.id and tg.groupvalue='invoice' inner join groups dg on t.direction = dg.id inner join item ti on t.id=ti.trans_id and ti.deleted=0 inner join customer c on t.customer_id = c.id inner join tax tx on ti.tax_id=tx.id where t.deleted=0 and t.transdate >= @date_from and t.transdate <= @date_to @where_str group by t.transnumber, t.crdate, t.transdate, CONVERT(VARCHAR(10), t.duedate, 120), c.custname, t.curr, dg.groupvalue, case when t.notax=1 then '={{lb_notax}}' else tx.taxcode end order by t.curr, t.transdate, c.custname"},"total_bycur":{"default":"select t.curr as curr , sum(case when dg.groupvalue='in' then 0-netamount else netamount end) as netamount , sum(case when dg.groupvalue='in' then 0-vatamount else vatamount end) as vatamount , sum(case when dg.groupvalue='in' then 0-amount else amount end) as amount from trans t inner join groups tg on t.transtype = tg.id and tg.groupvalue='invoice' inner join groups dg on t.direction = dg.id inner join item ti on t.id=ti.trans_id and ti.deleted=0 where t.deleted=0 and t.transdate >= @date_from and t.transdate <= @date_to @where_str group by t.curr order by t.curr DESC"},"company":{"default":"select @date_from as date_from, @date_to as date_to, c.custname as custname, c.taxnumber as taxnumber, c.account as account, addr.country as country, addr.state as state, addr.zipcode as zipcode, addr.city as city, addr.street as street from customer c left join (select * from address where id in(select min(id) fid from address a where a.deleted=0 and a.nervatype = (select id from groups where groupname='nervatype' and groupvalue='customer') group by a.ref_id)) addr on c.id = addr.ref_id where c.id in(select min(customer.id) from customer inner join groups on customer.custtype=groups.id and groups.groupvalue='own')"}},"fields":{"date_from":{"fieldtype":"date","wheretype":"in","description":"From date","orderby":0,"defvalue":"-360"},"date_to":{"fieldtype":"date","wheretype":"in","description":"To date","orderby":1},"curr":{"fieldtype":"string","wheretype":"where","description":"Currency","orderby":2}},"data":{"labels":{"lb_create_date":"Create date:","lb_curr":"Curr","lb_customer":"Customer","lb_due_date":"Due Date","lb_gross":"Gross","lb_invoice_no":"Invoice No.","lb_net":"Net","lb_net_income":"Net income","lb_net_payment":"Net payment","lb_no":"No.","lb_report_date":"Report date:","lb_total":"Total","lb_vat":"VAT","lb_yes":"YES","lb_notax":"AAM","lb_vat_diff":"VAT Diff.","lb_vat_summary":"VAT summary","web_link":"http://nervatura.com","web_page":"www.nervatura.com"}}}